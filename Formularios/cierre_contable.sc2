*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.21" SourceFile="cierre_contable.scx" CPID="1252" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	*<PropValue>
		Name = "Dataenvironment"
	*</PropValue>

ENDDEFINE

DEFINE CLASS form1 AS form 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Ismouseout" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Olecontrol1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LabelBarra" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />

	*<PropValue>
		AutoCenter = .T.
		Caption = "Cerrar Ejercicio Contable (Pasa a Histórico)"
		Closable = .F.
		DoCreate = .T.
		Height = 169
		Icon = arw09rt.ico
		MaxButton = .F.
		MinButton = .F.
		Name = "Form1"
		Picture = 1.gif
		Width = 363
	*</PropValue>

	ADD OBJECT 'Ismouseout' AS ismouseout WITH ;
		Height = 24, ;
		Left = 34, ;
		Name = "Ismouseout", ;
		Top = 103, ;
		Width = 25
		*< END OBJECT: ClassLib="xpform.vcx" BaseClass="timer" />

	ADD OBJECT 'Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Periodo :", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 15, ;
		Left = 8, ;
		Name = "Label1", ;
		Top = 48, ;
		Width = 39
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'LabelBarra' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Label1", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 15, ;
		Left = 7, ;
		Name = "LabelBarra", ;
		Top = 70, ;
		Width = 349
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Olecontrol1' AS olecontrol WITH ;
		Height = 12, ;
		Left = 4, ;
		Name = "Olecontrol1", ;
		Top = 83, ;
		Width = 356
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\system\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKBGLmorNcQBAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAADwAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8iOgU1iYXREbFqAMDwKDYoIUM0EggAAADLJAAAPgEAAAGKq5cAAAYAHAAAAAAAAAAAAMhCAAABAAHvzasAAAUAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADAAAAEJvcmRlclN0eWxlAAkAAABJCgAAAAEAAAAKAAAAU2Nyb2xsaW5nAAkAAABJCgAAAAEAAAAAAAAAAAAAAAcAAAD//////////0zlowAf3uy9AQAFAEzlowAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'Xpbutton1' AS xpbutton WITH ;
		Left = 78, ;
		Name = "Xpbutton1", ;
		TabIndex = 16, ;
		Top = 100, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Left = 11, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-continue.gif, ;
		imgImage.Top = 8, ;
		imgImage.Width = 14, ;
		lblText.Caption = "Salir", ;
		lblText.Left = 40, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .T., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton2' AS xpbutton WITH ;
		Left = 264, ;
		Name = "Xpbutton2", ;
		TabIndex = 14, ;
		Top = 1, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 16, ;
		imgImage.Left = 12, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-ok.gif, ;
		imgImage.Top = 8, ;
		imgImage.Width = 16, ;
		lblText.Caption = "Cerrar", ;
		lblText.Left = 36, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton3' AS xpbutton WITH ;
		Left = 183, ;
		Name = "Xpbutton3", ;
		TabIndex = 14, ;
		Top = 100, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 16, ;
		imgImage.Left = 12, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-ok.gif, ;
		imgImage.Top = 8, ;
		imgImage.Width = 16, ;
		lblText.Caption = "Cerrar", ;
		lblText.Left = 36, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />
	
	PROCEDURE Xpbutton1.Click
		release thisform
	ENDPROC

	PROCEDURE Xpbutton2.Click
		if 	messagebox('Confirma Generar Copia de Respaldo',36,'Asistente')=6
			thisform.labelbarra.caption='Realizando Copia de Respaldo...'
			camino=alltr(sys(5)+sys(2003))
			archi=camino+"\*.dbf|"+camino+"\*.cdx"
			declare short addZIP_Initialise IN "azip32.dll" 
			declare short addZIP_ArchiveName IN "azip32.dll"; 
				string zipfile 
			declare short addZIP_Include IN "azip32.dll"; 
				string sourcefile 
			declare short addZIP IN "azip32.dll" 	
			close table all
			nomarchi=putfile('','','als')
			if !empty(nomarchi)
				wait windows 'Realizando Backup. Operacion en Proceso . . . ' nowait
				=addZIP_Initialise() && inicializa el zip
				=addZIP_ArchiveName(alltr(nomarchi))&& archivo a crear
				=addZIP_Include(archi)  && ficheros a incluir
				=addZIP()&&hacer el zip	
				thisform.labelbarra.caption='Copia de Respaldo Terminada.'
				wait windows 'Backup Terminado.Pulse una Tecla.'
			else
				messagebox('Backup Cancelado.',48,'Control')
				thisform.labelbarra.caption='Backup Cancelado.'	
			endif	
		endif
		
	ENDPROC

	PROCEDURE Xpbutton3.Click
		if 	messagebox('Confirma Cerrar Ejercicio Contable ',36,'Asistente')=6
			thisform.labelbarra.caption='Controlando Movimientos Contables ...'
			camino=alltr(sys(5)+sys(2003))
			archi=camino+"\*.dbf|"+camino+"\*.cdx"
			declare short addZIP_Initialise IN "azip32.dll" 
			declare short addZIP_ArchiveName IN "azip32.dll"; 
				string zipfile 
			declare short addZIP_Include IN "azip32.dll"; 
				string sourcefile 
			declare short addZIP IN "azip32.dll" 	
			close table all
			nomarchi=putfile('','','als')
			if !empty(nomarchi)
				wait windows 'Realizando Backup. Operacion en Proceso . . . ' nowait
				=addZIP_Initialise() && inicializa el zip
				=addZIP_ArchiveName(alltr(nomarchi))&& archivo a crear
				=addZIP_Include(archi)  && ficheros a incluir
				=addZIP()&&hacer el zip	
				thisform.labelbarra.caption='Copia de Respaldo Terminada.'
				wait windows 'Backup Terminado.Pulse una Tecla.'
			else
				messagebox('Backup Cancelado.',48,'Control')
				thisform.labelbarra.caption='Backup Cancelado.'	
			endif	
		endif
		
	ENDPROC

ENDDEFINE
