*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.21" SourceFile="orden.scx" CPID="1252" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	*<PropValue>
		DataSource = .NULL.
		Height = 795
		Left = 15
		Name = "Dataenvironment"
		Top = 141
		Width = 1214
	*</PropValue>

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "aux_faccom", ;
		BufferModeOverride = 5, ;
		CursorSource = "aux_faccom", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor10' AS cursor WITH ;
		Alias = "movicont", ;
		CursorSource = "movicont", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 772, ;
		Name = "Cursor10", ;
		Top = 141, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor11' AS cursor WITH ;
		Alias = "pagosprov", ;
		CursorSource = "pagosprov", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 830, ;
		Name = "Cursor11", ;
		Top = 365, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor12' AS cursor WITH ;
		Alias = "cuencont", ;
		CursorSource = "cuencont", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor12", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor13' AS cursor WITH ;
		Alias = "chequeter", ;
		CursorSource = "chequeter", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor13", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor14' AS cursor WITH ;
		Alias = "bancos", ;
		CursorSource = "bancos", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor14", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor15' AS cursor WITH ;
		Alias = "chequeras", ;
		BufferModeOverride = 5, ;
		CursorSource = "chequeras", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor15", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor16' AS cursor WITH ;
		Alias = "movimientos_bancos1", ;
		CursorSource = "movimientos_bancos", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 487, ;
		Name = "Cursor16", ;
		Top = 603, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor17' AS cursor WITH ;
		Alias = "aux_entrega_retenciones", ;
		BufferModeOverride = 5, ;
		CursorSource = "aux_entrega_retenciones", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 413, ;
		Name = "Cursor17", ;
		Top = 270, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor18' AS cursor WITH ;
		Alias = "tipo_retenciones", ;
		CursorSource = "tipo_retenciones", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 614, ;
		Name = "Cursor18", ;
		Top = 621, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor19' AS cursor WITH ;
		Alias = "retenciones", ;
		CursorSource = "retenciones", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 466, ;
		Name = "Cursor19", ;
		Top = 492, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "aux_faccomsele", ;
		BufferModeOverride = 5, ;
		CursorSource = "aux_faccomsele", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor20' AS cursor WITH ;
		Alias = "detalle_faccom", ;
		CursorSource = "detalle_faccom", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 162, ;
		Name = "Cursor20", ;
		Top = 382, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor21' AS cursor WITH ;
		Alias = "deposito", ;
		BufferModeOverride = 5, ;
		CursorSource = deposito.dbf, ;
		Height = 90, ;
		Left = 145, ;
		Name = "Cursor21", ;
		Top = 273, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor22' AS cursor WITH ;
		Alias = "tabla15", ;
		BufferModeOverride = 5, ;
		CursorSource = tabla15.dbf, ;
		Height = 90, ;
		Left = 694, ;
		Name = "Cursor22", ;
		Top = 17, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor23' AS cursor WITH ;
		Alias = "deposito1", ;
		BufferModeOverride = 5, ;
		CursorSource = deposito1.dbf, ;
		Height = 90, ;
		Left = 37, ;
		Name = "Cursor23", ;
		Top = 385, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor24' AS cursor WITH ;
		Alias = "asiemode", ;
		CursorSource = asiemode.dbf, ;
		Height = 90, ;
		Left = 440, ;
		Name = "Cursor24", ;
		Top = 20, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor25' AS cursor WITH ;
		Alias = "aux_terceros", ;
		BufferModeOverride = 5, ;
		CursorSource = aux_terceros.dbf, ;
		Height = 90, ;
		Left = 21, ;
		Name = "Cursor25", ;
		Top = 133, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor26' AS cursor WITH ;
		Alias = "imp_orden", ;
		BufferModeOverride = 5, ;
		CursorSource = imp_orden.dbf, ;
		Height = 90, ;
		Left = 629, ;
		Name = "Cursor26", ;
		Top = 138, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor27' AS cursor WITH ;
		Alias = "periodo_actual", ;
		CursorSource = periodo_actual.dbf, ;
		Height = 90, ;
		Left = 710, ;
		Name = "Cursor27", ;
		Top = 380, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor28' AS cursor WITH ;
		Alias = "aux_perlote", ;
		BufferModeOverride = 5, ;
		CursorSource = aux_perlote.dbf, ;
		Height = 90, ;
		Left = 293, ;
		Name = "Cursor28", ;
		Top = 25, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor29' AS cursor WITH ;
		Alias = "aux_perlote1", ;
		BufferModeOverride = 5, ;
		CursorSource = aux_perlote.dbf, ;
		Height = 90, ;
		Left = 432, ;
		Name = "Cursor29", ;
		Top = 148, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "movimientos_bancos", ;
		BufferModeOverride = 5, ;
		CursorSource = "movimientos_bancos", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 795, ;
		Name = "Cursor3", ;
		Top = 247, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor30' AS cursor WITH ;
		Alias = "ramas", ;
		CursorSource = "ramas", ;
		Database = datos.dbc, ;
		Height = 90, ;
		Left = 563, ;
		Name = "Cursor30", ;
		Top = 259, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor31' AS cursor WITH ;
		Alias = "per_lote", ;
		CursorSource = per_lote.dbf, ;
		Height = 90, ;
		Left = 589, ;
		Name = "Cursor31", ;
		Top = 22, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor32' AS cursor WITH ;
		Alias = "aux_perlote2", ;
		CursorSource = aux_perlote.dbf, ;
		Height = 90, ;
		Left = 403, ;
		Name = "Cursor32", ;
		Top = 390, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor33' AS cursor WITH ;
		Alias = "tipo_retenciones1", ;
		CursorSource = "tipo_retenciones", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 570, ;
		Name = "Cursor33", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor34' AS cursor WITH ;
		Alias = "tipo_percepciones", ;
		CursorSource = tipo_percepciones.dbf, ;
		Height = 90, ;
		Left = 710, ;
		Name = "Cursor34", ;
		Top = 500, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor35' AS cursor WITH ;
		Alias = "aux_tipop", ;
		BufferModeOverride = 5, ;
		CursorSource = aux_tipop.dbf, ;
		Height = 90, ;
		Left = 238, ;
		Name = "Cursor35", ;
		Top = 305, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor36' AS cursor WITH ;
		Alias = "tipo_reten", ;
		CursorSource = tipo_reten.dbf, ;
		Height = 90, ;
		Left = 723, ;
		Name = "Cursor36", ;
		Top = 619, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor37' AS cursor WITH ;
		Alias = "cerbru", ;
		CursorSource = cerbru.dbf, ;
		Height = 90, ;
		Left = 288, ;
		Name = "Cursor37", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor38' AS cursor WITH ;
		Alias = "tipo_retencio", ;
		CursorSource = tipo_retencio.dbf, ;
		Height = 90, ;
		Left = 847, ;
		Name = "Cursor38", ;
		Top = 618, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor39' AS cursor WITH ;
		Alias = "aux_terceros2", ;
		BufferModeOverride = 5, ;
		CursorSource = aux_terceros2.dbf, ;
		Height = 90, ;
		Left = 273, ;
		Name = "Cursor39", ;
		Top = 600, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "tipo_orden", ;
		CursorSource = "tipo_orden", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 568, ;
		Name = "Cursor4", ;
		Top = 383, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor40' AS cursor WITH ;
		Alias = "aux_perlotee", ;
		BufferModeOverride = 5, ;
		CursorSource = aux_perlotee.dbf, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor40", ;
		Top = 20, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor41' AS cursor WITH ;
		Alias = "aux_dctos", ;
		BufferModeOverride = 5, ;
		CursorSource = aux_dctos.dbf, ;
		Height = 90, ;
		Left = 145, ;
		Name = "Cursor41", ;
		Top = 630, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor42' AS cursor WITH ;
		Alias = "descuentos_proveedores", ;
		CursorSource = "descuentos_proveedores", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 1074, ;
		Name = "Cursor42", ;
		Top = 23, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor43' AS cursor WITH ;
		Alias = "tipo_retenciones2", ;
		CursorSource = "tipo_retenciones", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 449, ;
		Name = "Cursor43", ;
		Top = 655, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor44' AS cursor WITH ;
		Alias = "deposito2", ;
		BufferModeOverride = 5, ;
		CursorSource = deposito1.dbf, ;
		Height = 90, ;
		Left = 991, ;
		Name = "Cursor44", ;
		Top = 239, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor45' AS cursor WITH ;
		Alias = "tipo_descuentos", ;
		CursorSource = "tipo_descuentos", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 935, ;
		Name = "Cursor45", ;
		Top = 18, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor5' AS cursor WITH ;
		Alias = "faccom", ;
		CursorSource = "faccom", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor5", ;
		Top = 140, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor6' AS cursor WITH ;
		Alias = "orden", ;
		CursorSource = "orden", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 674, ;
		Name = "Cursor6", ;
		Top = 265, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor7' AS cursor WITH ;
		Alias = "detacont", ;
		CursorSource = "detacont", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor7", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor8' AS cursor WITH ;
		Alias = "proveedores", ;
		CursorSource = "proveedores", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 807, ;
		Name = "Cursor8", ;
		Top = 22, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor9' AS cursor WITH ;
		Alias = "asig_cuentas", ;
		CursorSource = "asig_cuentas", ;
		Database = cooperativa.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor9", ;
		Top = 260, ;
		Width = 90
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS formmsde1 AS formmsde OF "msde.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shape4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LBLCODIGO1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CODIGO1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LBLNROORD1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="NROORD1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="labelorden" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid2.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid3.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid3.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid3.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid3.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid3.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid3.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel19" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Asiento1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cartera1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="CHEQUE1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label100" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Ret_encartera1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="totret" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ret1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ret2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="LabelTotal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtcomi" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txt_totalcomi" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Reposicion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid4.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Edit1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdescuentos" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Embossedlabel18" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="DESCUENTOS1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Depositos1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Text14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtreintegro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Check_pagar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Ismouseout1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtnumero" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtdocumento" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtnombre" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtperiodo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtlegajo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtfecha_proceso" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtimporte" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtpagado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Check_pagado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Line1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Check_anulado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Xpbutton3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtfecha_pagado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtcodigo_descuento" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Xpbutton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.txtimppagado" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="reintegros.Label11" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: asiento
		*m: asi_automaticos
		*m: calcular_comision
		*m: conectar_sql
		*m: filtra_retenciones
		*m: foco_cartera
		*m: foco_cheque
		*m: foco_contable
		*m: foco_deposito
		*m: foco_descuentos
		*m: foc_ret_encartera
		*m: imprimir
		*m: imp_detalleoc
		*m: saldoanticipos
		*m: suma
		*m: suma2
		*m: suma3
		*m: total
		*m: ver_reintegro
		*p: ali
		*p: asi_brut
		*p: asi_caja
		*p: asi_lote
		*p: brucer
		*p: brulot
		*p: brutot
		*p: chequecartera
		*p: codali
		*p: comision_oc
		*p: comi_oc
		*p: condicion
		*p: cuit
		*p: cuitcer
		*p: c_chequeter
		*p: domcer
		*p: domi
		*p: efec_ret
		*p: eliminado
		*p: feccer
		*p: financiera
		*p: nomcer
		*p: nueva
		*p: numcer
		*p: numord
		*p: p
		*p: proveedor
		*p: regtrans
		*p: seleccionado
		*p: totib
		*p: totlh
		*p: totrete
		*p: ultimo
	*</DefinedPropArrayMethod>

	*<PropValue>
		BackColor = 180,180,180
		BorderStyle = 1
		Caption = "Orden de Pago"
		DoCreate = .T.
		Height = 637
		Icon = note12.ico
		Name = "Formmsde1"
		Picture = 1.gif
		Width = 805
		Shape3.BackStyle = 0
		Shape3.BorderStyle = 0
		Shape3.Left = 398
		Shape3.Name = "Shape3"
		Shape3.Top = 596
		Shape3.ZOrderSet = 0
		b_grabar.cmdHide.Name = "cmdHide"
		b_grabar.imgBack.Name = "imgBack"
		b_grabar.imgImage.Name = "imgImage"
		b_grabar.imgLeft.Name = "imgLeft"
		b_grabar.imgMouseDown.Name = "imgMouseDown"
		b_grabar.imgMouseOn.Name = "imgMouseOn"
		b_grabar.imgRight.Name = "imgRight"
		b_grabar.lblText.Name = "lblText"
		b_grabar.Left = 840
		b_grabar.Name = "b_grabar"
		b_grabar.TabIndex = 20
		b_grabar.Top = 552
		b_grabar.Visible = .F.
		b_grabar.ZOrderSet = 1
		ismouseout.Left = 663
		ismouseout.Name = "ismouseout"
		ismouseout.Top = 588
		Msde1.Name = "Msde1"
		b_eliminar.cmdHide.Name = "cmdHide"
		b_eliminar.imgBack.Name = "imgBack"
		b_eliminar.imgImage.Name = "imgImage"
		b_eliminar.imgLeft.Name = "imgLeft"
		b_eliminar.imgMouseDown.Name = "imgMouseDown"
		b_eliminar.imgMouseOn.Name = "imgMouseOn"
		b_eliminar.imgRight.Name = "imgRight"
		b_eliminar.lblText.Name = "lblText"
		b_eliminar.Left = 840
		b_eliminar.Name = "b_eliminar"
		b_eliminar.TabIndex = 21
		b_eliminar.Top = 552
		b_eliminar.Visible = .F.
		b_eliminar.ZOrderSet = 4
		b_imprimir.cmdHide.Name = "cmdHide"
		b_imprimir.imgBack.Name = "imgBack"
		b_imprimir.imgImage.Name = "imgImage"
		b_imprimir.imgLeft.Name = "imgLeft"
		b_imprimir.imgMouseDown.Name = "imgMouseDown"
		b_imprimir.imgMouseOn.Name = "imgMouseOn"
		b_imprimir.imgRight.Name = "imgRight"
		b_imprimir.lblText.Name = "lblText"
		b_imprimir.Left = 840
		b_imprimir.Name = "b_imprimir"
		b_imprimir.TabIndex = 22
		b_imprimir.Top = 528
		b_imprimir.Visible = .F.
		b_imprimir.ZOrderSet = 5
		b_nuevo.cmdHide.Name = "cmdHide"
		b_nuevo.imgBack.Name = "imgBack"
		b_nuevo.imgImage.Name = "imgImage"
		b_nuevo.imgLeft.Name = "imgLeft"
		b_nuevo.imgMouseDown.Name = "imgMouseDown"
		b_nuevo.imgMouseOn.Name = "imgMouseOn"
		b_nuevo.imgRight.Name = "imgRight"
		b_nuevo.lblText.Name = "lblText"
		b_nuevo.Left = 840
		b_nuevo.Name = "b_nuevo"
		b_nuevo.TabIndex = 23
		b_nuevo.Top = 540
		b_nuevo.Visible = .F.
		b_nuevo.ZOrderSet = 6
		b_salir.cmdHide.Name = "cmdHide"
		b_salir.imgBack.Name = "imgBack"
		b_salir.imgImage.Height = 14
		b_salir.imgImage.Name = "imgImage"
		b_salir.imgImage.Width = 14
		b_salir.imgLeft.Name = "imgLeft"
		b_salir.imgMouseDown.Name = "imgMouseDown"
		b_salir.imgMouseOn.Name = "imgMouseOn"
		b_salir.imgRight.Name = "imgRight"
		b_salir.lblText.Name = "lblText"
		b_salir.Left = 840
		b_salir.Name = "b_salir"
		b_salir.TabIndex = 24
		b_salir.Top = 528
		b_salir.Visible = .F.
		b_salir.ZOrderSet = 7
	*</PropValue>

	ADD OBJECT 'Asiento1' AS asiento WITH ;
		BackStyle = 0, ;
		Height = 159, ;
		Left = 127, ;
		Name = "Asiento1", ;
		TabIndex = 36, ;
		Top = 416, ;
		Width = 606, ;
		ZOrderSet = 36, ;
		Container1.Height = 114, ;
		Container1.Left = 0, ;
		Container1.Name = "Container1", ;
		Container1.Top = 0, ;
		Container1.Width = 624, ;
		Shape2.Name = "Shape2", ;
		Embossedlabel4.Name = "Embossedlabel4", ;
		Text4.Name = "Text4", ;
		Embossedlabel5.Name = "Embossedlabel5", ;
		Text5.Name = "Text5", ;
		text6.Name = "text6", ;
		Grid1.Column1.Header1.Name = "Header1", ;
		Grid1.Column1.Name = "Column1", ;
		Grid1.Column1.Text1.Name = "Text1", ;
		Grid1.Column2.Header1.Name = "Header1", ;
		Grid1.Column2.Name = "Column2", ;
		Grid1.Column2.Text1.Name = "Text1", ;
		Grid1.Column3.Header1.Name = "Header1", ;
		Grid1.Column3.Name = "Column3", ;
		Grid1.Column3.Text1.Name = "Text1", ;
		Grid1.Column4.Header1.Name = "Header1", ;
		Grid1.Column4.Name = "Column4", ;
		Grid1.Column4.Text1.Name = "Text1", ;
		Grid1.Name = "Grid1", ;
		lblmodelo1.Name = "lblmodelo1", ;
		NROMODELO1.Name = "NROMODELO1", ;
		txtfecha.Name = "txtfecha", ;
		Embossedlabel1.Name = "Embossedlabel1", ;
		nro.Name = "nro"
		*< END OBJECT: ClassLib="contabilidad.vcx" BaseClass="container" />

	ADD OBJECT 'Cartera1' AS cartera WITH ;
		Height = 105, ;
		Left = 68, ;
		Name = "Cartera1", ;
		TabIndex = 78, ;
		Top = 449, ;
		Visible = .F., ;
		Width = 601, ;
		ZOrderSet = 47, ;
		Container1.Name = "Container1", ;
		Label1.Name = "Label1", ;
		Label2.Name = "Label2", ;
		Grid1.Column1.Header1.ForeColor = 0,0,128, ;
		Grid1.Column1.Header1.Name = "Header1", ;
		Grid1.Column1.Name = "Column1", ;
		Grid1.Column1.Text1.Name = "Text1", ;
		Grid1.Column2.Header1.ForeColor = 0,0,128, ;
		Grid1.Column2.Header1.Name = "Header1", ;
		Grid1.Column2.Name = "Column2", ;
		Grid1.Column2.Text1.Name = "Text1", ;
		Grid1.Column3.Header1.ForeColor = 0,0,128, ;
		Grid1.Column3.Header1.Name = "Header1", ;
		Grid1.Column3.Name = "Column3", ;
		Grid1.Column3.Text1.Name = "Text1", ;
		Grid1.Column4.Header1.ForeColor = 0,0,128, ;
		Grid1.Column4.Header1.Name = "Header1", ;
		Grid1.Column4.Name = "Column4", ;
		Grid1.Column4.Text1.Name = "Text1", ;
		Grid1.Column5.Header1.ForeColor = 0,0,128, ;
		Grid1.Column5.Header1.Name = "Header1", ;
		Grid1.Column5.Name = "Column5", ;
		Grid1.Column5.Text1.Name = "Text1", ;
		Grid1.Column6.Header1.Name = "Header1", ;
		Grid1.Column6.Name = "Column6", ;
		Grid1.Column6.Text1.Name = "Text1", ;
		Grid1.Column7.Header1.Name = "Header1", ;
		Grid1.Column7.Name = "Column7", ;
		Grid1.Column7.Text1.Name = "Text1", ;
		Grid1.Column8.Header1.Name = "Header1", ;
		Grid1.Column8.Name = "Column8", ;
		Grid1.Column8.Text1.Name = "Text1", ;
		Grid1.Column9.Header1.Name = "Header1", ;
		Grid1.Column9.Name = "Column9", ;
		Grid1.Column9.Text1.Name = "Text1", ;
		Grid1.Name = "Grid1", ;
		Text1.Name = "Text1", ;
		Label3.Name = "Label3"
		*< END OBJECT: ClassLib="banco.vcx" BaseClass="container" />

	ADD OBJECT 'Check_pagar' AS checkbox WITH ;
		BackColor = 255,0,0, ;
		BackStyle = 0, ;
		Caption = " Pagar ", ;
		DisabledBackColor = 249,249,249, ;
		Enabled = .F., ;
		FontBold = .T., ;
		ForeColor = 255,255,255, ;
		Height = 17, ;
		Left = 211, ;
		Name = "Check_pagar", ;
		ReadOnly = .T., ;
		TabIndex = 93, ;
		Top = 110, ;
		Visible = .F., ;
		Width = 65, ;
		ZOrderSet = 101
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'CHEQUE1' AS cheque WITH ;
		Height = 111, ;
		Left = 84, ;
		Name = "CHEQUE1", ;
		TabIndex = 77, ;
		Top = 444, ;
		Visible = .F., ;
		Width = 625, ;
		ZOrderSet = 48, ;
		Container1.Name = "Container1", ;
		Container1.ZOrderSet = 0, ;
		Grid1.Column1.Header1.Alignment = 2, ;
		Grid1.Column1.Header1.FontBold = .F., ;
		Grid1.Column1.Header1.ForeColor = 0,0,128, ;
		Grid1.Column1.Header1.Name = "Header1", ;
		Grid1.Column1.Name = "Column1", ;
		Grid1.Column1.Text1.Name = "Text1", ;
		Grid1.Column2.Header1.Caption = "N� comprobante", ;
		Grid1.Column2.Header1.FontBold = .F., ;
		Grid1.Column2.Header1.ForeColor = 0,0,128, ;
		Grid1.Column2.Header1.Name = "Header1", ;
		Grid1.Column2.Name = "Column2", ;
		Grid1.Column2.Text1.Name = "Text1", ;
		Grid1.Column3.Header1.Caption = "Emisi�n", ;
		Grid1.Column3.Header1.FontBold = .F., ;
		Grid1.Column3.Header1.ForeColor = 0,0,128, ;
		Grid1.Column3.Header1.Name = "Header1", ;
		Grid1.Column3.Name = "Column3", ;
		Grid1.Column3.Text1.Name = "Text1", ;
		Grid1.Column4.Header1.FontBold = .F., ;
		Grid1.Column4.Header1.ForeColor = 0,0,128, ;
		Grid1.Column4.Header1.Name = "Header1", ;
		Grid1.Column4.Name = "Column4", ;
		Grid1.Column4.Text1.Name = "Text1", ;
		Grid1.Column4.Width = 221, ;
		Grid1.Column5.Header1.FontBold = .F., ;
		Grid1.Column5.Header1.ForeColor = 0,0,128, ;
		Grid1.Column5.Header1.Name = "Header1", ;
		Grid1.Column5.Name = "Column5", ;
		Grid1.Column5.Text1.Name = "Text1", ;
		Grid1.Column6.Header1.FontBold = .F., ;
		Grid1.Column6.Header1.ForeColor = 0,0,128, ;
		Grid1.Column6.Header1.Name = "Header1", ;
		Grid1.Column6.Name = "Column6", ;
		Grid1.Column6.Text1.Name = "Text1", ;
		Grid1.Column7.Header1.Name = "Header1", ;
		Grid1.Column7.Name = "Column7", ;
		Grid1.Column7.Text1.Name = "Text1", ;
		Grid1.COLUMN8.Header1.Name = "Header1", ;
		Grid1.COLUMN8.Name = "COLUMN8", ;
		Grid1.COLUMN8.Text1.Name = "Text1", ;
		Grid1.Height = 93, ;
		Grid1.Left = 3, ;
		Grid1.Name = "Grid1", ;
		Grid1.Panel = 1, ;
		Grid1.Top = 18, ;
		Grid1.Width = 617, ;
		Grid1.ZOrderSet = 2, ;
		Label1.Name = "Label1", ;
		Label1.ZOrderSet = 1, ;
		Label2.Name = "Label2", ;
		Label3.Name = "Label3"
		*< END OBJECT: ClassLib="banco.vcx" BaseClass="container" />

	ADD OBJECT 'CODIGO1' AS embossedfield WITH ;
		ControlSource = "", ;
		FontSize = 8, ;
		Height = 19, ;
		InputMask = "!!!!!!", ;
		Left = 67, ;
		Name = "CODIGO1", ;
		TabIndex = 5, ;
		Top = 46, ;
		Visible = .T., ;
		Width = 51, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="textbox" />

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Caption = "Imprimir Comprobante de Retenciones", ;
		FontSize = 7, ;
		Height = 16, ;
		Left = 171, ;
		Name = "Command1", ;
		TabIndex = 84, ;
		Top = 271, ;
		Width = 168, ;
		ZOrderSet = 70
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command2' AS commandbutton WITH ;
		Caption = "Imp Com Retenciones", ;
		FontSize = 7, ;
		Height = 14, ;
		Left = 870, ;
		Name = "Command2", ;
		TabIndex = 88, ;
		Top = 148, ;
		Visible = .F., ;
		Width = 121, ;
		ZOrderSet = 86
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command3' AS commandbutton WITH ;
		Caption = "test conec", ;
		FontSize = 8, ;
		Height = 20, ;
		Left = 684, ;
		Name = "Command3", ;
		TabIndex = 89, ;
		Top = 0, ;
		Width = 64, ;
		ZOrderSet = 87
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Depositos1' AS depositos WITH ;
		Left = 108, ;
		Name = "Depositos1", ;
		Picture = globe.gif, ;
		TabIndex = 92, ;
		Top = 456, ;
		Visible = .F., ;
		ZOrderSet = 95, ;
		Container1.Name = "Container1", ;
		Grid1.Column1.Header1.Name = "Header1", ;
		Grid1.Column1.Name = "Column1", ;
		Grid1.Column1.Text1.Name = "Text1", ;
		Grid1.Column2.ColumnOrder = 4, ;
		Grid1.Column2.Header1.Name = "Header1", ;
		Grid1.Column2.Name = "Column2", ;
		Grid1.Column2.Text1.Name = "Text1", ;
		Grid1.Column3.ColumnOrder = 2, ;
		Grid1.Column3.Header1.Name = "Header1", ;
		Grid1.Column3.Name = "Column3", ;
		Grid1.Column3.Text1.Name = "Text1", ;
		Grid1.Column4.ColumnOrder = 5, ;
		Grid1.Column4.Header1.Name = "Header1", ;
		Grid1.Column4.Name = "Column4", ;
		Grid1.Column4.Text1.Name = "Text1", ;
		Grid1.Column5.ColumnOrder = 3, ;
		Grid1.Column5.Header1.Name = "Header1", ;
		Grid1.Column5.Name = "Column5", ;
		Grid1.Column5.Text1.Name = "Text1", ;
		Grid1.Name = "Grid1", ;
		Label1.Caption = "Carga de Transferencias", ;
		Label1.Name = "Label1"
		*< END OBJECT: ClassLib="banco.vcx" BaseClass="container" />

	ADD OBJECT 'DESCUENTOS1' AS descuentos WITH ;
		Left = 108, ;
		Name = "DESCUENTOS1", ;
		Picture = globe.gif, ;
		TabIndex = 90, ;
		Top = 451, ;
		Visible = .F., ;
		ZOrderSet = 91, ;
		GRDAUX_DCTOS.Column1.Header1.Name = "Header1", ;
		GRDAUX_DCTOS.Column1.Name = "Column1", ;
		GRDAUX_DCTOS.Column1.Text1.Name = "Text1", ;
		GRDAUX_DCTOS.Column2.Header1.Name = "Header1", ;
		GRDAUX_DCTOS.Column2.Name = "Column2", ;
		GRDAUX_DCTOS.Column2.Text1.Name = "Text1", ;
		GRDAUX_DCTOS.Column3.Header1.Name = "Header1", ;
		GRDAUX_DCTOS.Column3.Name = "Column3", ;
		GRDAUX_DCTOS.Column3.Text1.Name = "Text1", ;
		GRDAUX_DCTOS.Column4.Header1.Name = "Header1", ;
		GRDAUX_DCTOS.Column4.Name = "Column4", ;
		GRDAUX_DCTOS.Column4.Text1.Name = "Text1", ;
		GRDAUX_DCTOS.Column5.Header1.Name = "Header1", ;
		GRDAUX_DCTOS.Column5.Name = "Column5", ;
		GRDAUX_DCTOS.Column5.Text1.Name = "Text1", ;
		GRDAUX_DCTOS.Name = "GRDAUX_DCTOS", ;
		Label1.Name = "Label1", ;
		Label2.Name = "Label2"
		*< END OBJECT: ClassLib="banco.vcx" BaseClass="container" />

	ADD OBJECT 'Edit1' AS editbox WITH ;
		Height = 144, ;
		Left = 884, ;
		Name = "Edit1", ;
		TabIndex = 87, ;
		Top = 252, ;
		Visible = .T., ;
		Width = 336, ;
		ZOrderSet = 85
		*< END OBJECT: BaseClass="editbox" />

	ADD OBJECT 'Embossedlabel1' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		BackStyle = 1, ;
		Caption = "Ultimo:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Left = 122, ;
		Name = "Embossedlabel1", ;
		TabIndex = 69, ;
		Top = 5, ;
		Visible = .T., ;
		Width = 40, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel10' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Transf:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 155, ;
		Name = "Embossedlabel10", ;
		TabIndex = 68, ;
		Top = 359, ;
		Visible = .T., ;
		Width = 37, ;
		ZOrderSet = 30
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel11' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Efectivo:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 430, ;
		Name = "Embossedlabel11", ;
		TabIndex = 63, ;
		Top = 357, ;
		Visible = .T., ;
		Width = 44, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel12' AS embossedlabel WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackColor = 255,255,255, ;
		BackStyle = 1, ;
		Caption = "Totales", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Height = 14, ;
		Left = 870, ;
		Name = "Embossedlabel12", ;
		TabIndex = 80, ;
		Top = 168, ;
		Visible = .F., ;
		Width = 89, ;
		ZOrderSet = 84
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel13' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Retenciones:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 404, ;
		Name = "Embossedlabel13", ;
		TabIndex = 62, ;
		Top = 288, ;
		Visible = .T., ;
		Width = 65, ;
		ZOrderSet = 67
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel14' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Total", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 480, ;
		Name = "Embossedlabel14", ;
		TabIndex = 65, ;
		Top = 276, ;
		Visible = .T., ;
		Width = 25, ;
		ZOrderSet = 75
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel15' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Comisiones:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 481, ;
		Name = "Embossedlabel15", ;
		TabIndex = 61, ;
		Top = 288, ;
		Visible = .T., ;
		Width = 60, ;
		ZOrderSet = 76
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel16' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "%", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 513, ;
		Name = "Embossedlabel16", ;
		TabIndex = 60, ;
		Top = 305, ;
		Visible = .T., ;
		Width = 12, ;
		ZOrderSet = 77
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel17' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Total:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 537, ;
		Name = "Embossedlabel17", ;
		TabIndex = 64, ;
		Top = 304, ;
		Visible = .T., ;
		Width = 28, ;
		ZOrderSet = 79
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel18' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Descuentos:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 16, ;
		Left = 294, ;
		Name = "Embossedlabel18", ;
		TabIndex = 66, ;
		Top = 359, ;
		Visible = .T., ;
		Width = 63, ;
		ZOrderSet = 90
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel19' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Reintegro:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 15, ;
		Name = "Embossedlabel19", ;
		TabIndex = 47, ;
		Top = 109, ;
		Visible = .F., ;
		Width = 51, ;
		ZOrderSet = 35
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel2' AS embossedlabel WITH ;
		AutoSize = .T., ;
		Caption = "Total:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 282, ;
		Name = "Embossedlabel2", ;
		TabIndex = 58, ;
		Top = 251, ;
		Visible = .T., ;
		Width = 32, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel3' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Obs:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 15, ;
		Name = "Embossedlabel3", ;
		TabIndex = 47, ;
		Top = 70, ;
		Visible = .T., ;
		Width = 25, ;
		ZOrderSet = 35
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel4' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Fecha:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 327, ;
		Name = "Embossedlabel4", ;
		TabIndex = 49, ;
		Top = 6, ;
		Visible = .T., ;
		Width = 35, ;
		ZOrderSet = 27
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel5' AS embossedlabel WITH ;
		AutoSize = .T., ;
		Caption = "Anticipo:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 11, ;
		Name = "Embossedlabel5", ;
		TabIndex = 53, ;
		Top = 251, ;
		Visible = .T., ;
		Width = 44, ;
		ZOrderSet = 53
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel6' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Tipo:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 15, ;
		Name = "Embossedlabel6", ;
		TabIndex = 48, ;
		Top = 26, ;
		Visible = .T., ;
		Width = 25, ;
		ZOrderSet = 50
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel7' AS embossedlabel WITH ;
		AutoSize = .T., ;
		Caption = "Buscar por :", ;
		FontBold = .F., ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		ForeColor = 255,255,255, ;
		Left = 505, ;
		Name = "Embossedlabel7", ;
		TabIndex = 31, ;
		Top = 8, ;
		Visible = .T., ;
		Width = 62, ;
		ZOrderSet = 59
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel8' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Total", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 403, ;
		Name = "Embossedlabel8", ;
		TabIndex = 59, ;
		Top = 276, ;
		Visible = .T., ;
		Width = 25, ;
		ZOrderSet = 66
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Embossedlabel9' AS embossedlabel WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackColor = 255,255,255, ;
		BackStyle = 1, ;
		Caption = "Retenciones", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Height = 14, ;
		Left = 8, ;
		Name = "Embossedlabel9", ;
		TabIndex = 81, ;
		Top = 271, ;
		Visible = .T., ;
		Width = 158, ;
		ZOrderSet = 63
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'Grid1' AS grid WITH ;
		AllowAddNew = .F., ;
		ColumnCount = 6, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		Height = 35, ;
		Left = 8, ;
		Name = "Grid1", ;
		Panel = 1, ;
		ReadOnly = .F., ;
		RecordMark = .F., ;
		RecordSource = "aux_perlote", ;
		RowHeight = 17, ;
		ScrollBars = 2, ;
		TabIndex = 83, ;
		Top = 288, ;
		Width = 385, ;
		ZOrderSet = 62, ;
		Column1.Alignment = 2, ;
		Column1.ColumnOrder = 2, ;
		Column1.ControlSource = "aux_perlote.codali", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .F., ;
		Column1.Width = 29, ;
		Column2.Alignment = 2, ;
		Column2.ColumnOrder = 3, ;
		Column2.ControlSource = "aux_perlote.alicuota", ;
		Column2.Enabled = .F., ;
		Column2.FontBold = .T., ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 69, ;
		Column3.Alignment = 2, ;
		Column3.ColumnOrder = 1, ;
		Column3.ControlSource = "aux_perlote.neto", ;
		Column3.FontBold = .T., ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 69, ;
		Column4.ColumnOrder = 4, ;
		Column4.ControlSource = "aux_perlote.percepcion", ;
		Column4.Enabled = .T., ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 70, ;
		Column5.ColumnOrder = 5, ;
		Column5.ControlSource = "aux_perlote.lotehogar", ;
		Column5.Enabled = .T., ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .T., ;
		Column5.Width = 65, ;
		Column6.ColumnOrder = 6, ;
		Column6.ControlSource = "aux_perlote.total", ;
		Column6.Enabled = .F., ;
		Column6.FontBold = .T., ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 59
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Grid1.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "C�d", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Column1.Text1' AS textbox WITH ;
		Alignment = 2, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Alicuota", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Column2.Text1' AS textbox WITH ;
		Alignment = 2, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Base", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Column3.Text1' AS textbox WITH ;
		Alignment = 2, ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Imp IB", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Column4.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "L Hogar", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Column5.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Total", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Column6.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid2' AS grid WITH ;
		ColumnCount = 7, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		GridLineColor = 192,192,192, ;
		Height = 88, ;
		Left = 8, ;
		Name = "Grid2", ;
		Panel = 1, ;
		ReadOnly = .F., ;
		RecordMark = .F., ;
		RecordSource = "aux_faccom", ;
		RowHeight = 14, ;
		ScrollBars = 2, ;
		TabIndex = 11, ;
		Top = 155, ;
		Width = 464, ;
		ZOrderSet = 20, ;
		Column1.ControlSource = "aux_faccom.fecha", ;
		Column1.Enabled = .F., ;
		Column1.FontSize = 8, ;
		Column1.ForeColor = 0,0,0, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .F., ;
		Column1.Visible = .T., ;
		Column1.Width = 58, ;
		Column2.ControlSource = "aux_faccom.numero", ;
		Column2.Enabled = .F., ;
		Column2.FontSize = 8, ;
		Column2.ForeColor = 0,0,0, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .F., ;
		Column2.Visible = .T., ;
		Column2.Width = 87, ;
		Column3.ColumnOrder = 4, ;
		Column3.ControlSource = "aux_faccom.tot_fac", ;
		Column3.Enabled = .F., ;
		Column3.FontSize = 8, ;
		Column3.ForeColor = 0,0,0, ;
		Column3.Name = "Column3", ;
		Column3.ReadOnly = .F., ;
		Column3.Visible = .T., ;
		Column3.Width = 58, ;
		Column4.ColumnOrder = 6, ;
		Column4.ControlSource = "aux_faccom.pagado", ;
		Column4.Enabled = .F., ;
		Column4.FontSize = 8, ;
		Column4.ForeColor = 0,0,0, ;
		Column4.Name = "Column4", ;
		Column4.ReadOnly = .F., ;
		Column4.Visible = .T., ;
		Column4.Width = 57, ;
		Column5.ColumnOrder = 7, ;
		Column5.ControlSource = "aux_faccom.saldo", ;
		Column5.Enabled = .T., ;
		Column5.FontSize = 8, ;
		Column5.ForeColor = 0,0,0, ;
		Column5.Name = "Column5", ;
		Column5.ReadOnly = .F., ;
		Column5.Visible = .T., ;
		Column5.Width = 60, ;
		Column6.ColumnOrder = 3, ;
		Column6.ControlSource = "aux_faccom.tot_fac", ;
		Column6.Enabled = .F., ;
		Column6.FontSize = 8, ;
		Column6.ForeColor = 0,0,0, ;
		Column6.Name = "Column6", ;
		Column6.ReadOnly = .F., ;
		Column6.Width = 54, ;
		Column7.ColumnOrder = 5, ;
		Column7.ControlSource = "aux_faccom.total_imp", ;
		Column7.FontSize = 8, ;
		Column7.ForeColor = 0,0,0, ;
		Column7.Name = "Column7", ;
		Column7.ReadOnly = .F., ;
		Column7.Width = 61
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Grid2.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 192,192,192, ;
		Caption = "Fecha", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid2.Column1.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid2.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 192,192,192, ;
		Caption = "N�Factura", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid2.Column2.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid2.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 192,192,192, ;
		Caption = "Tot.Cta.Cte.", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid2.Column3.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid2.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 192,192,192, ;
		Caption = "Pagado", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid2.Column4.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid2.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 192,192,192, ;
		Caption = "Saldo", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid2.Column5.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid2.Column6.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Total Fact.", ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid2.Column6.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid2.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Tot Imp", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid2.Column7.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "aux_faccom.total_imp", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid3' AS grid WITH ;
		AllowAddNew = .F., ;
		ColumnCount = 3, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		Height = 88, ;
		Left = 500, ;
		Name = "Grid3", ;
		Panel = 1, ;
		RecordMark = .F., ;
		RecordSource = "aux_faccomsele", ;
		RowHeight = 14, ;
		ScrollBars = 2, ;
		TabIndex = 28, ;
		Top = 155, ;
		Width = 226, ;
		ZOrderSet = 26, ;
		Column1.ControlSource = "aux_faccomsele.fecha", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.Visible = .T., ;
		Column1.Width = 59, ;
		Column2.ControlSource = "aux_faccomsele.numero", ;
		Column2.Enabled = .F., ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.Visible = .T., ;
		Column2.Width = 90, ;
		Column3.ControlSource = "aux_faccomsele.importe", ;
		Column3.Enabled = .F., ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column3", ;
		Column3.Visible = .T., ;
		Column3.Width = 53
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Grid3.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 192,192,192, ;
		Caption = "Fecha", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid3.Column1.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid3.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "N�Factura", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid3.Column2.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid3.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Importe", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,160, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid3.Column3.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid4' AS grid WITH ;
		AllowAddNew = .F., ;
		ColumnCount = 6, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		GridLineColor = 192,192,192, ;
		Height = 49, ;
		Left = 870, ;
		Name = "Grid4", ;
		Panel = 1, ;
		ReadOnly = .F., ;
		RecordMark = .F., ;
		RecordSource = "aux_tipop", ;
		RowHeight = 13, ;
		ScrollBars = 2, ;
		TabIndex = 82, ;
		Top = 192, ;
		Visible = .F., ;
		Width = 348, ;
		ZOrderSet = 83, ;
		Column1.ControlSource = "aux_tipop.codigo", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Visible = .F., ;
		Column1.Width = 23, ;
		Column2.ColumnOrder = 5, ;
		Column2.ControlSource = "aux_tipop.total", ;
		Column2.Enabled = .T., ;
		Column2.FontBold = .T., ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .F., ;
		Column2.Visible = .F., ;
		Column2.Width = 41, ;
		Column3.ColumnOrder = 2, ;
		Column3.ControlSource = "aux_tipop.nombre", ;
		Column3.Enabled = .F., ;
		Column3.FontSize = 7, ;
		Column3.Name = "Column7", ;
		Column3.ReadOnly = .T., ;
		Column3.Visible = .F., ;
		Column3.Width = 72, ;
		Column4.ColumnOrder = 6, ;
		Column4.ControlSource = "aux_tipop.base", ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column3", ;
		Column4.ReadOnly = .F., ;
		Column4.Visible = .F., ;
		Column4.Width = 62, ;
		Column5.ColumnOrder = 3, ;
		Column5.ControlSource = "aux_tipop.reten", ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column4", ;
		Column5.ReadOnly = .F., ;
		Column5.Visible = .F., ;
		Column5.Width = 41, ;
		Column6.ColumnOrder = 4, ;
		Column6.ControlSource = "aux_tipop.lotehogar", ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column5", ;
		Column6.ReadOnly = .F., ;
		Column6.Visible = .F., ;
		Column6.Width = 40
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Grid4.Column1.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "C�d", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid4.Column1.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid4.Column2.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Total", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid4.Column2.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .F., ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid4.Column3.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Base", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid4.Column3.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid4.Column4.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Ing Bru", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid4.Column4.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid4.Column5.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Lot Hog", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid4.Column5.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid4.Column7.Header1' AS header WITH ;
		Alignment = 2, ;
		Caption = "Detalle", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid4.Column7.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		Enabled = .F., ;
		FontSize = 7, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Visible = .F.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Ismouseout1' AS ismouseout WITH ;
		Left = 77, ;
		Name = "Ismouseout1", ;
		Top = 456
		*< END OBJECT: ClassLib="xpform.vcx" BaseClass="timer" />

	ADD OBJECT 'Label1' AS label WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		Caption = "Facturas a pagar:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Height = 16, ;
		Left = 7, ;
		Name = "Label1", ;
		TabIndex = 72, ;
		Top = 140, ;
		Visible = .T., ;
		Width = 88, ;
		ZOrderSet = 21
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label10' AS label WITH ;
		BackColor = 255,0,0, ;
		Caption = "  Ret: para Financieras toma Monto Imponible", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 17, ;
		Left = 524, ;
		Name = "Label10", ;
		TabIndex = 91, ;
		Top = 72, ;
		Visible = .F., ;
		Width = 226, ;
		ZOrderSet = 94
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label100' AS label WITH ;
		AutoSize = .F., ;
		BackColor = 255,255,255, ;
		BackStyle = 1, ;
		Caption = '"Presione una letra (A .. Z) para Buscar', ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 255,126,64, ;
		Height = 19, ;
		Left = 123, ;
		Name = "Label100", ;
		TabIndex = 4, ;
		Top = 25, ;
		Visible = .F., ;
		Width = 309, ;
		ZOrderSet = 52
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		Caption = "Facturas seleccionadas:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Height = 16, ;
		Left = 500, ;
		Name = "Label2", ;
		TabIndex = 71, ;
		Top = 140, ;
		Visible = .T., ;
		Width = 121, ;
		ZOrderSet = 22
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		Caption = '"Presione TAB para salir de la grilla"', ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Height = 16, ;
		Left = 230, ;
		Name = "Label3", ;
		TabIndex = 70, ;
		Top = 140, ;
		Visible = .F., ;
		Width = 175, ;
		ZOrderSet = 29
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		Caption = "No hay Facturas Pendientes de  Pago", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,0,0, ;
		Height = 16, ;
		Left = 9, ;
		Name = "Label4", ;
		TabIndex = 74, ;
		Top = 140, ;
		Visible = .F., ;
		Width = 183, ;
		ZOrderSet = 25
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Cheques", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 16, ;
		Left = 15, ;
		Name = "Label5", ;
		TabIndex = 50, ;
		Top = 356, ;
		Width = 43, ;
		WordWrap = .T., ;
		ZOrderSet = 44
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Retenciones:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 16, ;
		Left = 622, ;
		Name = "Label6", ;
		TabIndex = 52, ;
		Top = 359, ;
		Visible = .F., ;
		Width = 63, ;
		WordWrap = .T., ;
		ZOrderSet = 55
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label7' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Importe :", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 16, ;
		Left = 506, ;
		Name = "Label7", ;
		TabIndex = 35, ;
		Top = 29, ;
		Width = 43, ;
		ZOrderSet = 60
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label8' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Financiera :", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 16, ;
		Left = 539, ;
		Name = "Label8", ;
		TabIndex = 37, ;
		Top = 49, ;
		Width = 58, ;
		ZOrderSet = 92
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label9' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Cheque en Cart:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 16, ;
		Left = 496, ;
		Name = "Label9", ;
		TabIndex = 51, ;
		Top = 357, ;
		Visible = .T., ;
		Width = 54, ;
		WordWrap = .T., ;
		ZOrderSet = 65
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'labelorden' AS embossedlabel WITH ;
		AutoSize = .T., ;
		Caption = "", ;
		FontBold = .T., ;
		FontSize = 8, ;
		Height = 16, ;
		Left = 165, ;
		Name = "labelorden", ;
		TabIndex = 67, ;
		Top = 5, ;
		Visible = .T., ;
		Width = 2, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'LabelTotal' AS label WITH ;
		AutoSize = .F., ;
		BackColor = 255,255,255, ;
		Caption = "", ;
		FontBold = .F., ;
		FontSize = 10, ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 404, ;
		Name = "LabelTotal", ;
		TabIndex = 75, ;
		Top = 327, ;
		Visible = .T., ;
		Width = 219, ;
		ZOrderSet = 72
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'LBLCODIGO1' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "C�digo:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 15, ;
		Name = "LBLCODIGO1", ;
		TabIndex = 45, ;
		Top = 49, ;
		Visible = .T., ;
		Width = 38, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'LBLNROORD1' AS embossedlabel WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "N� orden:", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Left = 15, ;
		Name = "LBLNROORD1", ;
		TabIndex = 46, ;
		Top = 6, ;
		Visible = .T., ;
		Width = 48, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="label" />

	ADD OBJECT 'NROORD1' AS embossedfield WITH ;
		ControlSource = "", ;
		FontSize = 8, ;
		Height = 19, ;
		InputMask = "999999", ;
		Left = 67, ;
		Name = "NROORD1", ;
		TabIndex = 1, ;
		Top = 3, ;
		Visible = .T., ;
		Width = 51, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="textbox" />

	ADD OBJECT 'reintegros' AS container WITH ;
		BackColor = 255,255,255, ;
		BorderColor = 0,64,128, ;
		BorderWidth = 4, ;
		Height = 233, ;
		Left = 271, ;
		Name = "reintegros", ;
		TabIndex = 94, ;
		Top = 12, ;
		Visible = .F., ;
		Width = 530, ;
		ZOrderSet = 102
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'reintegros.Check_anulado' AS checkbox WITH ;
		BackColor = 255,0,0, ;
		Caption = "    Anulado", ;
		DisabledBackColor = 249,249,249, ;
		ForeColor = 255,255,255, ;
		Height = 17, ;
		Left = 85, ;
		Name = "Check_anulado", ;
		ReadOnly = .T., ;
		Top = 173, ;
		Width = 108
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'reintegros.Check_pagado' AS checkbox WITH ;
		BackStyle = 0, ;
		Caption = "", ;
		DisabledBackColor = 249,249,249, ;
		Height = 17, ;
		Left = 86, ;
		Name = "Check_pagado", ;
		ReadOnly = .T., ;
		Top = 143, ;
		Width = 15
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'reintegros.Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Nro:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 55, ;
		Name = "Label1", ;
		Top = 55, ;
		Width = 26
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label10' AS label WITH ;
		BackStyle = 0, ;
		Caption = "C�d Descuento:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 173, ;
		Name = "Label10", ;
		Top = 111, ;
		Width = 92
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label11' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Imp Pag:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 275, ;
		Name = "Label11", ;
		Top = 144, ;
		Width = 49
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label2' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Documento:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 15, ;
		Name = "Label2", ;
		Top = 81, ;
		Width = 69
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label3' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Legajo:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 87, ;
		Name = "Label3", ;
		Top = 225, ;
		Visible = .F., ;
		Width = 43
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label4' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Importe:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 35, ;
		Name = "Label4", ;
		Top = 111, ;
		Width = 49
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label5' AS label WITH ;
		BackStyle = 0, ;
		Caption = "F. Proceso:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 270, ;
		Name = "Label5", ;
		Top = 226, ;
		Visible = .F., ;
		Width = 64
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label6' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Periodo:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 215, ;
		Name = "Label6", ;
		Top = 55, ;
		Width = 43
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label7' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Pagado:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 39, ;
		Name = "Label7", ;
		Top = 145, ;
		Width = 43
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label8' AS label WITH ;
		BackStyle = 0, ;
		Caption = "DATOS DEL REINTEGRO           (SIST. DE ORDENES)", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 48, ;
		Name = "Label8", ;
		Top = 21, ;
		Width = 372
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Label9' AS label WITH ;
		BackStyle = 0, ;
		Caption = "F. Pago:", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 17, ;
		Left = 407, ;
		Name = "Label9", ;
		Top = 145, ;
		Width = 45
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'reintegros.Line1' AS line WITH ;
		BorderColor = 0,64,128, ;
		Height = 0, ;
		Left = -28, ;
		Name = "Line1", ;
		Top = 40, ;
		Width = 529
		*< END OBJECT: BaseClass="line" />

	ADD OBJECT 'reintegros.txtcodigo_descuento' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 268, ;
		Name = "txtcodigo_descuento", ;
		ReadOnly = .T., ;
		Top = 108, ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtdocumento' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 86, ;
		Name = "txtdocumento", ;
		ReadOnly = .T., ;
		Top = 78, ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtfecha_pagado' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 455, ;
		Name = "txtfecha_pagado", ;
		ReadOnly = .T., ;
		Top = 142, ;
		Width = 65
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtfecha_proceso' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 336, ;
		Name = "txtfecha_proceso", ;
		ReadOnly = .T., ;
		Top = 223, ;
		Visible = .F., ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtimporte' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 86, ;
		Name = "txtimporte", ;
		ReadOnly = .T., ;
		Top = 108, ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtimppagado' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 326, ;
		Name = "txtimppagado", ;
		ReadOnly = .T., ;
		Top = 141, ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtlegajo' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 132, ;
		Name = "txtlegajo", ;
		ReadOnly = .T., ;
		Top = 223, ;
		Visible = .F., ;
		Width = 109
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtnombre' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 166, ;
		Name = "txtnombre", ;
		ReadOnly = .T., ;
		Top = 78, ;
		Width = 260
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtnumero' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 86, ;
		Name = "txtnumero", ;
		ReadOnly = .T., ;
		Top = 52, ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtpagado' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 105, ;
		Name = "txtpagado", ;
		ReadOnly = .T., ;
		Top = 142, ;
		Width = 165
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.txtperiodo' AS textbox WITH ;
		DisabledBackColor = 249,249,249, ;
		FontSize = 8, ;
		Height = 21, ;
		Left = 265, ;
		Name = "txtperiodo", ;
		ReadOnly = .T., ;
		Top = 52, ;
		Width = 72
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'reintegros.Xpbutton1' AS xpbutton WITH ;
		Height = 25, ;
		Left = 225, ;
		Name = "Xpbutton1", ;
		TabIndex = 22, ;
		Top = 195, ;
		Width = 79, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 17, ;
		imgImage.Left = 4, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = money.ico, ;
		imgImage.Stretch = 1, ;
		imgImage.Top = 6, ;
		imgImage.Width = 15, ;
		lblText.Caption = "Pagar", ;
		lblText.FontBold = .T., ;
		lblText.FontSize = 8, ;
		lblText.ForeColor = 0,64,128, ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'reintegros.Xpbutton3' AS xpbutton WITH ;
		Height = 25, ;
		Left = 432, ;
		Name = "Xpbutton3", ;
		TabIndex = 22, ;
		Top = 195, ;
		Width = 79, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 17, ;
		imgImage.Left = 4, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = arw02lt.ico, ;
		imgImage.Stretch = 1, ;
		imgImage.Top = 6, ;
		imgImage.Width = 15, ;
		lblText.Caption = "Cerrar", ;
		lblText.FontBold = .T., ;
		lblText.FontSize = 8, ;
		lblText.ForeColor = 0,64,128, ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Reposicion' AS checkbox WITH ;
		BackColor = 255,255,128, ;
		BackStyle = 1, ;
		Caption = "    Reposici�n Saldo Fijo - para Salon Venta Ordenes", ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 0,64,128, ;
		Height = 14, ;
		Left = 68, ;
		Name = "Reposicion", ;
		TabIndex = 8, ;
		Top = 89, ;
		Visible = .F., ;
		Width = 320, ;
		ZOrderSet = 82
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'ret1' AS label WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		Caption = "Se efectuaran retenciones ", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,0,0, ;
		Height = 16, ;
		Left = 615, ;
		Name = "ret1", ;
		TabIndex = 76, ;
		Top = 18, ;
		Visible = .F., ;
		Width = 134, ;
		ZOrderSet = 68
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'ret2' AS label WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		Caption = "al periodo actual", ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 255,0,0, ;
		Height = 16, ;
		Left = 636, ;
		Name = "ret2", ;
		TabIndex = 73, ;
		Top = 35, ;
		Visible = .F., ;
		Width = 81, ;
		ZOrderSet = 69
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Ret_encartera1' AS ret_encartera WITH ;
		Height = 121, ;
		Left = 104, ;
		Name = "Ret_encartera1", ;
		TabIndex = 79, ;
		Top = 457, ;
		Visible = .F., ;
		Width = 618, ;
		ZOrderSet = 58, ;
		Container1.Name = "Container1", ;
		Grid1.Column1.Header1.Name = "Header1", ;
		Grid1.Column1.Name = "Column1", ;
		Grid1.Column1.Text1.Name = "Text1", ;
		Grid1.Column2.Header1.Name = "Header1", ;
		Grid1.Column2.Name = "Column2", ;
		Grid1.Column2.Text1.Name = "Text1", ;
		Grid1.Column3.Header1.Name = "Header1", ;
		Grid1.Column3.Name = "Column3", ;
		Grid1.Column3.Text1.Name = "Text1", ;
		Grid1.Column4.Header1.Name = "Header1", ;
		Grid1.Column4.Name = "Column4", ;
		Grid1.Column4.Text1.Name = "Text1", ;
		Grid1.Column5.Header1.Name = "Header1", ;
		Grid1.Column5.Name = "Column5", ;
		Grid1.Column5.Text1.Name = "Text1", ;
		Grid1.Name = "Grid1", ;
		LBLNROMODELO1.Name = "LBLNROMODELO1", ;
		Label2.Name = "Label2", ;
		Text1.Name = "Text1", ;
		labelfiltro.Name = "labelfiltro"
		*< END OBJECT: ClassLib="banco.vcx" BaseClass="container" />

	ADD OBJECT 'Shape1' AS shape WITH ;
		BackStyle = 0, ;
		Height = 110, ;
		Left = 5, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 137, ;
		Width = 748, ;
		ZOrderSet = 9
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape2' AS shape WITH ;
		BackStyle = 0, ;
		Height = 131, ;
		Left = 5, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 1, ;
		Width = 748, ;
		ZOrderSet = 10
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape4' AS shape WITH ;
		BackStyle = 0, ;
		Height = 87, ;
		Left = 5, ;
		Name = "Shape4", ;
		SpecialEffect = 0, ;
		Top = 269, ;
		Width = 753, ;
		ZOrderSet = 8
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape5' AS shape WITH ;
		BackStyle = 0, ;
		Height = 58, ;
		Left = 5, ;
		Name = "Shape5", ;
		SpecialEffect = 0, ;
		Top = 355, ;
		Width = 754, ;
		ZOrderSet = 11
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape6' AS shape WITH ;
		BackStyle = 0, ;
		Height = 26, ;
		Left = 5, ;
		Name = "Shape6", ;
		SpecialEffect = 0, ;
		Top = 245, ;
		Width = 400, ;
		ZOrderSet = 12
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Text1' AS textbox WITH ;
		Comment = "", ;
		ControlSource = "", ;
		DisabledBackColor = 255,255,255, ;
		DisabledForeColor = 255,255,255, ;
		FontSize = 8, ;
		Height = 19, ;
		Left = 553, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		TabIndex = 18, ;
		Top = 358, ;
		Width = 72, ;
		ZOrderSet = 45
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text10' AS textbox WITH ;
		Alignment = 3, ;
		DisabledBackColor = 255,255,255, ;
		FontSize = 8, ;
		Format = "", ;
		Height = 19, ;
		InputMask = "999999.99", ;
		Left = 67, ;
		Margin = 0, ;
		Name = "Text10", ;
		ReadOnly = .T., ;
		TabIndex = 14, ;
		TabStop = .T., ;
		Top = 358, ;
		Value = , ;
		Width = 72, ;
		ZOrderSet = 31
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text11' AS textbox WITH ;
		Alignment = 3, ;
		DisabledBackColor = 255,255,255, ;
		FontSize = 8, ;
		Format = "", ;
		Height = 19, ;
		InputMask = "999999.99", ;
		Left = 415, ;
		Margin = 0, ;
		Name = "Text11", ;
		OLEDropMode = 1, ;
		ReadOnly = .F., ;
		TabIndex = 17, ;
		TabStop = .F., ;
		Top = 376, ;
		Value = , ;
		Width = 71, ;
		ZOrderSet = 33
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text12' AS textbox WITH ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Format = "!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!", ;
		Height = 19, ;
		Left = 67, ;
		MaxLength = 40, ;
		Name = "Text12", ;
		TabIndex = 7, ;
		TabStop = .T., ;
		Top = 68, ;
		Width = 366, ;
		ZOrderSet = 34
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text13' AS textbox WITH ;
		ControlSource = "thisform.financiera", ;
		Enabled = .F., ;
		FontBold = .T., ;
		FontSize = 8, ;
		Height = 20, ;
		Left = 597, ;
		Name = "Text13", ;
		ReadOnly = .F., ;
		TabIndex = 27, ;
		TabStop = .F., ;
		Top = 46, ;
		Width = 20, ;
		ZOrderSet = 93
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text14' AS textbox WITH ;
		Alignment = 3, ;
		DisabledBackColor = 255,255,255, ;
		FontSize = 8, ;
		Format = "", ;
		Height = 19, ;
		InputMask = "999999.99", ;
		Left = 199, ;
		Margin = 0, ;
		Name = "Text14", ;
		ReadOnly = .T., ;
		TabIndex = 15, ;
		TabStop = .T., ;
		Top = 358, ;
		Value = , ;
		Width = 72, ;
		ZOrderSet = 97
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text2' AS textbox WITH ;
		Alignment = 3, ;
		FontBold = .F., ;
		FontSize = 8, ;
		Format = "R", ;
		Height = 19, ;
		InputMask = "99999999.99", ;
		Left = 61, ;
		Name = "Text2", ;
		TabIndex = 12, ;
		Top = 249, ;
		Value = 0, ;
		Width = 83, ;
		ZOrderSet = 54
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text3' AS textbox WITH ;
		FontSize = 8, ;
		Height = 19, ;
		InputMask = "!!!", ;
		Left = 67, ;
		Name = "Text3", ;
		TabIndex = 3, ;
		Top = 24, ;
		Width = 51, ;
		ZOrderSet = 49
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text4' AS textbox WITH ;
		DisabledBackColor = 255,255,255, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .T., ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Format = "!", ;
		Height = 19, ;
		Left = 122, ;
		Name = "Text4", ;
		TabIndex = 6, ;
		TabStop = .T., ;
		Top = 46, ;
		Width = 311, ;
		ZOrderSet = 19
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text5' AS textbox WITH ;
		Alignment = 3, ;
		FontBold = .T., ;
		FontSize = 8, ;
		Format = "R", ;
		Height = 19, ;
		InputMask = "99999999.99", ;
		Left = 317, ;
		Name = "Text5", ;
		TabIndex = 13, ;
		Top = 249, ;
		Value = 0, ;
		Width = 87, ;
		ZOrderSet = 24
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text6' AS textbox WITH ;
		DisabledBackColor = 255,255,255, ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontBold = .F., ;
		FontSize = 8, ;
		ForeColor = 0,0,128, ;
		Format = "!", ;
		Height = 19, ;
		Left = 122, ;
		Name = "Text6", ;
		TabIndex = 25, ;
		TabStop = .T., ;
		Top = 24, ;
		Width = 311, ;
		ZOrderSet = 51
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text7' AS textbox WITH ;
		FontSize = 8, ;
		Height = 19, ;
		Left = 365, ;
		Name = "Text7", ;
		TabIndex = 2, ;
		Top = 4, ;
		Width = 68, ;
		ZOrderSet = 28
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text8' AS textbox WITH ;
		Comment = "", ;
		ControlSource = "", ;
		DisabledBackColor = 255,255,255, ;
		DisabledForeColor = 255,255,255, ;
		FontSize = 8, ;
		Height = 19, ;
		Left = 688, ;
		Name = "Text8", ;
		ReadOnly = .T., ;
		TabIndex = 19, ;
		Top = 357, ;
		Visible = .F., ;
		Width = 72, ;
		ZOrderSet = 56
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Text9' AS textbox WITH ;
		FontBold = .T., ;
		FontSize = 8, ;
		Height = 20, ;
		Left = 547, ;
		Name = "Text9", ;
		ReadOnly = .F., ;
		TabIndex = 26, ;
		TabStop = .F., ;
		Top = 24, ;
		Width = 71, ;
		ZOrderSet = 61
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'totret' AS embossedfield WITH ;
		Alignment = 1, ;
		ControlSource = "", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		Height = 19, ;
		InputMask = "9999999.99", ;
		Left = 402, ;
		Name = "totret", ;
		TabIndex = 33, ;
		Top = 302, ;
		Visible = .T., ;
		Width = 65, ;
		ZOrderSet = 64
		*< END OBJECT: ClassLib="wizstyle.vcx" BaseClass="textbox" />

	ADD OBJECT 'txt_totalcomi' AS textbox WITH ;
		FontSize = 8, ;
		Height = 19, ;
		Left = 562, ;
		Name = "txt_totalcomi", ;
		ReadOnly = .T., ;
		TabIndex = 86, ;
		Top = 302, ;
		Width = 61, ;
		ZOrderSet = 78
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtcomi' AS textbox WITH ;
		FontSize = 8, ;
		Height = 19, ;
		Left = 481, ;
		Name = "txtcomi", ;
		ReadOnly = .T., ;
		TabIndex = 85, ;
		Top = 303, ;
		Width = 31, ;
		ZOrderSet = 74
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtdescuentos' AS textbox WITH ;
		DisabledBackColor = 255,255,255, ;
		DisabledForeColor = 128,128,128, ;
		Enabled = .F., ;
		Height = 20, ;
		Left = 354, ;
		Name = "txtdescuentos", ;
		TabIndex = 16, ;
		Top = 358, ;
		Width = 57, ;
		ZOrderSet = 88
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'txtreintegro' AS textbox WITH ;
		FontSize = 8, ;
		Height = 21, ;
		InputMask = "9999999999", ;
		Left = 68, ;
		Name = "txtreintegro", ;
		TabIndex = 9, ;
		Top = 107, ;
		Visible = .F., ;
		Width = 54, ;
		ZOrderSet = 99
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Xpbutton1' AS xpbutton WITH ;
		Left = 246, ;
		Name = "Xpbutton1", ;
		TabIndex = 42, ;
		Top = 594, ;
		ZOrderSet = 37, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-continue.gif, ;
		imgImage.Width = 14, ;
		lblText.Caption = "Salir", ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .T., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton10' AS xpbutton WITH ;
		Height = 20, ;
		Left = 168, ;
		Name = "Xpbutton10", ;
		TabIndex = 56, ;
		Top = 247, ;
		Visible = .F., ;
		Width = 101, ;
		ZOrderSet = 73, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Left = 5, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-continue.gif, ;
		imgImage.Top = 4, ;
		imgImage.Width = 13, ;
		lblText.Caption = "Marcar Todas", ;
		lblText.FontSize = 8, ;
		lblText.Left = 22, ;
		lblText.Name = "lblText", ;
		lblText.Top = 3, ;
		cmdHide.Cancel = .T., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton11' AS xpbutton WITH ;
		Height = 18, ;
		Left = 532, ;
		Name = "Xpbutton11", ;
		TabIndex = 55, ;
		Top = 273, ;
		Width = 100, ;
		ZOrderSet = 80, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Left = 2, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-continue.gif, ;
		imgImage.Top = 4, ;
		imgImage.Width = 13, ;
		lblText.Caption = "Aplicar Comisi�n:", ;
		lblText.FontSize = 8, ;
		lblText.Left = 17, ;
		lblText.Name = "lblText", ;
		lblText.Top = 3, ;
		cmdHide.Cancel = .T., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton12' AS xpbutton WITH ;
		Height = 17, ;
		Left = 625, ;
		Name = "Xpbutton12", ;
		TabIndex = 54, ;
		Top = 138, ;
		Width = 100, ;
		ZOrderSet = 81, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Left = 2, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-continue.gif, ;
		imgImage.Top = 4, ;
		imgImage.Width = 13, ;
		lblText.Caption = "Ver Detalle OC", ;
		lblText.FontSize = 8, ;
		lblText.Left = 17, ;
		lblText.Name = "lblText", ;
		lblText.Top = 2, ;
		cmdHide.Cancel = .T., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton13' AS xpbutton WITH ;
		Height = 30, ;
		Left = 168, ;
		Name = "Xpbutton13", ;
		TabIndex = 29, ;
		Top = 380, ;
		Width = 106, ;
		ZOrderSet = 96, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 28, ;
		imgImage.Left = 1, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = chequ10b.ico, ;
		imgImage.Stretch = 2, ;
		imgImage.Top = 0, ;
		imgImage.Width = 26, ;
		lblText.Caption = "Transferencias", ;
		lblText.FontSize = 8, ;
		lblText.Left = 25, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton14' AS xpbutton WITH ;
		Left = 830, ;
		Name = "Xpbutton14", ;
		TabIndex = 38, ;
		Top = 564, ;
		Visible = .F., ;
		ZOrderSet = 98, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 16, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-ok.gif, ;
		imgImage.Width = 16, ;
		lblText.Caption = "Grabar", ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton15' AS xpbutton WITH ;
		Height = 31, ;
		Left = 313, ;
		Name = "Xpbutton15", ;
		TabIndex = 44, ;
		Top = 380, ;
		Width = 91, ;
		ZOrderSet = 89, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 22, ;
		imgImage.Left = -2, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = orders.ico, ;
		imgImage.Stretch = 1, ;
		imgImage.Top = 5, ;
		imgImage.Width = 21, ;
		lblText.Caption = "Descuentos", ;
		lblText.Left = 20, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton16' AS xpbutton WITH ;
		Height = 21, ;
		Left = 126, ;
		Name = "Xpbutton16", ;
		TabIndex = 10, ;
		Top = 107, ;
		Visible = .F., ;
		Width = 79, ;
		ZOrderSet = 100, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 17, ;
		imgImage.Left = 4, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = bullet_add.png, ;
		imgImage.Stretch = 1, ;
		imgImage.Top = 3, ;
		imgImage.Width = 15, ;
		lblText.Caption = "Ver Datos", ;
		lblText.FontBold = .T., ;
		lblText.FontSize = 8, ;
		lblText.ForeColor = 0,64,128, ;
		lblText.Left = 20, ;
		lblText.Name = "lblText", ;
		lblText.Top = 4, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton2' AS xpbutton WITH ;
		Left = 348, ;
		Name = "Xpbutton2", ;
		TabIndex = 39, ;
		Top = 593, ;
		ZOrderSet = 39, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 16, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-ok.gif, ;
		imgImage.Width = 16, ;
		lblText.Caption = "Grabar", ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton3' AS xpbutton WITH ;
		Left = 450, ;
		Name = "Xpbutton3", ;
		TabIndex = 41, ;
		Top = 594, ;
		ZOrderSet = 40, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 16, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-cancel.gif, ;
		imgImage.Width = 16, ;
		lblText.Caption = "Eliminar", ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton4' AS xpbutton WITH ;
		Left = 552, ;
		Name = "Xpbutton4", ;
		TabIndex = 40, ;
		Top = 594, ;
		Visible = .F., ;
		ZOrderSet = 41, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 22, ;
		imgImage.Left = 4, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = impresora2.ico, ;
		imgImage.Stretch = 2, ;
		imgImage.Top = 4, ;
		imgImage.Width = 28, ;
		lblText.Caption = "Imprimir", ;
		lblText.Left = 37, ;
		lblText.Name = "lblText", ;
		lblText.Top = 6, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton5' AS xpbutton WITH ;
		Left = 6, ;
		Name = "Xpbutton5", ;
		TabIndex = 43, ;
		Top = 416, ;
		ZOrderSet = 42, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = add.bmp, ;
		imgImage.Width = 15, ;
		lblText.Caption = "Asientos", ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton6' AS xpbutton WITH ;
		Height = 30, ;
		Left = 32, ;
		Name = "Xpbutton6", ;
		TabIndex = 30, ;
		Top = 381, ;
		Visible = .T., ;
		Width = 106, ;
		ZOrderSet = 43, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 28, ;
		imgImage.Left = 1, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = chequ10b.ico, ;
		imgImage.Stretch = 2, ;
		imgImage.Top = 0, ;
		imgImage.Width = 26, ;
		lblText.Caption = "Cheques Propios", ;
		lblText.FontSize = 8, ;
		lblText.Left = 25, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton7' AS xpbutton WITH ;
		Left = 526, ;
		Name = "Xpbutton7", ;
		TabIndex = 32, ;
		Top = 381, ;
		Visible = .T., ;
		ZOrderSet = 46, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 23, ;
		imgImage.Left = 3, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = chequ10b.ico, ;
		imgImage.Stretch = 1, ;
		imgImage.Top = 4, ;
		imgImage.Width = 23, ;
		lblText.Caption = "Ch.Terceros", ;
		lblText.Left = 25, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton8' AS xpbutton WITH ;
		Left = 668, ;
		Name = "Xpbutton8", ;
		TabIndex = 34, ;
		Top = 379, ;
		Visible = .F., ;
		ZOrderSet = 57, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 22, ;
		imgImage.Left = 2, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = noteb12b.ico, ;
		imgImage.Stretch = 1, ;
		imgImage.Top = 4, ;
		imgImage.Width = 21, ;
		lblText.Caption = "Retenciones", ;
		lblText.Left = 25, ;
		lblText.Name = "lblText", ;
		lblText.Top = 5, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton9' AS xpbutton WITH ;
		Height = 30, ;
		Left = 88, ;
		Name = "Xpbutton9", ;
		TabIndex = 57, ;
		Top = 594, ;
		Width = 156, ;
		ZOrderSet = 71, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-continue.gif, ;
		imgImage.Width = 14, ;
		lblText.Caption = "Carga Tipos Retenciones", ;
		lblText.FontSize = 8, ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .T., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />
	
	PROCEDURE asiento
		param campo,_tipo &&//El campo es la clave que hace referencia a los asientos.Los tipos posibles son : (sin datos es para limpiar),mostrar,grabar,eliminar
		store space(6) to asiento,cam
		cam=ceros(str(val(campo),6),6)
		with thisform
			select detacont
			set filte to periodo=_periodosele && periodo_actual.periodo
			select movicont 
			set filte to periodo=_periodosele &&periodo_actual.periodo
			if empty(cam) and empty(_tipo)
				.asiento1.text4.value=0.00	
				.asiento1.text5.value=0.00	
				.asiento1.text6.value=0.00	
				.asiento1.nro.caption=""
				select tabla15
				=tablerevert(.t.)
				append blank
				.asiento1.refresh
			else	
				.asiento1.text4.value=0.00	
				.asiento1.text5.value=0.00	
				.asiento1.text6.value=0.00	
				do case
					case alltr(_tipo)='mostrar'	
						select tabla15
						=tablerevert(.t.)			
						select movicont
						set order to pag_prov
						seek cam
						if found()
							thisform.asiento1.nro.caption="Asiento N�: "+alltr(movicont.nroasiento)
							do while not eof() and pag_prov=cam
								scatte memvar
								m.registro=recno()
								sele cuencont
								set order to codigo
								seek m.codigo
								m.detalle=nombre
								sele tabla15
								appen blan
								if m.debehaber='D'
									m.debe=importe
									m.haber=0
									thisform.asiento1.text4.value=thisform.asiento1.text4.value+importe
									thisform.asiento1.text5.value=thisform.asiento1.text5.value+importe
								else
									m.haber=importe
									m.debe=0
									thisform.asiento1.text4.value=thisform.asiento1.text4.value-importe 
									thisform.asiento1.text6.value=thisform.asiento1.text6.value+importe
								endif
								gather memvar
								sele movicont
								skip
							enddo
						endif
					case alltr(_tipo)='grabar'	
						select detacont
						set order to pag_prov
						seek cam
						if found()
							asiento=nroasiento
							uni=unico
						else
							set order to nroasiento
							go bott
							asiento=ceros(str(val(nroasiento)+1,6),6)	
							uni=sys(2015)
							append blank
						endif
						repl nroasiento with asiento
						repl periodo with _periodosele &&periodo_actual.periodo
						repl unico with uni
						repl detalle with 'Pago N�: '+cam+' '+thisform.text12.value
						repl leyenda with Alltrim(thisform.text4.value)
						repl fecha    with thisform.text7.value					
						repl pag_prov with cam
						repl tipo with '2'
						sele tabla15
						go top
						do while not eof() and val(codigo)#0
							scatter memvar
							letra=iif(m.debe#0,'D','H')
							m.nroasiento=asiento
							m.pag_prov=cam
							m.codigo=m.codigo
							m.fecha=thisform.text7.value
							m.unico=uni
							m.periodo=_periodosele  &&periodo_actual.periodo
							m.tipo='2'
							if letra='D'
								m.debehaber='D'
								m.importe=m.debe
							else
								m.debehaber='H'
								m.importe=m.haber
							endif	
							sele movicont
							if m.registro=0
								appe blan
								gather memvar
							else
								go record m.registro
								if m.debe=0	and m.haber=0
									dele 
								else
									gather memvar	
								endif
							endif
							sele tabla15
							skip
						enddo
					case alltr(_tipo)='eliminar'	
						select detacont
						set order to pag_prov
						seek cam
						if found()
							dele
						endif
						select movicont
						set order to pag_prov
						seek cam
						if found()
							do while not eof() and pag_prov=cam
								dele
								seek cam
							enddo
						endif					
				endcase
				.asiento1.grid1.refresh	
			endif	
			select detacont
			set filte to 
			select movicont 
			set filte to 
		endwith	
	ENDPROC

	PROCEDURE asi_automaticos
		select tabla15
		=tablerevert(.t.)
		if empty(thisform.codigo1.value)
			append blank
		else
			if thisform.text3.value="001"
				select proveedores
				set order to codigo
				seek thisform.codigo1.value
				if found()
					select cuencont
					set order to codigo
					seek proveedores.cuenta
					if found()
						select tabla15
						set order to codigo
						seek proveedores.cuenta
						if !found()
							appen blank
						endif	
						repl codigo with proveedores.cuenta,detalle with cuencont.nombre
						repl haber with 0.00,debe with thisform.text5.value
						*repl haber with 0.00,debe with (thisform.text5.value-thisform.totret.value)
					endif
				endif		
			Endif	
			if thisform.text3.value="002"
				select bancos
				set order to codigo
				seek alltr(thisform.codigo1.value)
				if found()
					select cuencont
					set order to codigo
					seek bancos.cuenta
					if found()
						select tabla15
						set order to codigo
						seek bancos.cuenta
						if !found()
							appen blank
						endif	
						repl codigo with bancos.cuenta,detalle with cuencont.nombre
						repl haber with 0.00,debe with thisform.text5.value
						*repl haber with 0.00,debe with (thisform.text5.value-thisform.totret.value)
					endif
				endif		
			Endif		
		endif	
		if thisform.text10.value#0
			select deposito
			set order to
			go top
			do while not eof() 
				if val(codigo_ban)#0
			
					&& debo ver si el cheque, es un cheque que se entrego in registracion de comprobante, en este caso, debo invertir el asiento que se realiz� en el Egreso. marce 26-02-2013
					_cuenta=''
					sele movimientos_bancos
					set order to numero
					seek deposito.codigo_ban + '001' + deposito.numero_com
					if found() and pend_reg=1
						_cuenta=asig_cuentas.doc_pend
						repl deposito.pend_reg with 1
					else
						select bancos
						set order to codigo
						seek deposito.codigo_ban
						if found()
							_cuenta=bancos.cuenta
						endif
					endif
					
					select cuencont
					set order to codigo
					seek _cuenta
					if found()
						select tabla15
						append blank
						repl codigo with _cuenta,detalle with cuencont.nombre
						repl haber with deposito.importe,debe with 0.00
						repl nro_cheque with alltrim(deposito.numero_com) && marce 26-02-2013
					endif
				endif
				
				select deposito
				skip
			enddo
		EndIf
		*------ Transferencias  ------------------------------
		if thisform.text14.value#0
			select deposito2
			go top
			do while not eof() and val(codigo_ban)#0
			
					&& debo ver si el cheque, es un cheque que se entrego in registracion de comprobante, en este caso, debo invertir el asiento que se realiz� en el Egreso. marce 26-02-2013
					_cuenta=''
					select bancos
					set order to codigo
					seek deposito2.codigo_ban
					if found()
						_cuenta=bancos.cuenta
					EndIf
						
					select cuencont
					set order to codigo
					seek _cuenta
					if found()
						select tabla15
						append blank
						repl codigo with _cuenta,detalle with cuencont.nombre
						repl haber with deposito2.importe,debe with 0.00
						repl nro_cheque with alltrim(deposito2.numero_com) && marce 26-02-2013
					endif
		
				
				select deposito2
				skip
			enddo
		EndIf
		*-------------- Fin Transferencias. -----------------------------------------
		If thisform.text1.value#0
			select tabla15
			Appen Blank
			repl codigo with thisform.c_ChequeTer
			repl detalle with vercod("CuenCont",thisform.c_ChequeTer,"Codigo")
			repl haber with thisform.text1.value
			repl debe with 0.00
		EndIf	
		******* Retenciones *******
		If thisform.totret.value # 0
		  SELECT asig_cuentas
		  GO top
		  IF aux_perlote.percepcion>0
		    select cuencont
			set order to codigo
			seek thisform.asi_brut
			if found()
				select tabla15
				set order to codigo
				seek thisform.asi_brut
				if !found()
					append blank
				endif
				repl codigo with thisform.asi_brut,detalle with cuencont.nombre
				repl haber with aux_perlote.percepcion,debe with 0.00
		    ENDIF
		  ENDIF   
		  IF aux_perlote.lotehogar>0
		    select cuencont
			set order to codigo
			seek thisform.asi_lote
			if found()
				select tabla15
				set order to codigo
				seek thisform.asi_lote
				if !found()
					append blank
				endif
				repl codigo with thisform.asi_lote,detalle with cuencont.nombre
				repl haber with aux_perlote.lotehogar,debe with 0.00
		    ENDIF
		  ENDIF 
		ENDIF 
		
		*If thisform.text8.value # 0
		*	select aux_entrega_retenciones
		*	go top
		*	scan
		*		if copiado=1
		*			select tipo_retenciones
		*			set orde to codigo
		*			seek aux_entrega_retenciones.codigo
		*			if found()
		*				select cuencont
		*				set order to codigo
		*				seek tipo_retenciones.cuenta
		*				if found()
		*					select tabla15
		*					append blank
		*					repl codigo with tipo_retenciones.cuenta,detalle with cuencont.nombre
		*					repl haber with aux_entrega_retenciones.importe,debe with 0.00
		*				EndIf	
		*			endif
		*		Endif	
		*		select aux_entrega_retenciones
		*	endscan	
		*ENDIF
		
		if thisform.text11.value#0
			select cuencont
			set order to codigo
			seek thisform.asi_caja
			if found()
				select tabla15
				set order to codigo
				seek thisform.asi_caja
				if !found()
					append blank
				endif
				repl codigo with thisform.asi_caja,detalle with cuencont.nombre
				repl haber with thisform.text11.value,debe with 0.00
			endif
		EndIf
		If thisform.txt_totalcomi.Value #0
			select cuencont
			set order to codigo
			seek thisform.comi_oc
			if found()
				select tabla15
				set order to codigo
				seek thisform.comi_oc
				if !found()
					append blank
				endif
				repl codigo with thisform.comi_oc,detalle with cuencont.nombre
				repl haber with thisform.txt_totalcomi.Value,debe with 0.00
			endif	
		EndIf
		
		*---------------   Agregar las tablas de los descuentos   -----------------
		if thisform.txtdescuentos.value#0
			select aux_dctos
			go top
			do while not eof() and val(cod_dcto)#0
				select cuencont
				set order to codigo
				seek aux_dctos.cuenta
				if found()
					select tabla15
					append blank
					repl codigo with aux_dctos.cuenta,detalle with cuencont.nombre
					repl haber with aux_dctos.importe,debe with 0.00
				endif
		
				select aux_dctos
				skip
			enddo
		endif
		
		*--------------------------------------------------------------------------
		
		select tabla15
		thisform.asiento1.text4.value=0.00
		thisform.asiento1.text5.value=0.00
		thisform.asiento1.text6.value=0.00
		go top
		scan
			thisform.asiento1.text5.value=thisform.asiento1.text5.value+debe
			thisform.asiento1.text6.value=thisform.asiento1.text6.value+haber
		endscan
		thisform.asiento1.text4.value=thisform.asiento1.text5.value-thisform.asiento1.text6.value
		select tabla15
		set order to 0
		thisform.asiento1.refresh
		
	ENDPROC

	PROCEDURE calcular_comision
	ENDPROC

	PROCEDURE conectar_sql
		public oDataTier
		Set Procedure To Datatier
		oDataTier = CreateObject( [DataTier] )
		oDataTier.AccessMethod=[SQL]
		If Empty(oDatatier.accessMethod)
			*MessageBox("No pudo Conectarse a SQL")
			_resul=1
		Else
			*MessageBox("Conectado a SQL")
			_resul=0
		
		Endif
		Set Procedure To Proced
		Return _resul
	ENDPROC

	PROCEDURE filtra_retenciones
		parameters _tip_reter
		select aux_entrega_retenciones
		=tablerevert(.t.)
		if val(_tip_reter)=0
			select retenciones
			set order to cartera
			go top
			scan
				scatter memvar
				m.registro=recno()
				select aux_entrega_retenciones
				appen blank
				gather memvar
			endscan			
		else
			select retenciones
			set order to cartera
			go top
			scan
				if retenciones.codigo=_tip_reter
					scatter memvar
					m.registro=recno()
					select aux_entrega_retenciones
					appen blank
					gather memvar
				Endif	
			endscan				
		endif	
		thisform.Ret_EnCartera1.grid1.refresh				
		
	ENDPROC

	PROCEDURE foco_cartera
		store 0.00 to thisform.text1.value
		select aux_terceros2
		go top
		scan
			if copiado=1
				thisform.text1.value=thisform.text1.value+importe
			endif	
		endscan
		thisform.text8.setfocus
	ENDPROC

	PROCEDURE foco_cheque
		thisform.text10.value=0.00
		select deposito
		go top
		scan
			thisform.text10.value=thisform.text10.value+importe
		endscan
		thisform.text1.setfocus
		thisform.total
	ENDPROC

	PROCEDURE foco_contable
		thisform.Xpbutton2.setfocus
	ENDPROC

	PROCEDURE foco_deposito
		thisform.text14.value=0.00
		select deposito2
		go top
		scan
			thisform.text14.value=thisform.text14.value+importe
		endscan
		thisform.text1.setfocus
		thisform.total
	ENDPROC

	PROCEDURE foco_descuentos
		thisform.txtdescuentos.value=0
		select aux_dctos
		go top
		scan
			thisform.txtdescuentos.value=thisform.txtdescuentos.value+importe
		endscan
		thisform.total()
		thisform.txtdescuentos.setfocus
		thisform.Refresh 
	ENDPROC

	PROCEDURE foc_ret_encartera
		store 0.00 to thisform.text8.value
		select aux_entrega_retenciones
		go top
		scan
			if copiado=1
				thisform.text8.value=thisform.text8.value+importe
			endif	
		endscan
		thisform.text11.setfocus
	ENDPROC

	PROCEDURE imprimir
		parameters _tt
		if _tt="I"
			thisform.eliminado=""
			if messagebox('Confirma imprimir orden de pago',36,'Imprimir')=7
				return
			endif
		else
			fec=Ceros(Str(day(date()),2),2)+"/"+Ceros(Str(Month(date()),2),2)+"/"+Ceros(Str(year(date()),4),4)
			thisform.eliminado="Orden de Pago Eliminada Fecha: "+fec+" Operador: "+Alltr(nom_op)
		endif
		if .t.
			thisform.cuit=verfield("proveedores",thisform.codigo1.value,"cuit")
			thisform.domi=verfield("proveedores",thisform.codigo1.value,"domicilio")
			select imp_orden
			=tablerevert(.t.)
			select aux_faccomsele
			go top
			scan
				select imp_orden
				append blank
				repl detalle with "N� Comprobante : "+aux_faccomsele.numero
				repl fecha with aux_faccomsele.fecha
				repl tipo with 1
				if inlist(left(aux_faccomsele.numero,1),"C","A")
					repl importe with aux_faccomsele.importe*-1
				else
					repl importe with aux_faccomsele.importe
				Endif	
				select aux_faccomsele
			endscan
			if thisform.text2.value#0
				select imp_orden
				append blank
				repl detalle with "ANTICIPO  "
				repl importe with thisform.text2.value
				repl tipo with 1	
			endif
			******* Retenciones *******
			IF thisform.totret.value#0
			   SELECT aux_perlote
			   GO top
			   IF aux_perlote.percepcion>0
			     select imp_orden
		         append blank
				 repl detalle with "Ingresos Brutos"
				 repl fecha with {}
				 repl tipo with 2
				 repl importe with aux_perlote.percepcion
			   ENDIF 
			   IF aux_perlote.lotehogar>0
			     select imp_orden
		         append blank
				 repl detalle with "Lote Hogar"
				 repl fecha with {}
				 repl tipo with 2
				 repl importe with aux_perlote.lotehogar
			   ENDIF 
			   IF thisform.txt_totalcomi.value>0
			     select imp_orden
		         append blank
				 repl detalle with "Comision"
				 repl fecha with {}
				 repl tipo with 2
				 repl importe with thisform.txt_totalcomi.value
			   ENDIF 	   
		    ENDIF 
		    
			*select aux_entrega_retenciones
			*go top
			*scan
			*	if copiado=1
			*		select imp_orden
			*		append blank
			*		repl detalle with aux_entrega_retenciones.nombre
			*		repl fecha with {}
			*		repl tipo with 2
			*		repl importe with aux_entrega_retenciones.importe
			*	Endif	
			*	select aux_entrega_retenciones
			*endscan		
			******* Cheques propios *******
			select deposito
			go top
			scan
				if val(deposito.codigo_ban)#0
					select imp_orden
					append blank
					repl detalle with "N� Cheque : "+deposito.Numero_com+" Banco : "+vercod("bancos",deposito.codigo_ban)
					repl fecha with deposito.fecha_venc
					repl tipo with 2
					repl importe with deposito.importe
				Endif	
				select deposito
			endscan	
			******* Transferencia Electronica *******
			select deposito2
			go top
			scan
				if val(deposito2.codigo_ban)#0
					select imp_orden
					append blank
					repl detalle with "Transf : "+deposito2.Numero_com+" Banco : "+vercod("bancos",deposito2.codigo_ban)
					repl fecha with deposito2.fecha_venc
					repl tipo with 2
					repl importe with deposito2.importe
				Endif	
				select deposito2
			endscan			
			******* Cheques de Terceros *******
			select aux_terceros2
			go top
			scan
				if copiado=1
					select imp_orden
					append blank
					repl detalle with "N� Cheque : "+aux_terceros2.comproban+" Banco : "+aux_terceros2.banco
					repl fecha with aux_terceros2.fechaven
					repl tipo with 2
					repl importe with aux_terceros2.importe
				Endif	
				select aux_terceros2
			endscan	
			******* Carga de Efectivo *******	
			if thisform.text11.value#0
				select imp_orden
				append blank
				repl detalle with "Efectivo : "
				repl importe with thisform.text11.value
				repl tipo with 2
			endif	
			******* Carga Descuentos Efectuados. *******
			select aux_dctos
			go top
			scan
				if importe<>0
					select imp_orden
					append blank
					repl detalle with "Descuento : "+aux_dctos.nom_dcto
					repl fecha with aux_dctos.fecha
					repl tipo with 2
					repl importe with aux_dctos.importe 
				Endif	
				select aux_dctos
			endscan	
			*******************************************************
			
			
			select imp_orden
			set order to tipo
			if _tt="I"
				report form orden.frx noconsole	prev	
			else	
				report form orden.frx noconsole	to print
			endif	
			
			sele aux_faccomsele
			count for Left(numero,2)='OC' to _Tiene
			if _Tiene>0
				If MessageBox("Desea Imprimir el Detalle de las Ordenes de Compras?",36,"Control")=6
					thisform.imp_detalleoc()
				endif
			endif
			
			thisform.eliminado=""
		endif	
		
	ENDPROC

	PROCEDURE imp_detalleoc
		Select aux_faccomsele
		If Reccount()>0
			Go top
			_clave='p'
			Select clave,numero,total,PER_OC from detalle_faccom where clave=_clave into cursor Datos readwrite
			Select datos
			
			Select aux_faccomsele
			Go TOP
			Scan
				If Left(numero,2)='OC'  && Si fue marcada una orden de compra, mostrar detalle.
					_clave=Numero
					Select detalle_faccom
					Set Order To clave
					Seek _Clave
					If Found()
						DO while !Eof() and clave=_Clave
							scatter memvar
							m.importe=m.total
							
							Select datos
							Append Blank
							Gather memvar
							
							Select detalle_faccom
							skip
						EndDo
					EndIf
				EndIf
			endscan	
		EndIf
			
		Select datos
		
		If Reccount()>0
			Report Form detalle_oc NOCONSOLE PREVIEW 
		Else
			MessageBox("No hay datos para mostrar",48,"Control")
		EndIf
	ENDPROC

	PROCEDURE inicio
		thisform.eliminado=""
		thisform.efec_ret=.f.
		select periodo_actual
		
		*Set Filter To idsesion=_idsesion and idnumero=_idnumero
		*brow
		go top
		if cerrado="S"
			thisform.xpButton2.visible=.f.
			thisform.xpButton3.visible=.f.
		Endif
		select asig_cuentas
		go top
		thisform.asi_caja=caja
		thisform.asi_brut=ret_brutos
		thisform.asi_lote=ret_loteho
		thisform.comi_oc=comi_oc
		thisform.c_ChequeTer=chequeter
		thisform.p=2
		thisform.regtrans=0
		thisform.comision_oc=0
		thisform.nueva=.t.
		
		thisform.financiera=.f.
		*thisform.conectar_sql()
		
		thisform.limpiar()
	ENDPROC

	PROCEDURE limpiar
		thisform.reintegros.Visible= .F.
		thisform.txtreintegro.Value=''
		
		
		thisform.nueva=.t.
		select tabla15
		=tablerevert(.t.)
		select aux_terceros2
		=tablerevert(.t.)
		thisform.asiento1.refresh
		select deposito
		=tablerevert(.t.)
		select deposito1
		=tablerevert(.t.)
		select aux_faccom
		=tablerevert(.t.)
		select aux_faccomsele
		=tablerevert(.t.)
		select aux_tipop
		=tablerevert(.t.)
		select aux_perlote
		=tablerevert(.t.)
		
		select deposito2
		=tablerevert(.t.)
		
		select orden
		set order to nroord
		go bott
		thisform.labelorden.caption=nroord
		thisform.label3.visible=.f.
		thisform.label4.visible=.f.
		thisform.ultimo=val(nroord)
		thisform.nroord1.value= ceros(str(val(nroord)+1,6),6)
		thisform.text5.value=0.00
		thisform.text2.value=0.00
		thisform.text4.value=space(50)
		thisform.codigo1.value=space(6)
		thisform.text7.value=date()
		thisform.text9.value=0.00
		thisform.text10.value=0.00
		thisform.text11.value=0.00
		thisform.text12.value=space(40)
		thisform.text1.value=0.00
		thisform.text3.value=space(3)
		thisform.text6.value=space(30)
		thisform.text8.value=0.00
		thisform.regtrans=0
		thisform.comision_oc=0
		thisform.txtcomi.Value=0
		thisform.txt_totalcomi.Value=0
		
		thisform.labeltotal.Caption = "Total a Pagar:"
		thisform.text14.Value=0.00
		thisform.totret.value=0.00
		
		thisform.reposicion.value=0
		
		thisform.nroord1.setfocus
		
		thisform.financiera=.f.
		
		
		
	ENDPROC

	PROCEDURE saldoanticipos
		parameters _prov
		select orden
		set orde to proveedor
		seek _prov
		do while not eof() and proveedor=_prov
			select orden
			skip
		EndDo
	ENDPROC

	PROCEDURE suma
		with thisform
			.totret.value=0.00
		
		select aux_perlote
		_r=recno()
		go top
		scan
			.totret.value=.totret.value+(percepcion+lotehogar)
		EndScan
		
		
		* Asi estaba antes, ahora le debo restar el total de las comisiones.
		*thisform.labeltotal.Caption = "Total a Pagar:"+Alltrim(Str(thisform.text5.Value-thisform.totret.value,10,2)) 
		thisform.labeltotal.Caption = "Total a Pagar:"+Alltrim(Str(thisform.text5.Value-thisform.totret.value - thisform.txt_totalcomi.value,10,2) )
		
		If Reccount()>0
		 go record _r
		EndIf  
			*.text11.value=.text11.value+(.totret.value)
		endwith
		
		thisform.refresh
		
		
	ENDPROC

	PROCEDURE suma2
		return 
		
		sele aux_tipop
		go top
		do while not eof()
		  lh=0
		  ib=0 
		  ne=0
		  tot=0
		  sele aux_perlote
		  go top
		  _r=recno()
		  Sum Iif(codali=aux_tipop.codigo,lotehogar,0) to lh
		  Sum Iif(codali=aux_tipop.codigo,percepcion,0) to ib
		  Sum Iif(codali=aux_tipop.codigo,neto,0) to ne
		  Sum Iif(codali=aux_tipop.codigo,lotehogar+percepcion,0) to tot
		  If Reccount()>0
		   go record _r
		  EndIf  
		  
		  if lh>0
		   replace aux_tipop.lotehogar with lh
		   replace aux_tipop.reten with ib
		   replace aux_tipop.base with ne
		   replace aux_tipop.total with tot
		  endif  
		 
		sele aux_tipop
		skip
		enddo 
		
		
		sele aux_perlote
		Go top  
		thisform.grid1.refresh 
		thisform.grid4.refresh 
	ENDPROC

	PROCEDURE suma3
		return 
		
		sele aux_tipop
		tablerevert(.t.)
		sele tipo_retencio
		set order to codigo
		go top
		do while not eof()
		   scatter memvar
		   sele aux_tipop
		   m.total=0
		   m.lotehogar=0
		   m.reten=0
		   m.base=0
		   appen blank
		   gather memvar
		sele tipo_retencio
		skip
		enddo 
		thisform.grid4.refresh
		
		
		*sele aux_tipop
		*go top
		*do while not eof()
		*  lh=0
		*  ib=0 
		*  ne=0
		*  tot=0
		*  sele aux_perlote
		*  *_r=recno()
		*  Sum Iif(codali=aux_tipop.codigo,lotehogar,0) to lh
		*  Sum Iif(codali=aux_tipop.codigo,percepcion,0) to ib
		*  Sum Iif(codali=aux_tipop.codigo,neto,0) to ne
		*  Sum Iif(codali=aux_tipop.codigo,lotehogar+percepcion,0) to tot
		*  *go record _r
		*  
		*  if lh>0
		*   replace aux_tipop.lotehogar with lh
		*   replace aux_tipop.reten with ib
		*   replace aux_tipop.base with ne
		*   replace aux_tipop.total with tot
		*  endif  
		* 
		*sele aux_tipop
		*skip
		*enddo 
		
		
		sele aux_perlote
		Go top  
		
		thisform.grid1.refresh 
		thisform.grid4.refresh 
		
		thisform.suma
		thisform.suma2
	ENDPROC

	PROCEDURE total
		thisform.text11.value=thisform.text5.value-thisform.text10.value-thisform.text1.value-thisform.text8.value-thisform.totret.value-thisform.txt_totalcomi.Value-thisform.txtdescuentos.Value - thisform.text14.value
		
		
		*if thisform.text11.value>0
		*   thisform.text11.value=thisform.text11.value-thisform.totret.value
		*endif 
		
		thisform.refresh 
	ENDPROC

	PROCEDURE ver_reintegro
		thisform.reintegros.Visible= ! thisform.reintegros.Visible 
		
		Store '' to thisform.reintegros.txtnumero.Value,thisform.reintegros.txtperiodo.Value,thisform.reintegros.txtdocumento.Value;
		,thisform.reintegros.txtnombre.value,thisform.reintegros.txtlegajo.value,thisform.reintegros.txtpagado.Value,thisform.reintegros.txtcodigo_descuento.Value
		Store 0 to thisform.reintegros.txtimporte.Value,thisform.reintegros.check_pagado.Value,thisform.reintegros.check_anulado.Value,thisform.reintegros.txtimppagado.Value
		Store {} to thisform.reintegros.txtfecha_proceso.value,thisform.reintegros.txtfecha_pagado.value
		
		thisform.check_pagar.Value=0
		thisform.text12.Value=''
		
		*---- Ver si hay conexi�n a sql
		If thisform.conectar_sql()<>0
			MessageBox("No tiene Conexi�n con de Sistema de Ordenes.",48,"Aviso")
			return
		EndIf
		
		_reintegro=thisform.txtreintegro.Value
		If Val(_reintegro)<>0
		
			
			thisform.msde1.vervista("Ver","select * from V_Excedentes where IdComprobante="+_reintegro)
			sele ver
			If Reccount()>0
				Go top
				*Browse
				thisform.reintegros.txtnumero.Value=idcomprobante  && thisform.txtreintegro.Value
				thisform.reintegros.txtperiodo.Value=a�o+'-'+mes
				thisform.reintegros.txtdocumento.Value=documento
				thisform.reintegros.txtnombre.value=nomafiliado
				thisform.reintegros.txtlegajo.value=''
				
				If Reccount()=1
					If pagado<>0 and (Val(IdRecibo)<>0 or OrdenPago<>0)  && solo considerar pagado cuando no tiene pagado=1 y tiene Nro de Recibo o de Orden de pago. // Algunos reintegros los marcan cmo pagados pero no tienen recibo por lo tnto se deben permitir pagar.
						thisform.reintegros.txtpagado.Value=Iif(Val(idrecibo)<>0,'Sistema Ordenes: Rec '+Alltrim(IdRecibo),Iif(OrdenPago<>0,'SCont: Orden '+Alltrim(Str(ordenpago)),'Sistema Ordenes'))  &&orden  && 'SO: Rec '+Alltrim(idrecibo)
						thisform.reintegros.check_pagado.Value=1
						thisform.reintegros.txtfecha_pagado.Value=fechapago
					Else
						thisform.reintegros.txtpagado.Value=Iif(Val(idrecibo)<>0,'Sistema Ordenes: Rec '+Alltrim(IdRecibo),Iif(OrdenPago<>0,'SCont: Orden '+Alltrim(Str(ordenpago)),''))  &&orden  && 'SO: Rec '+Alltrim(idrecibo)
						thisform.reintegros.check_pagado.Value=0
						thisform.reintegros.txtfecha_pagado.Value={}
					EndIf
					
					thisform.reintegros.txtcodigo_descuento.Value=codigodesc
					
					*thisform.reintegros.txtfecha_pagado.Value=fechapago
					thisform.reintegros.check_anulado.Value=anulado
					thisform.reintegros.txtfecha_proceso.value=fechaproceso	
					
					
					thisform.reintegros.txtimporte.Value=importe
				Else  && el reintegro tiene mas de un item.... No se si se puede pagar por item pero por las dudas lo contemplo.
					Go top
					thisform.reintegros.txtfecha_proceso.value=fechaproceso	  && tomo estos datos del primero
					thisform.reintegros.txtcodigo_descuento.Value=''
					thisform.reintegros.txtfecha_pagado.Value=fechapago
					
					_importe=0
					_imppagado=0
					_impimpago=0
					_anulados=0
					_nrorec=''
					Scan
						If anulado=0	
							_importe=_importe + importe
							*If pagado=0
							*	_impimpago=_impimpago + importe
							*Else
							*	_nro=Iif(Val(idrecibo)<>0,'SO: Rec '+Alltrim(IdRecibo),Iif(OrdenPago<>0,'SCont: Orden '+Alltrim(Str(ordenpago)),'SO'))  &&orden  && 'SO: Rec '+Alltrim(idrecibo)
							*	_nrorec=_nrorec + Iif(Alltrim(_nro)$_nrorec,'',_nro)
							*	_imppagado=_imppagado + importe
							*EndIf
							If pagado<>0 and (Val(IdRecibo)<>0 or OrdenPago<>0)
								_nro=Iif(Val(idrecibo)<>0,'SO: Rec '+Alltrim(IdRecibo),Iif(OrdenPago<>0,'SCont: Orden '+Alltrim(Str(ordenpago)),'SO'))  &&orden  && 'SO: Rec '+Alltrim(idrecibo)
								_nrorec=_nrorec + Iif(Alltrim(_nro)$_nrorec,'',_nro)
								_imppagado=_imppagado + importe
							Else
								_impimpago=_impimpago + importe
							EndIf
						EndIf
						_anulados=_anulados + anulado
					endscan
		
					thisform.reintegros.txtimporte.Value=_impimpago  && solo coloco el importe que resta pagar.
					
					thisform.reintegros.txtimppagado.Value=_imppagado
					
					If _imppagado=_importe  && si estan pagados todos los items marco como pagado el reintegro.
						thisform.reintegros.check_pagado.Value=1
						thisform.reintegros.txtimporte.Value=_importe  && si se pago coloco el importe del reintegro
					Else
						thisform.reintegros.check_pagado.Value=0
					EndIf
					
					If _imppagado<>0
						thisform.reintegros.txtpagado.Value=_nrorec
					endif
		
					If _anulados=Reccount()  && si todos los items est�n anulados marco todo como Anulado.
						thisform.reintegros.check_anulado.Value=1
					endif
					
					
					
					
				endif
		
			Else
				MessageBox("Reintegro No Encontrado",48,"Control")
				thisform.txtreintegro.Value=''
			endif
			
		Else
			MessageBox("Ingrese Nro de Reintegro a Buscar",48,"Control")
			thisform.txtreintegro.SetFocus 
		endif
		
		
		thisform.Refresh 
	ENDPROC

	PROCEDURE CODIGO1.GotFocus
		thisform.label100.visible=.t.
		thisform.codali=""
		thisform.ali=""
		
		for k=1 to 6 
			keyboard'{SHIFT+RIGHTARROW}'
		endfor
		this.backcolor=c_entrada
	ENDPROC

	PROCEDURE CODIGO1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		If tipo_orden.pide="C"
			if betw(nkeycode,65,90) or betw(nkeycode,97,122)
				do form busqueda with 'bancos',allt(this.value)+chr(nkeycode),"Codigo","Nombre";
				,"Tipo_Banco","=","N","Codigo","Nombre" to this.value
			EndIf	
		Else	
			if betw(nkeycode,65,90) or betw(nkeycode,97,122)
				do form busqueda with 'proveedores',allt(this.value)+chr(nkeycode),'codigo','nombre' to this.value
			endif
		EndIf	
		
	ENDPROC

	PROCEDURE CODIGO1.LostFocus
		if val(this.value)#0 
			
			thisform.financiera=.f.  && para los prov que son financieras como F&L la base imponible para retenciones no es el total, sino el total del capital (valor que se cargara manualmente)
			
			thisform.txt_totalcomi.Value=0
			thisform.txtcomi.Value=0
			select orden
			set order to nroord
			seek thisform.nroord1.value
			if !found()
				select deposito
				=tablerevert(.t.)
				select aux_faccom
				=tablerevert(.t.)
				select aux_faccomsele
				=tablerevert(.t.)
				thisform.Xpbutton1.enabled=.t.
				if tipo_orden.pide="P" &&Orden de Pago a Proveedores
					this.value=ceros(this.value,6)
					select proveedores
					set order to codigo
					seek this.value
					if found()
						thisform.codigo1.value=codigo
						thisform.text4.value=nombre 
						thisform.codali=codali
						thisform.ali=ali
						thisform.comision_oc=comi_oc
						THISFORM.CONDicion=CONDICION
						thisform.financiera=Iif(financiera=1,.t.,.f.)
					Else
						messagebox("Codigo de Proveedor Incorrecto",48,"Control")	
						thisform.text4.value=""
						this.value=""
						thisform.codali=""
						thisform.ali=""
						thisform.comision_oc=0
						THISFORM.CONdicion=CONDICION
						node
					Endif	
				Endif
				if tipo_orden.pide="N"  && Orden de Pago Directa
					If val(this.value)#0
						messagebox("En este Tipo de Orden de Pago no debe Cargar Proveedor",48,"Control")
						this.value=""
					EndIf
				Endif
				If tipo_orden.pide="C"  && Orden de Pago de Tesoreria
					this.value=ceros(this.value,3)
					select bancos
					set filter to 
					set orde to codigo
					seek this.value
					If found()
						If tipo_banco#"S"		
							thisform.text4.value=nombre 
						else
							thisform.text4.value=""
							messagebox("Este Codigo pertenece a una Cuenta Bancaria",48,"Control")	
							this.value=""
							node
						Endif	
					Else
						thisform.text4.value=""	
					EndIf
				EndIf
				If tipo_orden.resumen="S" &&Muestra Facturas Pendientes		
					sele faccom
					set order to proveedor
					seek this.value
					sup=0
					net=0
					do while not eof() and proveedor=this.value
					    net=neto
						fac=Alltr(numero)
						if left(faccom.numero,2)#"AN"
							imp=faccom.ctacte
						Else
							imp=faccom.Total
						EndIf	
						_tot_imp=total_imp
						sele pagosprov
						set order  to pronum
						seek this.value+fac
						pag=0
						do while not eof() and proveedor=this.value and numero=fac
							pag=pag+importe
							skip
						enddo
						if pag#imp
							sele aux_faccom
							appe blan
							repl numero with fac,fecha with faccom.fecha
							repl total with imp,pagado with pag,saldo with imp-pag
							repl tot_fac with faccom.total
							repl neto with net
							If thisform.financiera
								Replace total_imp with _tot_imp
							endif
							*if month(fecha)=month(date()) and year(fecha)=year(date())
						    *   sup=sup+faccom.total
							*endif 
						endif
						sele faccom
						skip
					enddo
					select aux_faccom
					if recc()=0
						thisform.label4.visible=.t.
					else
						thisform.label4.visible=.f.
						*if sup>500
						*  thisform.ret1.visible=.t.
						*  thisform.ret2.visible=.t. 
						*  thisform.efec_ret=.t.
						*else
						*  thisform.ret1.visible=.f.
						*  thisform.ret2.visible=.f. 
						*  thisform.efec_ret=.f.
						*endif 
					endif		
					thisform.grid2.refresh
				EndIf
			EndIf	
		else
			if lastkey()=13 or lastkey()=24 or lastkey()=9
				if tipo_orden.pide="P"
					messagebox("Debe Cargar Proveedor",48,"Control")
					thisform.text4.value=""
					node
				endif 			
				if tipo_orden.pide="C"
					messagebox("Debe Cargar Cueenta de Tesoreria",48,"Control")
					thisform.text4.value=""
					node
				endif 					
			EndIf	
		EndIf
		thisform.txtcomi.Value=thisform.comision_oc
		thisform.label100.visible=.f.
		this.backcolor=c_salida
		thisform.Refresh 
		
	ENDPROC

	PROCEDURE Command1.Click
		*******	Grabo CERBRU ****************
		if verfield('orden',thisform.nroord1.value,'nroord','nroord')=thisform.nroord1.value
		            thisform.numcer=""
					sele cerbru
					thisform.numcer=""
					sele cerbru
					if reccount()=0
					  num="000001"
					  thisform.numcer=num
					else
					  set order to profec2
					  *seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					  seek thisform.codigo1.value+thisform.nroord1.value
					  *proveedor+DTOC(fecha)+tipoib+no
					  *proveedor+no profec2
					  if found() 
					     num=nrocer
					     thisform.numcer=num
					  else
					     set order to
					     set order to nrocer
					     go bott
					     num=ceros(str(val(nrocer)+1,6),6)
					     thisform.numcer=num
					  endif 
					endif 
					
					sele aux_perlote
					go top
					
					thisform.edit1.value=""
					thisform.totrete=0
					thisform.brutot=0
					
					do while not eof()
					   if  total>0 and neto>0
				           sele cerbru
					       set order to profec2
					       *seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					       seek thisform.codigo1.value+thisform.nroord1.value
					       if found() 
					           num=nrocer
					       else
					          appen blank
					       endif    
					       replace nrocer with num
					       replace fecha with thisform.text7.value
					       replace proveedor with thisform.codigo1.value
					       replace nompro with allt(verfield('proveedores',thisform.codigo1.value,'nombre','codigo')) 
					       thisform.nomcer=allt(verfield('proveedores',thisform.codigo1.value,'nombre','codigo')) 
					       replace dompro with allt(verfield('proveedores',thisform.codigo1.value,'domicilio','codigo')) 
					       thisform.domcer=allt(verfield('proveedores',thisform.codigo1.value,'domicilio','codigo')) 
					       replace cuit with verfield('proveedores',thisform.codigo1.value,'cuit','codigo') 
					       thisform.cuitcer=verfield('proveedores',thisform.codigo1.value,'cuit','codigo') 
					       replace brupro with ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),10)
					       thisform.brucer=ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),10)
					       replace bruto with aux_perlote.neto
					       replace neto with aux_perlote.neto
					       replace impbru with aux_perlote.percepcion
					       replace implot with aux_perlote.lotehogar
					       replace porbru with aux_perlote.alicuota
					       replace porlot with 20.0
					       
					       replace nrobruto with left(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12),3)+"-"+;
					       righ(left (ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12) ,10) ,6)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12), 1)
					       
					       replace nrocuit with left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),2)+"-"+;
					       righ(left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),11),8)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),1)
					       
					       replace tipoib with aux_perlote.codali
					       replace no with thisform.nroord1.value
					       
					       thisform.edit1.value=thisform.edit1.value+"Ingresos Brutos: "+str(verfield('tipo_retencio',aux_perlote.codali,'alicuota','codigo'),7,2)+"%"+"   "+str(aux_perlote.percepcion,10,2)+chr(13)
					       if aux_perlote.lotehogar>0
					         thisform.edit1.value=thisform.edit1.value+"Lote Hogar:      "+str(20.0,7,2)+"%"+"   "+str(aux_perlote.lotehogar,10,2)+chr(13)
					       endif 
					       thisform.totrete=thisform.totrete+(aux_perlote.lotehogar+aux_perlote.percepcion)
		       			   thisform.brutot=thisform.brutot+aux_perlote.neto
					   endif 
					sele aux_perlote
					skip
					enddo 
					
					sele aux_perlote
					go top
					if reccount()>0 and total>0
					   if Messagebox("Desea Imprimir Certificado De Retencion",36,"Imprimir")=6
					      thisform.edit1.value=thisform.edit1.value+"--------------------------------------------"
					      thisform.edit1.value=thisform.edit1.value+"Importe Retenido :          "+str(thisform.totrete,10,2)+chr(13) 
					      sele cerbru
					      set order to 
					      set order to profec2
		 			      seek thisform.codigo1.value+thisform.nroord1.value
		 			      thisform.feccer={//}
		 		          if found()
		 		             thisform.feccer=fecha
		 			         repo form cerbru prev nocon
					      endif 
					   endif 
				   endif 
		else
		   messagebox("Debe grabar Orden de Pago antes de emitir comprobante de retenciones",48,"Control")    
		endif 			
	ENDPROC

	PROCEDURE Command2.Click
		*******	Grabo CERBRU ****************
		if verfield('orden',thisform.nroord1.value,'nroord','nroord')=thisform.nroord1.value
		            thisform.numcer=""
					sele cerbru
					if reccount()=0
					  num="000001"
					  thisform.numcer=num
					else
					  set order to profec
					  seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					  if found() 
					     num=nrocer
					     thisform.numcer=num
					  else
					     set order to
					     set order to nrocer
					     go bott
					     num=ceros(str(val(nrocer)+1,6),6)
					     thisform.numcer=num
					     *sele cerbru
					     *appen blank
					     *brow
					  endif 
					endif 
					
					sele aux_tipop
					go top
					thisform.edit1.value=""
					thisform.totrete=0
					thisform.brutot=0
					thisform.totib=0
					thisform.totlh=0
					do while not eof()
					   if  total>0 and base>0 and reten>0
				           sele cerbru
					       set order to profec
					       seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					       if found() 
					           num=nrocer
					       else
					          appen blank
					       endif    
					       replace nrocer with num
					       replace fecha with thisform.text7.value
					       replace proveedor with thisform.codigo1.value
					       replace nompro with allt(verfield('proveedores',thisform.codigo1.value,'nombre','codigo')) 
					       replace dompro with allt(verfield('proveedores',thisform.codigo1.value,'domicilio','codigo')) 
					       replace cuit with verfield('proveedores',thisform.codigo1.value,'cuit','codigo') 
					       replace brupro with ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),10)
					       replace bruto with aux_tipop.base
					       replace neto with aux_tipop.base
					       replace impbru with aux_tipop.reten
					       replace implot with aux_tipop.lotehogar
					       replace porbru with aux_tipop.alicuota
					       replace porlot with 20.0
					       
					       replace nrobruto with left(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12),3)+"-"+;
					       righ(left (ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12) ,10) ,6)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12), 1)
					       
					       replace nrocuit with left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),2)+"-"+;
					       righ(left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),11),8)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),1)
					       
					       replace tipoib with aux_tipop.codigo
					       replace no with thisform.nroord1.value
					       
					       thisform.edit1.value=thisform.edit1.value+"Ingresos Brutos: "+str(verfield('tipo_percepciones',aux_tipop.codigo,'alicuota','codigo'),7,2)+"%"+"   "+str(aux_tipop.reten,10,2)+chr(13)
					       if aux_tipop.lotehogar>0
					         thisform.edit1.value=thisform.edit1.value+"Lote Hogar:      "+str(20.0,7,2)+"%"+"   "+str(aux_tipop.lotehogar,10,2)+chr(13)
					       endif 
					       thisform.totib=thisform.totib+aux_tipop.reten
					       thisform.totlh=thisform.totlh+aux_tipop.lotehogar
					       thisform.totrete=thisform.totrete+(aux_tipop.lotehogar+aux_tipop.reten)
		       			   thisform.brutot=thisform.brutot+aux_tipop.netof     
					   endif 
					sele aux_tipop
					skip
					enddo 
					
					sele aux_tipop
					if reccount()>0
					   if Messagebox("Desea Imprimir Certificado De Retencion",36,"Imprimir")=6
					      thisform.edit1.value=thisform.edit1.value+"--------------------------------------------"
					      thisform.edit1.value=thisform.edit1.value+"Importe Retenido :          "+str(thisform.totrete,10,2)+chr(13) 
					      sele cerbru
					      set order to 
					      set order to profec2
		 			      seek thisform.codigo1.value+thisform.nroord1.value
		 		          if found()
		 			         repo form cerbru1 prev nocon
					      endif 
					   endif 
					endif 
		else
		   messagebox("Debe grabar Orden de Pago antes de emitir comprobante de retenciones",48,"Control")    
		endif 			
	ENDPROC

	PROCEDURE Command3.Click
		*messagebox(_periodosele+'--'+dtoc(_periododesde)+'--'+dtoc(_periodohasta))
		*return
		thisform.conectar_sql()
		
		thisform.msde1.vervista("Ver","select * from periodos")
		sele ver
		brow
	ENDPROC

	PROCEDURE Depositos1.Grid1.Column2.Text1.LostFocus
		RETURN
	ENDPROC

	PROCEDURE Depositos1.Grid1.Column4.Text1.LostFocus
		
		
	ENDPROC

	PROCEDURE Grid1.Column1.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if Betw(nkeycode,65,90) or Betw(nkeycode,97,122)
			do form busqueda with 'Tipo_retencio','','codigo','nombre' to this.value
		endif
	ENDPROC

	PROCEDURE Grid1.Column1.Text1.LostFocus
		If val(this.value)#0
			this.value=ceros(this.value,3)
			select tipo_retencio
			set orde to codigo
			seek this.value
			if found()
				*repl aux_perlote.NomAli with tipo_percepciones.nombre
				repl aux_perlote.alicuota with tipo_retencio.alicuota
				repl aux_perlote.percepcion with ((tipo_retencio.alicuota*aux_perlote.neto)/100)
				repl aux_perlote.lotehogar with (((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
				repl aux_perlote.total with ((tipo_retencio.alicuota*aux_perlote.neto)/100)+(((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
			else
				repl aux_perlote.alicuota with 0
		        repl aux_perlote.percepcion with 0
		        repl aux_perlote.lotehogar with 0
		        repl aux_perlote.total with 0
		   
				thisform.Grid4.Column1.text1.value=""
				thisform.Grid4.Column2.text1.value=""
				thisform.Grid4.Column4.text1.value=0
				thisform.Grid4.Column5.text1.value=0
				*thisform.Grid4.Column6.text1.value=0
				this.value=""
				messagebox("C�digo de Alicuotas Incorrecto",48,"Control")
				node
			endif
		else	
		   repl aux_perlote.alicuota with 0
		   repl aux_perlote.percepcion with 0
		   repl aux_perlote.lotehogar with 0
		   repl aux_perlote.total with 0
		   
		   thisform.Grid4.Column1.text1.value=""
		   thisform.Grid4.Column2.text1.value=""
		   thisform.Grid4.Column4.text1.value=0
		   thisform.Grid4.Column5.text1.value=0
		Endif
		
		thisform.grid1.refresh
		thisform.grid4.refresh
		
		thisform.suma()
		thisform.suma2()
	ENDPROC

	PROCEDURE Grid1.Column1.Text1.RightClick
		this.Value=thisform.codali 
		thisform.grid1.Refresh 
	ENDPROC

	PROCEDURE Grid2.Column1.Header1.Click
		select aux_faccom
		set orde to fecha
		messagebox("Ordenando por Fecha",48,"Asistente")
		thisform.refresh
	ENDPROC

	PROCEDURE Grid2.Column1.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
	ENDPROC

	PROCEDURE Grid2.Column2.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if nkeycode=13
			thisform.pag.page1.grid1.refresh
			select aux_faccom
			if copiado#1
				repl copiado with 1
				scatter memvar
				dele
				thisform.pag.page1.grid1.refresh
				select aux_faccomsele
				append blank
				gather memvar
			endif	
		endif
		
	ENDPROC

	PROCEDURE Grid2.Column3.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if nkeycode=13
			thisform.pag.page1.grid1.refresh
			select aux_faccom
			if copiado#1
				repl copiado with 1
				scatter memvar
				dele
				thisform.pag.page1.grid1.refresh
				select aux_faccomsele
				append blank
				gather memvar
			endif	
		endif
		
	ENDPROC

	PROCEDURE Grid2.Column4.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if nkeycode=13
			thisform.pag.page1.grid1.refresh
			select aux_faccom
			if copiado#1
				repl copiado with 1
				scatter memvar
				dele
				thisform.pag.page1.grid1.refresh
				select aux_faccomsele
				append blank
				gather memvar
			endif	
		endif
		
	ENDPROC

	PROCEDURE Grid2.Column5.Text1.GotFocus
		thisform.label3.visible=.t.
	ENDPROC

	PROCEDURE Grid2.Column5.Text1.InteractiveChange
		if inkey()=13
			thisform.grid3.refresh
			thisform.grid2.refresh
		endif
		
	ENDPROC

	PROCEDURE Grid2.Column5.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if nkeycode=13
			&& pasar ***
			select aux_faccom
			
			If thisform.financiera  && Si es financiera me fijo si tiene cargado un total imponible.
				If total_imp<>0
					_saldo=total_imp
				Else
					if left(numero,2)='OC'
						_saldo=total_imp
					else
						_saldo=saldo				
					endif
				EndIf
			else
				_saldo=saldo
			EndIf
			
			if copiado=0
			    && Coloca
				repl copiado with 1
				scatter memvar
				m.importe=thisform.grid2.column5.text1.value  && m.saldo
				
				if inlist(left(m.numero,1),"C","A")
					thisform.text5.value=thisform.text5.value-m.importe
				Else
					thisform.text5.value=thisform.text5.value+m.importe
				Endif
				
				thisform.grid4.column1.readonly=.t.
		        thisform.grid4.column7.readonly=.t.
		        thisform.grid4.column2.readonly=.t.
		        thisform.grid4.column3.readonly=.t.
		        thisform.grid4.column4.readonly=.t.
		        thisform.grid4.column5.readonly=.t.
		        thisform.grid4.refresh 
				**************************************************************
				*if thisform.efec_ret=.t.
				if thisform.text5.Value>1500    &&.t.
			           sele aux_perlote
					   if reccount()=0
						   appen blank
						   percepcion=0
						   lotehogar=0
						   total=0
						   codali=""
						   alicuota=0
						   if inlist(left(aux_faccom.numero,1),"C","A")
						   		if inlist(subst(aux_faccom.numero,2,1),"B","A")
								     neto=-1*(_saldo/1.21)
								Else
								     neto=-1*_saldo
								endif     
						   Else
						   		if inlist(subst(aux_faccom.numero,2,1),"B","A")
								    neto=(_saldo/1.21)
								Else
								    *neto=aux_faccom.saldo && Quitar porque deja como base el valor de la 1� orden q supera los 500.
								    *neto=0
								    If Alltrim(THISFORM.CONdicion)='Resp.Inscripto'
								    	neto=(_saldo/1.21)
								    Else
								    	If Alltrim(THISFORM.CONdicion)<>'Exento'
									        neto=_saldo
									    Else
									    	neto=0
									    endif
								    endif
								EndIf    
						   endif   
		     			   gather memvar
			          else
			              go top
			              if inlist(left(aux_faccom.numero,1),"C","A")
			              	  if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
							      replace neto with neto+(-1*_saldo)
							  Endif    
						  Else
						     if inlist(subst(aux_faccom.numero,2,1),"B","A")		
							     replace neto with neto+(_saldo/1.21)
							 Else  && Nuevo, antes no hacia nada.
							 	   If Alltrim(THISFORM.CONdicion)='Resp.Inscripto'
								    	replace neto with neto+(_saldo/1.21)
								    Else
								    	If Alltrim(THISFORM.CONdicion)<>'Exento'
									        replace neto with neto+(_saldo) 
									    endif
										
								    endif
							 Endif    
						  endif   
					  endif 	   
							
					  thisform.grid1.refresh
					  sele aux_perlote
					  If val(codali)#0
						select tipo_retencio
						set orde to codigo
						seek aux_perlote.codali
						if found()
							*repl aux_perlote.NomAli with tipo_percepciones.nombre
							repl aux_perlote.alicuota with tipo_retencio.alicuota
							repl aux_perlote.percepcion with ((tipo_retencio.alicuota*aux_perlote.neto)/100)
							repl aux_perlote.lotehogar with (((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
							repl aux_perlote.total with ((tipo_retencio.alicuota*aux_perlote.neto)/100)+(((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
					    endif 
					    
					  endif   		
		
		         	  thisform.grid4.refresh
			     	  thisform.grid1.refresh
			     	  
			     	  thisform.suma()
			     	  
			     	  thisform.grid1.column1.text1.setfocus
			     	  thisform.grid2.column5.text1.setfocus
			    else
					thisform.grid4.column1.readonly=.t.
					thisform.grid4.column7.readonly=.t.
					thisform.grid4.column2.readonly=.t.
					thisform.grid4.column3.readonly=.t.
					thisform.grid4.column4.readonly=.t.
		            thisform.grid4.column5.readonly=.t.
					thisform.grid4.refresh 
					sele aux_perlote
					TABLEREVERT(.t.)
					thisform.grid1.Refresh 
		    	endif 
		     	******************************************************************
		
					
				select aux_faccomsele
				append blank 
				gather memvar
				go top
			else
				repl copiado with 0
				select aux_faccomsele
				set order to numero
				seek aux_faccom.numero  
				if found()
					If inlist(left(aux_faccom.numero,1),"C","A")
						thisform.text5.value=thisform.text5.value+aux_faccomsele.importe
					Else
						thisform.text5.value=thisform.text5.value-aux_faccomsele.importe
					EndIf	
					tablerevert(.f.)
				endif
				thisform.grid4.refresh 
			    ******************************************************************
			    *if thisform.efec_ret=.t.
			    if thisform.text5.value>1500
			          sele aux_perlote
					  if reccount()=0
						   appen blank
						   percepcion=0
						   lotehogar=0
						   total=0
						   codali=""
						   alicuota=0
						   if inlist(left(aux_faccom.numero,1),"C","A")
						   		if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
						   			neto=-1*_saldo/1.21
						   		Else	
								     neto=-1*_saldo
								EndIf     
						   Else
							   if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
							   		neto=_saldo/1.21
							   Else
								    *neto=aux_faccom.saldo
		   					 	    If Alltrim(THISFORM.CONdicion)='Resp.Inscripto'  && Nuevo, antes hacia la linea anterior.
								    	replace neto with neto+(_saldo/1.21)
								    Else
								    	If Alltrim(THISFORM.CONdicion)<>'Exento'
									    	replace neto with neto+(_saldo)
									    Else
									    	neto=_saldo
									    endif
								    endif
							   EndIf	    
						   endif   
		     			   gather memvar
			          else
			              go top
			              if inlist(left(aux_faccom.numero,1),"C","A")
			              		if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
								     replace neto with neto-(-1*_saldo/1.21)
								Else
								     replace neto with neto-(-1*_saldo)
								EndIf     
						  Else
						  		if inlist(subst(aux_faccom.numero,2,1),"B","A") 
								    replace neto with neto-(_saldo/1.21)
								Else
									*replace neto with neto-(_saldo)  && Quitar para que no reste y quede en negativo la base.   
									If Alltrim(THISFORM.CONdicion)='Resp.Inscripto'  && Nuevo, antes no hacia nada.
								    	replace neto with neto-(_saldo/1.21)
								    Else
									    If Alltrim(THISFORM.CONdicion)<>'Exento'
											replace neto with neto-(_saldo)
										endif
								    endif
								Endif     
						  endif   
					  endif 	   
							
					thisform.grid1.refresh
					sele aux_perlote
					  If val(codali)#0
						select tipo_retencio
						set orde to codigo
						seek aux_perlote.codali
						if found()
							*repl aux_perlote.NomAli with tipo_percepciones.nombre
							repl aux_perlote.alicuota with tipo_retencio.alicuota
							repl aux_perlote.percepcion with ((tipo_retencio.alicuota*aux_perlote.neto)/100)
							repl aux_perlote.lotehogar with (((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
							repl aux_perlote.total with ((tipo_retencio.alicuota*aux_perlote.neto)/100)+(((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
					    endif 
					  endif   	
					thisform.suma()  
					thisform.suma3()
				    
			     	thisform.grid4.refresh
			        set order to 
			     	thisform.grid1.refresh
			    else
		   			thisform.grid4.column1.readonly=.t.
					thisform.grid4.column7.readonly=.t.
					thisform.grid4.column2.readonly=.t.
					thisform.grid4.column3.readonly=.t.
					thisform.grid4.column4.readonly=.t.
		            thisform.grid4.column5.readonly=.t.
					thisform.grid4.refresh 
		        	sele aux_perlote
					TABLEREVERT(.t.)
					thisform.grid1.Refresh 
		     	endif 
		     	**********************************************************
		     	*MessageBox("zzz")
		   	endif		
			thisform.grid2.SetAll("dynamicbackcolor","IIF(copiado=1,RGB(255,223,191),RGB(255,255,255))","Column")
			thisform.grid3.refresh
			select aux_faccom
			reg=recno()
			go record reg
			if abs(recno())=recc()
				go top
			else
				skip	
			endif
			thisform.grid2.refresh
			thisform.grid2.activatecell(abs(recno()),5)
			thisform.grid2.column5.text1.setfocus
		endif	
		if nkeycode=9
			thisform.label3.visible=.f.
			thisform.text2.setfocus
		endif
		if nkeyCode=-2
			thisform.text9.Setfocus
		endif
		
	ENDPROC

	PROCEDURE Grid2.Deleted
		LPARAMETERS nRecNo
		
	ENDPROC

	PROCEDURE Grid3.Column1.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
	ENDPROC

	PROCEDURE Grid4.Column1.Text1.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
	ENDPROC

	PROCEDURE Grid4.Column2.Text1.LostFocus
		thisform.totret.value=0.00
		if thisform.efec_ret=.t.
		sele aux_tipop
		sum total to thisform.totret.value
		endif 
		
		thisform.refresh 
		
	ENDPROC

	PROCEDURE Grid4.Column3.Text1.LostFocus
		thisform.totret.value=0.00
		if thisform.efec_ret=.t.
		 sele aux_tipop
		 sum total to thisform.totret.value
		endif 
		
		thisform.refresh 
		
	ENDPROC

	PROCEDURE NROORD1.GotFocus
		for k=1 to 6 
			keyboard'{SHIFT+RIGHTARROW}'
		endfor
		this.backcolor=c_entrada
		
		thisform.xpbutton4.visible=.f.
		thisform.grid4.column1.readonly=.t.
		thisform.grid4.column2.readonly=.t.
		thisform.grid4.column3.readonly=.t.
		thisform.grid4.column4.readonly=.t.
		thisform.grid4.column5.readonly=.t.
		thisform.grid4.column7.readonly=.t.
		thisform.grid4.refresh 
		
		thisform.edit1.value=""
		thisform.numord=0
		
		thisform.reintegros.Visible= .F.
		thisform.txtreintegro.Value=''
		
		thisform.Refresh 
	ENDPROC

	PROCEDURE NROORD1.LostFocus
		if val(this.value)#0
			this.value=ceros(this.value,6)
			
			thisform.reposicion.readonly=.f.
			thisform.nueva=.t.
			select aux_tipop
		    =tablerevert(.t.)
		    select aux_perlote
		    =tablerevert(.t.)
		    select aux_perlotee
		    =tablerevert(.t.)
		    
			select tabla15
			=tablerevert(.t.)	
			select aux_faccomsele
			=tablerevert(.t.)
			select deposito
			=tablerevert(.t.)
			select deposito1
			=tablerevert(.t.)
			select deposito2
			=tablerevert(.t.)	
			select aux_faccom
			=tablerevert(.t.)
			select aux_terceros2
			=tablerevert(.t.)
			select aux_entrega_retenciones
			=tablerevert(.t.)
			SELECT aux_dctos
			=tablerevert(.t.)
			thisform.xpbutton4.visible=.f.
			if val(this.value)<=thisform.ultimo+1
				select orden
				set order to nroord
				seek this.value
				if found()
					thisform.nueva=.f.
				    thisform.numord=this.value
					Thisform.Xpbutton5.Visible=.f.
					Thisform.Asiento1.NroModelo1.Visible=.f.
					Thisform.Asiento1.LblModelo1.Visible=.f.
					thisform.Xpbutton2.enabled=.f.
					thisform.text7.value=fecha
					thisform.codigo1.value=proveedor
					thisform.text5.value=importe
					thisform.text10.value=cheque
					thisform.text14.value=transfe
					thisform.text1.value=cheque3
					thisform.text11.value=efectivo
					thisform.text8.value=retencion
					thisform.totret.value=otras_rete
					thisform.text12.value=leyenda
					thisform.text4.value=detalle
					thisform.text3.value=tipo
					thisform.text6.value=NomTipo
					thisform.text2.value=Adelanto
					thisform.txtcomi.Value=comi_oc
					thisform.txt_totalcomi.value=tot_comioc
					thisform.grid1.column1.ReadOnly=.t.
					thisform.xpbutton4.visible=.t.
					thisform.reposicion.readonly=.t.  && Si la orden se genero como reposicon no permitr cambiar esta opcion.
					thisform.reposicion.value=reposicion 
					thisform.txtreintegro.Value=Alltrim(Str(reintegro))
					
					thisform.grid1.Refresh 
					thisform.asiento(this.value,'mostrar')&&muestro los asientos
					
					
					if !empty(thisform.codigo1.value)
						select tipo_orden
						set orde to codigo
						seek thisform.text3.value
						if found()
							If pide="C" && Cuentas de Tesoreria
								thisform.codigo1.inputMask="!!!"
								select bancos
								set orde to codigo
								seek alltr(orden.proveedor)
								thisform.text4.value=bancos.nombre
							Else        && Proveedores
								thisform.codigo1.inputMask="!!!!!!"
								select proveedores
								set order to codigo
								seek orden.proveedor
								thisform.text4.value=proveedores.nombre 						
							EndIf
						EndIf	
					endif	
					select pagosprov
					set order to nroord
					seek thisform.nroord1.value
					do while not eof() and nroord=thisform.nroord1.value
						scatter memvar
						select aux_faccomsele
						append blank
						gather memvar
						select pagosprov
						skip
					enddo
					select aux_faccomsele
					go top
					*//Carga el detalle de los depositos//*
					select movimientos_bancos
					set order to pagprov
					seek this.value
					if found()
						do while not eof() and pagprov=this.value
							if tipo_banco="S"
								m.registro=recno()
								scatter memvar
								m.codigo_ban=m.codigo_banco
								m.numero_com=m.numero_comprobante
								m.fecha_emis=m.fecha_emision
								m.fecha_venc=m.fecha_vencimiento
								If tipo_movimiento='001'
									select deposito		&& Cheques 001.
								Else .
									select deposito2    && Transferencias 006.
								endif
								append blank
								gather memvar
							endif	
							select movimientos_bancos
							skip
						enddo
					endif
					thisform.cheque1.grid1.refresh
					thisform.depositos1.grid1.Refresh 
					******* Cargo Cheques de Terceros *******
					select chequeter
					set order to ord_pag
					seek this.value
					do while not eof() and ord_pag=this.value
						scatter memvar
						m.copiado=1
						m.regi=recno()
						select aux_terceros2
						appen blank
						gather memvar
						select chequeter
						skip
					enddo
					thisform.cartera1.grid1.refresh
					thisform.Cartera1.grid1.SetAll("dynamicbackcolor","IIF(copiado=1,RGB(255,223,191),RGB(255,255,255))","Column")	
					******* Carga detalle de retenciones *******
		            sele tipo_reten
		            set order to nroord
		            seek this.value
		            thisform.totret.value=0.00
		            do while not eof() and nroord=this.value
		               scatter memvar
		               m.percepcion=tipo_reten.reten 
		               m.neto=tipo_reten.base
		               m.codali=tipo_reten.codigo
		               thisform.totret.value=thisform.totret.value+total
		               *m.registro1=recno()
		               sele aux_perlote
		               appen blank
		               gather memvar
		            sele tipo_reten
		            skip
		            enddo   
		          	thisform.grid1.column1.ReadOnly=.t.
		            thisform.grid1.refresh 	
		            		
					******* Cargo Retenciones en Cartera *******
					select retenciones
					set order to ord_pag
					seek this.value
					do while not eof() and ord_pag=this.value
						scatter memvar
						m.copiado=1
						m.regi=recno()
						select aux_entrega_retenciones
						appen blank
						gather memvar
						select retenciones
						skip
					EndDo
					
					***------- recupero los descuentos que tuvo    (marce junio 2012)
					SELECT aux_dctos
		
					thisform.txtdescuentos.Value=0.00
					
					SELECT descuentos_proveedores
					SET ORDER TO ORDPROV   && NROORD+PROVEEDOR+COD_DCTO
					SEEK 	thisform.nroORD1.value + thisform.codIGO1.Value	
					DO WHILE NOT EOF() AND nroord=thisform.nroORD1.value AND proveedor=thisform.codIGO1.Value
						SCATTER memvar	
						m.nom_dcto=vercod("tipo_descuentos",m.cod_dcto)
						m.nomcuenta=vercod("cuencont",m.cuenta)
						
						SELECT aux_dctos
		*				m.nroasiento ???
						APPEND BLANK
						GATHER memvar
		
						thisform.txtdescuentos.Value=thisform.txtdescuentos.Value + importe
			
						
						SELECT descuentos_proveedores
						SKIP
					enddo
					
					***-------------------------------------------------------------
					
					
					thisform.Ret_EnCartera1.labelfiltro.visible=.f.
					thisform.Ret_EnCartera1.text1.visible=.f.
					thisform.Ret_EnCartera1.grid1.refresh			
					thisform.Ret_EnCartera1.grid1.refresh	
					thisform.Ret_EnCartera1.grid1.SetAll("dynamicbackcolor","IIF(copiado=1,RGB(255,223,191),RGB(255,255,255))","Column")						
				else
					If !thisform.nueva
						Set Deleted off
						Seek thisform.nroord1.value
						If Found()
							If Deleted()
								MessageBox('Orden de Pago ANULADA!!!'+Chr(13)+;
										   'Operador: '+Cod_op+' - '+nom_op+Chr(13)+;
										   'El '+Left(Ttoc(fe),10)+' a las '+Right(Ttoc(fe),8),64,'Aviso')
							EndIf
						Else
							MessageBox('N� Orden Inexistente',48,'Aviso')
						EndIf
						Set Deleted on
					EndIf 
					thisform.asiento1.nro.caption=""
					thisform.Xpbutton2.enabled=.t.
					Thisform.Xpbutton5.Visible=.t.
					Thisform.Asiento1.NroModelo1.Visible=.t.
					Thisform.Asiento1.LblModelo1.Visible=.t.			
					thisform.text4.value=space(50)
					thisform.text5.value=0.00
					thisform.text7.value=date()
					thisform.text8.value=0.00
					thisform.totret.value=0.00
					thisform.text10.value=0.00
					thisform.text11.value=0.00
					thisform.txtdescuentos.Value=0.00
					thisform.codigo1.value=space(6)
					thisform.text12.value=space(40)
					thisform.text3.value=space(3)
					thisform.text6.value=""
					thisform.asiento('','')
					*--------------------------------------------------------
					thisform.comision_oc=0
					thisform.txtcomi.Value=0
					thisform.txt_totalcomi.Value=0
		
					thisform.labeltotal.Caption = "Total a Pagar:"
					*--------------------------------------------------------
					thisform.grid1.column1.ReadOnly=.f.
		    		thisform.grid1.Refresh 
					select aux_faccomsele
					=tablerevert(.t.)
					select aux_faccom
					=tablerevert(.t.)		
					******* Cargo Cheques en Cartera *******
					select chequeter
					set order to cartera
					go top
					scan
						scatter memvar
						m.regi=recno()
						select aux_terceros2
						appen blank
						gather memvar
					endscan			
					thisform.cartera1.grid1.refresh			
					******* Cargo Retenciones en Cartera *******
					select retenciones
					set order to cartera
					go top
					scan
						scatter memvar
						m.registro=recno()
						select aux_entrega_retenciones
						appen blank
						gather memvar
					endscan			
					thisform.Ret_EnCartera1.labelfiltro.visible=.t.
					thisform.Ret_EnCartera1.text1.visible=.t.
					thisform.Ret_EnCartera1.grid1.refresh		
					******Cargo Tipos de Percepciones ************
					sele tipo_retencio
					set order to codigo
					go top
					do while not eof()
					   scatter memvar
					   sele aux_tipop
					   m.total=0
					   appen blank
					   gather memvar
					sele tipo_retencio
					skip
					enddo 
					thisform.grid4.refresh
				endif	
				select tabla15
				if recc()=0
					append blank
					thisform.asiento1.grid1.refresh
				endif	
			else
				=messagebox('No se puede perder la correlatividad de las ordenes de pago.'+chr(13)+'El pr�ximo a cargar es el N�: '+ceros(str(thisform.ultimo+1,6),6),48,'Control')	
				this.value=ceros(str(thisform.ultimo+1,6),6)
				node
			endif	
			thisform.grid3.refresh
			thisform.grid2.refresh
		EndIf
		
		this.backcolor=c_salida
	ENDPROC

	PROCEDURE reintegros.Xpbutton1.Click
		thisform.check_pagar.Value=0
		If not thisform.nueva
			MessageBox("Para realizar el Pago ingrese en una Orden de Pago Nueva",48,"Control")
			return
		endif
		
		
		If thisform.reintegros.check_pagado.Value=1
			MessageBox("El Reintegro ya se encuentra Pagado",48,"Control")
			return
		endif
		
		If thisform.reintegros.check_anulado.Value=1
			MessageBox("El Reintegro se encuentra Anulado",48,"Control")
			return
		endif
		
		*-- Paso datos al Formulario para realizar el pago. ------------------------------------------------------------------
		thisform.text12.Value=Alltrim(thisform.reintegros.txtnombre.Value)+' - REINTEGRO N�: '+Alltrim(THISFORM.REIntegros.TXTNUmero.Value)
		THISFORM.TEXT5.Value=thisform.reintegros.txtimporte.Value
		thisform.check_pagar.Value=1
		*---------------------------------------------------------------------------------------------------------------
		
		
		thisform.reintegros.Visible= .F.
		
		
		
		
		thisform.Refresh 
	ENDPROC

	PROCEDURE reintegros.Xpbutton3.Click
		thisform.reintegros.Visible= .F.
		thisform.Refresh 
	ENDPROC

	PROCEDURE Text1.LostFocus
		thisform.total()
	ENDPROC

	PROCEDURE Text10.LostFocus
		thisform.total()
	ENDPROC

	PROCEDURE Text11.GotFocus
		thisform.total()
		
	ENDPROC

	PROCEDURE Text12.GotFocus
		this.backcolor=c_entrada
	ENDPROC

	PROCEDURE Text12.LostFocus
		this.backcolor=c_salida
		If tipo_orden.resumen="N"
			thisform.text5.SetFocus
			thisform.txtreintegro.SetFocus 
		EndIf
	ENDPROC

	PROCEDURE Text13.GotFocus
		for k=1 to 10
			keyboard'{SHIFT+RIGHTARROW}'
		endfor
	ENDPROC

	PROCEDURE Text13.LostFocus
		if this.value#0
			select aux_faccom
			locate for saldo=this.value
			if Found()
				thisform.Grid2.Column5.Text1.Setfocus
			else
				messagebox("Importe No Encontrado",48,"Control")
				node
			endif
			this.value=0.00
		Endif
	ENDPROC

	PROCEDURE Text14.LostFocus
		thisform.total()
	ENDPROC

	PROCEDURE Text2.GotFocus
		this.backcolor=c_entrada
	ENDPROC

	PROCEDURE Text2.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
	ENDPROC

	PROCEDURE Text2.LostFocus
		thisform.text5.value=0.00
		select aux_faccomsele
		go top
		scan
			if inlist(left(aux_faccomsele.numero,1),"C","A")
				thisform.text5.value=thisform.text5.value-aux_faccomsele.importe
			Else
				thisform.text5.value=thisform.text5.value+aux_faccomsele.importe
			Endif	
		endscan
		thisform.text5.value=thisform.text5.value+this.value
		thisform.total()
		this.backcolor=c_salida
	ENDPROC

	PROCEDURE Text3.GotFocus
		thisform.label100.visible=.t.
		for k=1 to 3
			keyboard'{SHIFT+RIGHTARROW}'
		endfor
		this.backcolor=c_entrada
	ENDPROC

	PROCEDURE Text3.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		if betw(nkeycode,65,90) or betw(nkeycode,97,122)
			do form busqueda with 'Tipo_orden','','codigo','nombre' to this.value
		endif
	ENDPROC

	PROCEDURE Text3.LostFocus
		If val(this.value)#0
			select tipo_orden
			this.value=ceros(this.value,3)	
			set orde to codigo
			seek this.value
			if found()
				thisform.text6.value=tipo_orden.nombre
				If pide="C" && Cuentas de Tesoreria
					thisform.codigo1.inputMask="!!!"
				Else        && Proveedores
					thisform.codigo1.inputMask="!!!!!!"
				EndIf
			Else
				thisform.text6.value=""
				messagebox("Tipo de Orden de Pago Incorrecta",48,"Control")
				this.value=space(3)
				node
			Endif
		else
			if lastkey()=13 or lastkey()=24 or lastkey()=9
				messagebox("Debe Cargar Tipo de Orden de Pago",48,"Control")
				node
			Endif	
		EndIf
		thisform.label100.visible=.f.
		this.backcolor=c_salida
	ENDPROC

	PROCEDURE Text4.LostFocus
		if empty(this.value)
			messagebox("Debe Cargar a nombre de quien es el pago",48,"Control")
			node
		endif
	ENDPROC

	PROCEDURE Text5.GotFocus
		this.backcolor=c_entrada
	ENDPROC

	PROCEDURE Text5.KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
	ENDPROC

	PROCEDURE Text5.LostFocus
		thisform.total()
		thisform.text10.setfocus
		this.backcolor=c_salida
	ENDPROC

	PROCEDURE Text6.LostFocus
		if !empty(thisform.codigo1.value)
			thisform.grid2.column1.text1.setfocus	
		endif
	ENDPROC

	PROCEDURE Text7.GotFocus
		this.backcolor=c_entrada
	ENDPROC

	PROCEDURE Text7.LostFocus
		this.backcolor=c_salida
		sele periodo_actual
		*brow
		_desde=_periododesde   &&periodo_actual.desde
		_hasta=_periodohasta  &&periodo_actual.hasta
		
		if !Betw(this.value,_desde,_hasta)
			messagebox("Esta Cargando una Fecha fuera del Ejercicio Contable Seleccionado",48,"Control")
			this.value=date()
		endif
		
	ENDPROC

	PROCEDURE Text8.LostFocus
		thisform.total()
	ENDPROC

	PROCEDURE Text9.GotFocus
		for k=1 to 10
			keyboard'{SHIFT+RIGHTARROW}'
		endfor
	ENDPROC

	PROCEDURE Text9.LostFocus
		if this.value#0
			select aux_faccom
			locate for saldo=this.value
			if Found()
				thisform.Grid2.Column5.Text1.Setfocus
			else
				messagebox("Importe No Encontrado",48,"Control")
				node
			endif
			this.value=0.00
		Endif
	ENDPROC

	PROCEDURE totret.LostFocus
		*thisform.suma()
	ENDPROC

	PROCEDURE txtreintegro.LostFocus
		If Val(this.value)>0
			thisform.ver_reintegro()
		Else
			thisform.check_pagar.Value=0
		EndIf
		
	ENDPROC

	PROCEDURE Xpbutton1.Click
		select aux_terceros2
		=tablerevert(.t.)
		select deposito1
		=tablerevert(.t.)
		select tabla15
		=tablerevert(.t.)
		select aux_faccomsele
		=tablerevert(.t.)
		select aux_faccom
		=tablerevert(.t.)
		select aux_entrega_retenciones
		=tablerevert(.t.)
		select chequeras
		=tablerevert(.t.)
		
		select aux_tipop
		=tablerevert(.t.)
		select aux_perlote
		=tablerevert(.t.)
		select aux_perlotee
		=tablerevert(.t.)
		
		thisform.release
		
	ENDPROC

	PROCEDURE Xpbutton10.Click
		
			&& pasar ***
			select aux_faccom
			Replace all copiado with 1
			thisform.grid2.column5.text1.KeyPress(13)
			return
			scan
			if copiado=0
			    && Coloca
				repl copiado with 1
				scatter memvar
				m.importe=thisform.grid2.column5.text1.value&&m.saldo
				if inlist(left(m.numero,1),"C","A")
					thisform.text5.value=thisform.text5.value-m.importe
				Else
					thisform.text5.value=thisform.text5.value+m.importe
				Endif
				
				thisform.grid4.column1.readonly=.t.
		        thisform.grid4.column7.readonly=.t.
		        thisform.grid4.column2.readonly=.t.
		        thisform.grid4.column3.readonly=.t.
		        thisform.grid4.column4.readonly=.t.
		        thisform.grid4.column5.readonly=.t.
		        thisform.grid4.refresh 
				**************************************************************
		
				if thisform.text5.Value>1500    &&.t.
			           sele aux_perlote
					   if reccount()=0
						   appen blank
						   percepcion=0
						   lotehogar=0
						   total=0
						   codali=""
						   alicuota=0
						   if inlist(left(aux_faccom.numero,1),"C","A")
						   		if inlist(subst(aux_faccom.numero,2,1),"B","A")
								     neto=-1*(aux_faccom.saldo/1.21)
								Else
								     neto=-1*aux_faccom.saldo
								endif     
						   Else
						   		if inlist(subst(aux_faccom.numero,2,1),"B","A")
								    neto=(aux_faccom.saldo/1.21)
								Else
								    neto=aux_faccom.saldo
								EndIf    
						   endif   
		     			   gather memvar
			          else
			              go top
			              if inlist(left(aux_faccom.numero,1),"C","A")
			              	  if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
							      replace neto with neto+(-1*aux_faccom.saldo)
							  Endif    
						  Else
						     if inlist(subst(aux_faccom.numero,2,1),"B","A")		
							     replace neto with neto+(aux_faccom.saldo/1.21)
							 Endif    
						  endif   
					  endif 	   
							
					  thisform.grid1.refresh
					  sele aux_perlote
					  If val(codali)#0
						select tipo_retencio
						set orde to codigo
						seek aux_perlote.codali
						if found()
							*repl aux_perlote.NomAli with tipo_percepciones.nombre
							repl aux_perlote.alicuota with tipo_retencio.alicuota
							repl aux_perlote.percepcion with ((tipo_retencio.alicuota*aux_perlote.neto)/100)
							repl aux_perlote.lotehogar with (((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
							repl aux_perlote.total with ((tipo_retencio.alicuota*aux_perlote.neto)/100)+(((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
					    endif 
					  endif   		
		
		         	  thisform.grid4.refresh
			     	  thisform.grid1.refresh
			     	  
			     	  thisform.suma()
			     	  
			     	  thisform.grid1.column1.text1.setfocus
			     	  thisform.grid2.column5.text1.setfocus
			    else
					thisform.grid4.column1.readonly=.t.
					thisform.grid4.column7.readonly=.t.
					thisform.grid4.column2.readonly=.t.
					thisform.grid4.column3.readonly=.t.
					thisform.grid4.column4.readonly=.t.
		            thisform.grid4.column5.readonly=.t.
					thisform.grid4.refresh 
					sele aux_perlote
					TABLEREVERT(.t.)
					thisform.grid1.Refresh 
		    	endif 
		     	******************************************************************
		
					
				select aux_faccomsele
				append blank 
				gather memvar
				go top
			else
				repl copiado with 0
				select aux_faccomsele
				set order to numero
				seek aux_faccom.numero  
				if found()
					If inlist(left(aux_faccom.numero,1),"C","A")
						thisform.text5.value=thisform.text5.value+aux_faccomsele.importe
					Else
						thisform.text5.value=thisform.text5.value-aux_faccomsele.importe
					EndIf	
					tablerevert(.f.)
				endif
				thisform.grid4.refresh 
			    ******************************************************************
			    *if thisform.efec_ret=.t.
			    if thisform.text5.value>1500
			          sele aux_perlote
					  if reccount()=0
						   appen blank
						   percepcion=0
						   lotehogar=0
						   total=0
						   codali=""
						   alicuota=0
						   if inlist(left(aux_faccom.numero,1),"C","A")
						   		if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
						   			neto=-1*aux_faccom.saldo/1.21
						   		Else	
								     neto=-1*aux_faccom.saldo
								EndIf     
						   Else
							   if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
							   		neto=aux_faccom.saldo/1.21
							   Else
								    neto=aux_faccom.saldo
							   EndIf	    
						   endif   
		     			   gather memvar
			          else
			              go top
			              if inlist(left(aux_faccom.numero,1),"C","A")
			              		if inlist(subst(aux_faccom.numero,2,1),"B","A") 	
								     replace neto with neto-(-1*aux_faccom.saldo/1.21)
								Else
								     replace neto with neto-(-1*aux_faccom.saldo)
								EndIf     
						  Else
						  		if inlist(subst(aux_faccom.numero,2,1),"B","A") 
								    replace neto with neto-(aux_faccom.saldo/1.21)
								Else
									replace neto with neto-(aux_faccom.saldo)     
								Endif     
						  endif   
					  endif 	   
							
					thisform.grid1.refresh
					sele aux_perlote
					  If val(codali)#0
						select tipo_retencio
						set orde to codigo
						seek aux_perlote.codali
						if found()
							*repl aux_perlote.NomAli with tipo_percepciones.nombre
							repl aux_perlote.alicuota with tipo_retencio.alicuota
							repl aux_perlote.percepcion with ((tipo_retencio.alicuota*aux_perlote.neto)/100)
							repl aux_perlote.lotehogar with (((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
							repl aux_perlote.total with ((tipo_retencio.alicuota*aux_perlote.neto)/100)+(((tipo_retencio.alicuota*aux_perlote.neto)/100)*0.2)
					    endif 
					  endif   	
					thisform.suma()  
					thisform.suma3()
				    
			     	thisform.grid4.refresh
			        set order to 
			     	thisform.grid1.refresh
			    else
		   			thisform.grid4.column1.readonly=.t.
					thisform.grid4.column7.readonly=.t.
					thisform.grid4.column2.readonly=.t.
					thisform.grid4.column3.readonly=.t.
					thisform.grid4.column4.readonly=.t.
		            thisform.grid4.column5.readonly=.t.
					thisform.grid4.refresh 
		        	sele aux_perlote
					TABLEREVERT(.t.)
					thisform.grid1.Refresh 
		     	endif 
		     	**********************************************************
		     	*MessageBox("zzz")
		   	endif	
		   	endscan	
			thisform.grid2.SetAll("dynamicbackcolor","IIF(copiado=1,RGB(255,223,191),RGB(255,255,255))","Column")
			thisform.grid3.refresh
			*select aux_faccom
			*reg=recno()
			*go record reg
			*if abs(recno())=recc()
			*	go top
			*else
			*	skip	
			*endif
			thisform.grid2.refresh
			thisform.grid2.activatecell(abs(recno()),5)
			thisform.grid2.column5.text1.setfocus
		
		
	ENDPROC

	PROCEDURE Xpbutton11.Click
		thisform.suma()
		
		_aplicacomision=0
		
		Select aux_faccomsele
		Scan
			If importe<>0
				If Left(numero,2)<>'AN'
					_aplicacomision=_aplicacomision + importe
				endif
			endif
		endscan
		
		If thisform.txtcomi.Value=0
			thisform.txt_totalcomi.Value=0
		else
		*	thisform.txt_totalcomi.Value=Round((thisform.text5.Value - thisform.totret.value)* thisform.txtcomi.value/100,2)
			thisform.txt_totalcomi.Value=Round((_aplicacomision)* thisform.txtcomi.value/100,2)
		EndIf
		thisform.suma()
		return
		
		
		
		thisform.suma()
		If thisform.txtcomi.Value=0
			thisform.txt_totalcomi.Value=0
		else
		*	thisform.txt_totalcomi.Value=Round((thisform.text5.Value - thisform.totret.value)* thisform.txtcomi.value/100,2)
			thisform.txt_totalcomi.Value=Round((thisform.text5.Value )* thisform.txtcomi.value/100,2)
		EndIf
		thisform.suma()
	ENDPROC

	PROCEDURE Xpbutton12.Click
		thisform.imp_detalleoc()
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		RETURN
		Select aux_faccomsele
		If Reccount()>0
			If Left(numero,2)='OC'
				_clave=Numero
				brow
				dele
				
				Select detalle_faccom
				Set Order To clave
				Seek _Clave
				If Found()
					DO while !Eof() and clave=_Clave
						scatter memvar
						m.importe=m.total
						Select aux_faccomsele
						Append Blank
						Gather memvar
						
						Select detalle_faccom
						skip
					EndDo
					
				EndIf
			Else
				MessageBox("Solo se puede ver detalle de las Ordenes de Compra Acumuladas",48,"Control")
			EndIf
		Else
			MessageBox("No hay Datos para Mostrar",48,"Control")
		endif
		thisform.Refresh 
		
	ENDPROC

	PROCEDURE Xpbutton13.Click
		
		if thisform.depositos1.Visible=.f.
			select deposito2
			if recc()=0
				append blank
			endif
			thisform.depositos1.visible=.t.
			thisform.depositos1.grid1.visible=.t.	
			thisform.depositos1.grid1.column1.text1.setfocus
		else
			thisform.text14.value=0
			select deposito2
			go top
			scan
				thisform.text14.value=thisform.text14.value+deposito2.importe
			endscan
			thisform.total()
			thisform.depositos1.visible=.f.
			thisform.text14.setfocus
		endif	
		
	ENDPROC

	PROCEDURE Xpbutton14.Click
		If (thisform.asiento1.text5.value+thisform.asiento1.text6.value)=0
			messagebox("Debe Cargar Asiento Contable",48,"Control")
			thisform.asiento1.grid1.column1.text1.setfocus
			return
		EndIf	
		
		If thisform.text5.Value>1500 AND thisform.totret.Value=0
		   *messagebox("El monto a pagar es superior a 500 pesos, debe realizar retenciones",48,"Control")
		   *thisform.totret.SetFocus 
		   *RETURN 
		ENDIF 
		if thisform.reposicion.value=1
			if thisform.conectar_sql()<>0
				messagebox("No tiene Conexion con el Servidor, consulte al Programador",48,"Control")
				return
			endif	
			
			if thisform.nueva   && Controlo que no exista una reposicion sin el nro de rendicion.
				thisform.msde1.vervista("VerLibre","select * from ReposicionFondoFijo where anulado=0 and idrendicion=0 and cuenfondofijo='"+thisform.codigo1.value+"' ")
				sele verlibre
				if recc()>0
					_msj=''
					scan
						_msj=_msj + dtoc(Fecha)+'-'
					endscan
					messagebox("Hay Reposiciones de Fondo Fijo pendiente de Cierre,"+chr(13)+"el Cajero debe realizar la Rendici�n antes de Reponer Nuevamente"+chr(13)+"Fechas a Rendir: "+_msj,48,"Control")
					return
				endif
			else
				&& Ver si la reposicion no esta rendida para grabar modif sino, no permitir grabar modificaciones.
				thisform.msde1.vervista("VerLibre","select * from ReposicionFondoFijo where ordpago='"+thisform.nroord1.value+"' and anulado=0")
				sele verlibre
				if recc()>0
					go top
					if idrendicion<>0
						messagebox("La reposici�n de Fondo Fijo ya fue Rendida, no se puede modificar, debe Anular la Rendici�n si desea hacerlo")
						return
					endif
		
				endif
			endif
			
		endif
		
		if verfield("tipo_orden",thisform.text3.value,"pide","Codigo")="P"
			store 0 to comp_apli
			select aux_faccomsele
			go top
			scan
				if inlist(left(aux_faccomsele.numero,1),"C","A")
					comp_apli=comp_apli-importe
				Else
					comp_apli=comp_apli+importe
				Endif	
			endscan
			comp_apli=comp_apli+thisform.text2.value
			if comp_apli#Thisform.text5.value
				messagebox("Controle Comprobantes Aplicadados en este pago o el monto de Anticipo por que no coinsiden con el Total de la Orden de Pago",48,"Control")
				thisform.text2.Setfocus	
				return
			endif
		endif
		do case
			case (thisform.text5.value)#abs(thisform.text10.value)+abs(thisform.text11.value)+abs(thisform.totret.value)+thisform.txtdescuentos.value;
				+abs(thisform.text1.value)+thisform.text8.value+thisform.txt_totalcomi.value +Abs(thisform.text14.Value)
				=messagebox('Verifique Importes Cargados',48,'Control')
				thisform.text11.setfocus
				return
			case thisform.asiento1.text4.value#0
				=messagebox('Verifique Asientos Cargados',48,'Control')
				thisform.text11.setfocus
				return
			case thisform.text5.value=0 
				=messagebox('El importe de la Orden de Pago debe ser Mayor que 0(cero)',48,'Control')
				thisform.text5.setfocus
				return	
			other 
				if messagebox('Confirma grabar datos',36,'Grabar')=6
				
				*---  Verificar que no se haya grabado otra orden con el mismo numero.
					If thisform.nueva
						Select orden
						Set Order To nroord
						Go bott
						_ultimo=Val(nroord)
						If Val(thisform.nroORD1.Value)<>(_ultimo+1)
							thisform.nroORD1.Value=ceros(Alltrim(Str(_ultimo+1)),6)
							MessageBox("Otro operador utiliz� este N�mero de Orden, se asignar� el Nro: "+thisform.nroORD1.Value,48,"Control")
						endif
					EndIf
							
				*--------------------------------------------------------------------
		
				
					*return
		*-----------------------------------------------------------------------------		
				
					if thisform.text2.value#0
						sele faccom
						set order to numero
						seek thisform.Codigo1.value+"AN-ORDEN"+thisform.nroord1.value
						if !found()
							appe blan
						endif
						repl numero with "AN-ORDEN"+thisform.nroord1.value
						repl fecha with ThisForm.text7.value
						repl proveedor with ThisForm.Codigo1.value
						repl total with ThisForm.text2.value
					endif
					if thisform.text3.value="002"
						select movimientos_bancos
						append blank
						repl pagprov with thisform.Nroord1.value
						repl codigo_banco with thisform.codigo1.value
						repl det_codban with thisform.text4.value
						repl tipo_banco with "N"
						repl fecha_emision with thisform.text7.value
						repl tipo_movimiento with '006'
						repl debe_haber with 'D'
						repl detalle with "O.P.N�: "+thisform.Nroord1.value+" "+Alltr(thisform.text4.value)+" "+alltr(thisform.text12.value)
						repl importe with thisform.text5.value 
					Endif
					******* Grabo Efectivo en Mayor de Tesereria *******
					if thisform.text11.value#0
						store space(0) to efectivo_teso,efectivo_nombre
						Select asig_cuentas
						Go top
						efectivo_teso=asig_cuentas.caja_teso
						efectivo_nombre=vercod("bancos",efectivo_teso)			
						select movimientos_bancos
						append blank
						repl pagprov with thisform.Nroord1.value
						repl codigo_banco with efectivo_teso
						repl det_codban with efectivo_nombre
						repl tipo_banco with "N"
						repl fecha_emision with thisform.text7.value
						repl tipo_movimiento with '006'
						repl debe_haber with 'H'
						repl detalle with "O.P.N�: "+thisform.Nroord1.value+" "+Alltr(thisform.text4.value)+" "+alltr(thisform.text12.value)
						repl importe with thisform.text11.value 
					Endif			
					select aux_faccomsele
					go top
					do while not eof()
						scatte memvar
						m.numero=m.numero
						m.proveedor=thisform.codigo1.value
						m.nroord=thisform.nroord1.value
						select pagosprov
						append blank
						gather memvar
						select aux_faccomsele
						skip
					enddo
					select orden
					set order to nroord
					seek thisform.nroord1.value	
					if !found()
						append blank
					endif	
					repl nroord with thisform.nroord1.value,proveedor with thisform.codigo1.value
					repl fecha with thisform.text7.value
					repl tipo with thisform.text3.value,nomtipo with thisform.text6.value
					repl importe with thisform.text5.value,detalle with thisform.text4.value
					repl adelanto with thisform.text2.value
					repl cheque with thisform.text10.value,efectivo with thisform.text11.value
					Replace transfe with thisform.text14.value
					repl cheque3 with thisform.text1.value,retencion with thisform.text8.value
					repl otras_rete with thisform.totret.value
					repl leyenda with thisform.text12.value
					Replace comi_oc with thisform.txtcomi.Value
					Replace tot_comioc with thisform.txt_totalcomi.value
					repl reposicion with thisform.reposicion.value
					
					
					**--Grabo reposicion en sql-----------------------------------------------------------------------------------
					if thisform.reposicion.value=1 && Reposici�n de Fondo Fijo.
					
						_cod=thisform.codigo1.value
						_saldo=0.00
						thisform.msde1.vervista("VerRendicion","select top 1 * from RendicionFondoFijo where CuenFondoFijo='"+_cod+"' and anulado=0 order by fecha desc,idrendicion desc")
						sele VerRendicion
						if recc()>0
							go top
							_saldo=saldo
						endif
						
						_nro=allt(thisform.nroord1.value)
						_fec=thisform.text7.value
						_det=thisform.text12.value
						_imp=thisform.text5.value
						_tot=_saldo+_imp
						_op=val(cod_op)
						_fyh=datetime()				
						
						if thisform.nueva
							_error=thisform.msde1.sql2("Insert into ReposicionFondoFijo (CuenFondoFijo,OrdPago,Fecha,Importe,Saldo,total,Detalle,OpCrea,FecCrea) values(?_cod,?_nro,?_fec,?_imp,?_saldo,?_tot,?_det,?_op,?_fyh)")
							if _error<>0
								messagebox("No se pudo Grabar en SQl, Error con la conexion al Servidor")
							endif
		
						else
							* Al grabar un orden solo permite anular.
							*_error=thisform.msde1.sql2("update ReposicionFondoFijo set CuenFondoFijo=?_cod,Fecha=?_fec,Importe=?_imp,Saldo=?_saldo,total=?_tot,Detalle=?_det where anulado=0 and ordpago='"+_nro+"' ")
						endif
					endif
					**-------------------------------------------------------------------------------------
					
					
					******* Grabo Movimientos Bancos *******
					select deposito
					go top
					do while not eof() and val(codigo_ban)#0
						scatter memvar
						m.codigo_banco=m.codigo_ban
						m.numero_comprobante=m.numero_com
						fecha_emision=fecha_emis
						fecha_vencimiento=fecha_venc
						m.tipo_movimiento='001'
						m.debe_haber='H'
						m.pagprov=thisform.nroord1.value
						m.tipo_banco="S"
						m.Det_CodBan=vercod("bancos",deposito.codigo_ban)
						
										
						if m.pend_reg=1   && SI el cheque estaba pendiente, lo marco con la orden de pago realizada, marce nuevo 26-02-2013
							m.pend_reg=0  && Quito Marca de Pendiente.
							m.reg_orden = m.pagprov
							m.fec_reg = date()
							m.op_reg= val(cod_op)
						else
							m.pend_reg=0  && Quito Marca de Pendiente.
							m.reg_orden = ''
							m.fec_reg = {}
							m.op_reg= 0
						endif
						
						select movimientos_bancos
						if m.registro=0
							append blank
							gather memvar			
						else
							go record m.registro
							if m.importe#0
								gather memvar				
							else
								dele	
							endif	
						endif	
						
						&& Si es un movimiento de cheque pendiente de registraci�n, se debe grabar en Movimientos Bancos, en la cuenta de fondo Documentaci�n Pendiente.
						sele deposito
						if pend_reg=1 and val(codigo_ban)#0
							select movimientos_bancos
							append blank
							repl pagprov with thisform.nroord1.value
							repl codigo_banco with asig_cuentas.fondo_pend
							repl det_codban with vercod('bancos',codigo_banco)
							repl tipo_banco with "N"
							repl fecha_emision with thisform.text7.value
							repl tipo_movimiento with '006'  && Transferencias
							repl debe_haber with 'H'
							repl detalle with "Orden de Pago N�: "+thisform.nroord1.value &&+" "+Alltr(thisform.text4.value)+" "+alltr(thisform.text12.value)
							repl importe with deposito.importe
							repl egreso with ''
							
						endif
						
						
						select deposito
						skip
					enddo
					select movimientos_bancos
					=tableupdate(.t.)
					
					
					******* Grabo Pgos por Transferencia Electronica *******
					select deposito2
					go top
					do while not eof() and val(codigo_ban)#0
						scatter memvar
						m.codigo_banco=m.codigo_ban
						m.numero_comprobante=m.numero_com
						fecha_emision=fecha_emis
						fecha_vencimiento=fecha_venc
						m.tipo_movimiento='006'
						m.debe_haber='H'
						m.pagprov=thisform.nroord1.value
						m.tipo_banco="S"
						m.Det_CodBan=vercod("bancos",deposito2.codigo_ban)
						m.detalle='O.P.N�:'+thisform.nroORD1.Value+' Pago por Transf. Electr�nica'
			
						select movimientos_bancos
						if m.registro=0
							append blank
							gather memvar			
						else
							go record m.registro
							if m.importe#0
								gather memvar				
							else
								dele	
							endif	
						endif	
						
			
						
						select deposito2
						skip
					enddo
					select movimientos_bancos
					=tableupdate(.t.)
					
					******* Grabo Cheques de Terceros
					select aux_terceros2
					go top
					scan
						select chequeter
						go record aux_terceros2.regi
						if aux_terceros2.copiado=1
							repl fechadep with thisform.text7.value
							repl ord_pag  with thisform.NROORD1.value
						else
							repl fechadep with {}
							repl ord_pag with ""
						endif
						select aux_terceros2
					endscan		
					******* Grabo Retenciones en Cartera *******
					select aux_entrega_retenciones
					go top
					scan
						select retenciones
						go record aux_entrega_retenciones.registro
						if aux_entrega_retenciones.copiado=1
							repl fec_egr with thisform.text7.value
							repl ord_pag  with thisform.NROORD1.value
							repl proveedor_egreso with thisform.codigo1.value
							repl nompro_egreso with thisform.text4.value
						else
							repl fec_egr with {}
							repl ord_pag  with space(6)
							repl proveedor_egreso with space(6)
							repl nompro_egreso with ""
						endif
						select aux_entrega_retenciones
					endscan			
					
					*******	Grabo tipos_reten ************		
					*if thisform.efec_ret=.t.		
				 	select Aux_perlote
					Go Top
					Do While Not Eof() and val(CodAli)#0
						scatter memvar
						m.Proveedor=Thisform.codigo1.Value
						m.nroord=thisform.Nroord1.value
						m.codigo=Aux_perlote.codali
						m.nombre=ALLTRIM(verfield('tipo_retencio',Aux_perlote.codali,'nombre','codigo'))
						m.base=Aux_perlote.neto
						m.reten=Aux_perlote.percepcion
						*m.nroothisform.numord=0
						select tipo_reten
						set order to orden_prov
						seek thisform.nroord1.value+thisform.codigo1.value
						If not found()
								If m.total#0 and m.base#0 
									Append Blank
									Gather MemVar
								EndIf
						EndIf
					   
					   Select Aux_perlote
					   Skip
				     EndDo
				     *endif 
					
					*******	Grabo CERBRU ****************
		            thisform.numcer=""
					sele cerbru
					if reccount()=0
					  num="000001"
					  thisform.numcer=num
					else
					  set order to profec2
					  *seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					  seek thisform.codigo1.value+thisform.nroord1.value
					  *proveedor+DTOC(fecha)+tipoib+no
					  *proveedor+no profec2
					  if found() 
					     num=nrocer
					     thisform.numcer=num
					  else
					     set order to
					     set order to nrocer
					     go bott
					     num=ceros(str(val(nrocer)+1,6),6)
					     thisform.numcer=num
					  endif 
					endif 
					
					sele aux_perlote
					go top
					
					thisform.edit1.value=""
					thisform.totrete=0
					thisform.brutot=0
					
					do while not eof()
					   if  total>0 and neto>0
				           sele cerbru
					       set order to profec2
					       *seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					       seek thisform.codigo1.value+thisform.nroord1.value
					       if found() 
					           num=nrocer
					       else
					          appen blank
					       endif    
					       replace nrocer with num
					       replace fecha with thisform.text7.value
					       replace proveedor with thisform.codigo1.value
					       replace nompro with allt(verfield('proveedores',thisform.codigo1.value,'nombre','codigo')) 
					       thisform.nomcer=allt(verfield('proveedores',thisform.codigo1.value,'nombre','codigo')) 
					       replace dompro with allt(verfield('proveedores',thisform.codigo1.value,'domicilio','codigo')) 
					       thisform.domcer=allt(verfield('proveedores',thisform.codigo1.value,'domicilio','codigo')) 
					       replace cuit with verfield('proveedores',thisform.codigo1.value,'cuit','codigo') 
					       thisform.cuitcer=verfield('proveedores',thisform.codigo1.value,'cuit','codigo') 
					       replace brupro with ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),10)
					       thisform.brucer=ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),10)
					       replace bruto with aux_perlote.neto
					       replace neto with aux_perlote.neto
					       replace impbru with aux_perlote.percepcion
					       replace implot with aux_perlote.lotehogar
					       replace porbru with aux_perlote.alicuota
					       replace porlot with 20.0
					       
					       replace nrobruto with left(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12),3)+"-"+;
					       righ(left (ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12) ,10) ,6)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12), 1)
					       
					       replace nrocuit with left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),2)+"-"+;
					       righ(left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),11),8)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),1)
					       
					       replace tipoib with aux_perlote.codali
					       replace no with thisform.nroord1.value
					       
					       thisform.edit1.value=thisform.edit1.value+"Ingresos Brutos: "+str(verfield('tipo_retencio',aux_perlote.codali,'alicuota','codigo'),7,2)+"%"+"   "+str(aux_perlote.percepcion,10,2)+chr(13)
					       if aux_perlote.lotehogar>0
					         thisform.edit1.value=thisform.edit1.value+"Lote Hogar:      "+str(20.0,7,2)+"%"+"   "+str(aux_perlote.lotehogar,10,2)+chr(13)
					       endif 
					       thisform.totrete=thisform.totrete+(aux_perlote.lotehogar+aux_perlote.percepcion)
		       			   thisform.brutot=thisform.brutot+aux_perlote.neto
					   endif 
					sele aux_perlote
					skip
					enddo 
					
					sele aux_perlote
					go top
					if reccount()>0 and total>0
					   if Messagebox("Desea Imprimir Certificado De Retencion",36,"Imprimir")=6
					      thisform.edit1.value=thisform.edit1.value+"--------------------------------------------"
					      thisform.edit1.value=thisform.edit1.value+"Importe Retenido :          "+str(thisform.totrete,10,2)+chr(13) 
					      sele cerbru
					      set order to 
					      set order to profec2
		 			      seek thisform.codigo1.value+thisform.nroord1.value
		 			      thisform.feccer={//}
		 		          if found()
		 		             thisform.feccer=fecha
		 			         repo form cerbru prev nocon
					      endif 
					   endif 
					endif 
					*select Aux_tipop
					*=TableRevert(.t.)
					*select Aux_perlote
					*=TableRevert(.t.)
		
		
					****** Grabo Otros Descuentos ****************** marce(11-06-2012)
					SELECT aux_dctos
					SCAN
						SCATTER memvar	
						m.nroord=thisform.nroORD1.Value
						m.proveedor=thisform.codiGO1.Value
						m.op_crea=VAL(cod_op)
						m.fec_crea=DATETIME()
						m.fecha=thisform.text7.value
		*				m.nroasiento ???
						IF VAL(m.cod_dcto)<>0 
							SELECT descuentos_proveedores
							SET ORDER TO ORDPROV   && NROORD+PROVEEDOR+COD_DCTO
							SEEK m.nroord+m.proveedor+m.cod_dcto
							IF FOUND()
							
							ELSE
								APPEND BLANK
							endif
							GATHER memvar
						endif
					endscan
					
					
					***********************************************************
					*******	Grabo Asiento Contable *******
					If (thisform.asiento1.text5.value+thisform.asiento1.text6.value)#0
						thisform.asiento(thisform.NROORD1.value,'grabar')
					EndIf	
					thisform.xpbutton4.visible=.t.
					thisform.imprimir("I")
					thisform.limpiar()
					
				    thisform.ret1.visible=.f.
		    	    thisform.ret2.visible=.f.
		    	    thisform.efec_ret=.f. 
		
					select Aux_tipop
		        	=TableRevert(.t.)
					select Aux_perlote
					=TableRevert(.t.)
		
				endif	
		endcase
		
	ENDPROC

	PROCEDURE Xpbutton15.Click
		
		thisform.p=thisform.p+1
		if thisform.p=3
			thisform.p=1
		endif
		if thisform.p=1
			select aux_dctos
			if recc()=0
				append blank
			endif
			thisform.descuentos1.visible=.t.
			thisform.descuentos1.grdaux_dctos.visible=.t.	
			thisform.descuentos1.grdaux_dctos.column4.text1.setfocus
		else
		
			thisform.txtdescuentos.value=0
			select aux_dctos
			go top
			scan
				thisform.txtdescuentos.value=thisform.txtdescuentos.value+importe
			endscan
			thisform.total()
			
			thisform.descuentos1.visible=.f.
			thisform.descuentos1.grdaux_dctos.visible=.f.	
			thisform.txtdescuentos.setfocus
		endif	
		
	ENDPROC

	PROCEDURE Xpbutton16.Click
		thisform.ver_reintegro()
	ENDPROC

	PROCEDURE Xpbutton2.Click
		If (thisform.asiento1.text5.value+thisform.asiento1.text6.value)=0
			messagebox("Debe Cargar Asiento Contable",48,"Control")
			thisform.asiento1.grid1.column1.text1.setfocus
			return
		EndIf	
		
		If thisform.text5.Value>1500 AND thisform.totret.Value=0
		   *messagebox("El monto a pagar es superior a 500 pesos, debe realizar retenciones",48,"Control")
		   *thisform.totret.SetFocus 
		   *RETURN 
		ENDIF 
		if thisform.reposicion.value=1
			if thisform.conectar_sql()<>0
				messagebox("No tiene Conexion con el Servidor, consulte al Programador",48,"Control")
				return
			endif	
			
			if thisform.nueva   && Controlo que no exista una reposicion sin el nro de rendicion.
				thisform.msde1.vervista("VerLibre","select * from ReposicionFondoFijo where anulado=0 and idrendicion=0 and cuenfondofijo='"+thisform.codigo1.value+"' ")
				sele verlibre
				if recc()>0
					_msj=''
					scan
						_msj=_msj + dtoc(Fecha)+'-'
					endscan
					messagebox("Hay Reposiciones de Fondo Fijo pendiente de Cierre,"+chr(13)+"el Cajero debe realizar la Rendici�n antes de Reponer Nuevamente"+chr(13)+"Fechas a Rendir: "+_msj,48,"Control")
					return
				endif
			else
				&& Ver si la reposicion no esta rendida para grabar modif sino, no permitir grabar modificaciones.
				thisform.msde1.vervista("VerLibre","select * from ReposicionFondoFijo where ordpago='"+thisform.nroord1.value+"' and anulado=0")
				sele verlibre
				if recc()>0
					go top
					if idrendicion<>0
						messagebox("La reposici�n de Fondo Fijo ya fue Rendida, no se puede modificar, debe Anular la Rendici�n si desea hacerlo")
						return
					endif
		
				endif
			endif
			
		endif
		
		If thisform.nueva
			If thisform.reintegros.check_pagado.Value=1
				MessageBox("El Reintegro ya se encuentra Pagado",48,"Control")
				thisform.txtreintegro.Value=''
			endif
		
			If thisform.reintegros.check_anulado.Value=1
				MessageBox("El Reintegro se encuentra Anulado",48,"Control")
				thisform.txtreintegro.Value=''
			EndIf
			If Val(thisform.txtreintegro.value)<>0 and thisform.check_pagar.Value=0	
				MessageBox("El reintegro No est� marcado para ser pagado en estar Orden, se limpiar� el Dato",48,"Control")
				thisform.txtreintegro.Value=''
			EndIf
			
		EndIf
		
		
		if verfield("tipo_orden",thisform.text3.value,"pide","Codigo")="P"
			store 0 to comp_apli
			select aux_faccomsele
			go top
			scan
				if inlist(left(aux_faccomsele.numero,1),"C","A")
					comp_apli=comp_apli-importe
				Else
					comp_apli=comp_apli+importe
				Endif	
			endscan
			comp_apli=comp_apli+thisform.text2.value
			if comp_apli#Thisform.text5.value
				messagebox("Controle Comprobantes Aplicadados en este pago o el monto de Anticipo por que no coinsiden con el Total de la Orden de Pago",48,"Control")
				thisform.text2.Setfocus	
				return
			endif
		endif
		do case
			case (thisform.text5.value)#abs(thisform.text10.value)+abs(thisform.text11.value)+abs(thisform.totret.value)+thisform.txtdescuentos.value;
				+abs(thisform.text1.value)+thisform.text8.value+thisform.txt_totalcomi.value +Abs(thisform.text14.Value)
				=messagebox('Verifique Importes Cargados',48,'Control')
				thisform.text11.setfocus
				return
			case thisform.asiento1.text4.value#0
				=messagebox('Verifique Asientos Cargados',48,'Control')
				thisform.text11.setfocus
				return
			case thisform.text5.value=0 
				=messagebox('El importe de la Orden de Pago debe ser Mayor que 0(cero)',48,'Control')
				thisform.text5.setfocus
				return	
			other 
				if messagebox('Confirma grabar datos',36,'Grabar')=6
				
				*---  Verificar que no se haya grabado otra orden con el mismo numero.
					If thisform.nueva
						Select orden
						&&26122016 GAM
						Append Blank
						thisform.nroORD1.Value=ceros(Alltrim(Str(idorden)),6)
						_nreg=Recno()
						thisform.Refresh
						&&
		*				Set Order To nroord
		*				Go bott
		*				_ultimo=Val(nroord)
		*				If Val(thisform.nroORD1.Value)<>(_ultimo+1)
		*					thisform.nroORD1.Value=ceros(Alltrim(Str(_ultimo+1)),6)
		*					MessageBox("Otro operador utiliz� este N�mero de Orden, se asignar� el Nro: "+thisform.nroORD1.Value,48,"Control")
		*				endif
					EndIf
							
				*--------------------------------------------------------------------
		
				
					*return
		*-----------------------------------------------------------------------------		
				
					if thisform.text2.value#0
						sele faccom
						set order to numero
						seek thisform.Codigo1.value+"AN-ORDEN"+thisform.nroord1.value
						if !found()
							appe blan
						endif
						repl numero with "AN-ORDEN"+thisform.nroord1.value
						repl fecha with ThisForm.text7.value
						repl proveedor with ThisForm.Codigo1.value
						repl total with ThisForm.text2.value
					endif
					if thisform.text3.value="002"
						select movimientos_bancos
						append blank
						repl pagprov with thisform.Nroord1.value
						repl codigo_banco with thisform.codigo1.value
						repl det_codban with thisform.text4.value
						repl tipo_banco with "N"
						repl fecha_emision with thisform.text7.value
						repl tipo_movimiento with '006'
						repl debe_haber with 'D'
						repl detalle with "O.P.N�: "+thisform.Nroord1.value+" "+Alltr(thisform.text4.value)+" "+alltr(thisform.text12.value)
						repl importe with thisform.text5.value 
					Endif
					******* Grabo Efectivo en Mayor de Tesereria *******
					if thisform.text11.value#0
						store space(0) to efectivo_teso,efectivo_nombre
						Select asig_cuentas
						Go top
						efectivo_teso=asig_cuentas.caja_teso
						efectivo_nombre=vercod("bancos",efectivo_teso)			
						select movimientos_bancos
						append blank
						repl pagprov with thisform.Nroord1.value
						repl codigo_banco with efectivo_teso
						repl det_codban with efectivo_nombre
						repl tipo_banco with "N"
						repl fecha_emision with thisform.text7.value
						repl tipo_movimiento with '006'
						repl debe_haber with 'H'
						repl detalle with "O.P.N�: "+thisform.Nroord1.value+" "+Alltr(thisform.text4.value)+" "+alltr(thisform.text12.value)
						repl importe with thisform.text11.value 
					Endif			
					select aux_faccomsele
					go top
					do while not eof()
						scatte memvar
						m.numero=m.numero
						m.proveedor=thisform.codigo1.value
						m.nroord=thisform.nroord1.value
						select pagosprov
						append blank
						gather memvar
						select aux_faccomsele
						skip
					enddo
					select orden
					If thisform.nueva
						Go _nreg
						Replace opcrea with Val(cod_op),feccrea with Datetime()
		*			else &&SI MAS ADELANTE SE HABILITA EL BOTON GRABAR para ordenes viejas
		*				set order to nroord
		*				seek thisform.nroord1.value
		*				If Found()
		*					Replace opmodi with Val(cod_op),fecmodi with Datetime()
		*				Else
		*					Set Deleted off
		*					Seek thisform.noord1.value
		*					If Found()
		*						If Deleted()
		*							MessageBox('Orden de Pago ANULADA!!!'+Chr(13)+;
		*									   'Operador: '+Cod_op+' - '+nom_op+Chr(13)+;
		*									   'El '+Left(Ttoc(fe),10)+' a las '+Right(Ttoc(fe),8),64,'Aviso')
		*							Return 
		*						EndIf
		*					Else
		*						MessageBox('N� Orden Inexistente',48,'Aviso')
		*						Return 
		*					EndIf
		*				EndIf
		*				Set Deleted on
					EndIf 
					repl nroord with thisform.nroord1.value,proveedor with thisform.codigo1.value
					repl fecha with thisform.text7.value
					repl tipo with thisform.text3.value,nomtipo with thisform.text6.value
					repl importe with thisform.text5.value,detalle with thisform.text4.value
					repl adelanto with thisform.text2.value
					repl cheque with thisform.text10.value,efectivo with thisform.text11.value
					Replace transfe with thisform.text14.value
					repl cheque3 with thisform.text1.value,retencion with thisform.text8.value
					repl otras_rete with thisform.totret.value
					repl leyenda with thisform.text12.value
					Replace comi_oc with thisform.txtcomi.Value
					Replace tot_comioc with thisform.txt_totalcomi.value
					repl reposicion with thisform.reposicion.value
					
					
					**--Grabo reposicion en sql-----------------------------------------------------------------------------------
					if thisform.reposicion.value=1 && Reposici�n de Fondo Fijo.
					
						_cod=thisform.codigo1.value
						_saldo=0.00
						thisform.msde1.vervista("VerRendicion","select top 1 * from RendicionFondoFijo where CuenFondoFijo='"+_cod+"' and anulado=0 order by fecha desc,idrendicion desc")
						sele VerRendicion
						if recc()>0
							go top
							_saldo=saldo
						endif
						
						_nro=allt(thisform.nroord1.value)
						_fec=thisform.text7.value
						_det=thisform.text12.value
						_imp=thisform.text5.value
						_tot=_saldo+_imp
						_op=val(cod_op)
						_fyh=datetime()				
						
						if thisform.nueva
							_error=thisform.msde1.sql2("Insert into ReposicionFondoFijo (CuenFondoFijo,OrdPago,Fecha,Importe,Saldo,total,Detalle,OpCrea,FecCrea) values(?_cod,?_nro,?_fec,?_imp,?_saldo,?_tot,?_det,?_op,?_fyh)")
							if _error<>0
								messagebox("No se pudo Grabar en SQl, Error con la conexion al Servidor")
							endif
		
						else
							* Al grabar un orden solo permite anular.
							*_error=thisform.msde1.sql2("update ReposicionFondoFijo set CuenFondoFijo=?_cod,Fecha=?_fec,Importe=?_imp,Saldo=?_saldo,total=?_tot,Detalle=?_det where anulado=0 and ordpago='"+_nro+"' ")
						endif
					endif
					**-------------------------------------------------------------------------------------
					
					**--Si es un Pago de Reintegro, Marco y Grabo datos en ExcedenteArchivos-----------------------------------------------------------------------------------
						If Val(thisform.txtreintegro.value)<>0 and thisform.check_pagar.Value=1
							If thisform.conectar_sql()=0
								_fec=thisform.text7.value
								_orden=thisform.nroORD1.value
								_nrocheque=''
								Select deposito
								Scan
									If importe<>0
										_nrocheque=_nrocheque+Alltrim(Str(Val(numero_com)))+'/'
									endif
								EndScan
								_nrocheque=Substr(Alltrim(_nrocheque),1,35)
								_error=thisform.msde1.sql2("Update ExcedenteArchivos set Pagado=1,FechaPago=?_fec,OrdenPago=?_Orden,NroCheque=?_NroCheque where pagado=0 and IdComprobante="+thisform.txtreintegro.Value)
								_error2=thisform.msde1.sql2("Update ComprobantesPagos set Pagado=1,FechaPago=?_fec,OrdenPago=?_Orden,NroCheque=?_NroCheque where pagado=0 and IdComprobante="+thisform.txtreintegro.Value)
								if _error<>0 or _error2<>0
									messagebox("No se pudo Marcar el Pago en Sistema de Ordenes, Error con la conexion al Servidor",48,"Aviso")
								endif
								
								Select orden
								Replace reintegro with Val(thisform.txtreintegro.Value)
							Else
								messagebox("No se pudo Marcar el Pago en Sistema de Ordenes, Error con la conexion al Servidor",48,"Aviso")
							endif
						endif
					
					**-----------------------------------------------------------------------------------------------------------------------------
					
					
					
					******* Grabo Movimientos Bancos *******
					select deposito
					go top
					do while not eof() and val(codigo_ban)#0
						scatter memvar
						m.codigo_banco=m.codigo_ban
						m.numero_comprobante=m.numero_com
						fecha_emision=fecha_emis
						fecha_vencimiento=fecha_venc
						m.tipo_movimiento='001'
						m.debe_haber='H'
						m.pagprov=thisform.nroord1.value
						m.tipo_banco="S"
						m.Det_CodBan=vercod("bancos",deposito.codigo_ban)
						
										
						if m.pend_reg=1   && SI el cheque estaba pendiente, lo marco con la orden de pago realizada, marce nuevo 26-02-2013
							m.pend_reg=0  && Quito Marca de Pendiente.
							m.reg_orden = m.pagprov
							m.fec_reg = date()
							m.op_reg= val(cod_op)
						else
							m.pend_reg=0  && Quito Marca de Pendiente.
							m.reg_orden = ''
							m.fec_reg = {}
							m.op_reg= 0
						endif
						
						select movimientos_bancos
						if m.registro=0
							append blank
							gather memvar			
						else
							go record m.registro
							if m.importe#0
								gather memvar				
							else
								dele	
							endif	
						endif	
						
						&& Si es un movimiento de cheque pendiente de registraci�n, se debe grabar en Movimientos Bancos, en la cuenta de fondo Documentaci�n Pendiente.
						sele deposito
						if pend_reg=1 and val(codigo_ban)#0
							select movimientos_bancos
							append blank
							repl pagprov with thisform.nroord1.value
							repl codigo_banco with asig_cuentas.fondo_pend
							repl det_codban with vercod('bancos',codigo_banco)
							repl tipo_banco with "N"
							repl fecha_emision with thisform.text7.value
							repl tipo_movimiento with '006'  && Transferencias
							repl debe_haber with 'H'
							repl detalle with "Orden de Pago N�: "+thisform.nroord1.value &&+" "+Alltr(thisform.text4.value)+" "+alltr(thisform.text12.value)
							repl importe with deposito.importe
							repl egreso with ''
							
						endif
						
						
						select deposito
						skip
					enddo
					select movimientos_bancos
					=tableupdate(.t.)
					
					
					******* Grabo Pgos por Transferencia Electronica *******
					select deposito2
					go top
					do while not eof() and val(codigo_ban)#0
						scatter memvar
						m.codigo_banco=m.codigo_ban
						m.numero_comprobante=m.numero_com
						fecha_emision=fecha_emis
						fecha_vencimiento=fecha_venc
						m.tipo_movimiento='006'
						m.debe_haber='H'
						m.pagprov=thisform.nroord1.value
						m.tipo_banco="S"
						m.Det_CodBan=vercod("bancos",deposito2.codigo_ban)
						m.detalle='O.P.N�:'+thisform.nroORD1.Value+' Pago por Transf. Electr�nica'
			
						select movimientos_bancos
						if m.registro=0
							append blank
							gather memvar			
						else
							go record m.registro
							if m.importe#0
								gather memvar				
							else
								dele	
							endif	
						endif	
						
			
						
						select deposito2
						skip
					enddo
					select movimientos_bancos
					=tableupdate(.t.)
					
					******* Grabo Cheques de Terceros
					select aux_terceros2
					go top
					scan
						select chequeter
						go record aux_terceros2.regi
						if aux_terceros2.copiado=1
							repl fechadep with thisform.text7.value
							repl ord_pag  with thisform.NROORD1.value
						else
							repl fechadep with {}
							repl ord_pag with ""
						endif
						select aux_terceros2
					endscan		
					******* Grabo Retenciones en Cartera *******
					select aux_entrega_retenciones
					go top
					scan
						select retenciones
						go record aux_entrega_retenciones.registro
						if aux_entrega_retenciones.copiado=1
							repl fec_egr with thisform.text7.value
							repl ord_pag  with thisform.NROORD1.value
							repl proveedor_egreso with thisform.codigo1.value
							repl nompro_egreso with thisform.text4.value
						else
							repl fec_egr with {}
							repl ord_pag  with space(6)
							repl proveedor_egreso with space(6)
							repl nompro_egreso with ""
						endif
						select aux_entrega_retenciones
					endscan			
					
					*******	Grabo tipos_reten ************		
					*if thisform.efec_ret=.t.		
				 	select Aux_perlote
					Go Top
					Do While Not Eof() and val(CodAli)#0
						scatter memvar
						m.Proveedor=Thisform.codigo1.Value
						m.nroord=thisform.Nroord1.value
						m.codigo=Aux_perlote.codali
						m.nombre=ALLTRIM(verfield('tipo_retencio',Aux_perlote.codali,'nombre','codigo'))
						m.base=Aux_perlote.neto
						m.reten=Aux_perlote.percepcion
						*m.nroothisform.numord=0
						select tipo_reten
						set order to orden_prov
						seek thisform.nroord1.value+thisform.codigo1.value
						If not found()
								If m.total#0 and m.base#0 
									Append Blank
									Gather MemVar
								EndIf
						EndIf
					   
					   Select Aux_perlote
					   Skip
				     EndDo
				     *endif 
					
					*******	Grabo CERBRU ****************
		            thisform.numcer=""
					sele cerbru
					if reccount()=0
					  num="000001"
					  thisform.numcer=num
					else
					  set order to profec2
					  *seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					  seek thisform.codigo1.value+thisform.nroord1.value
					  *proveedor+DTOC(fecha)+tipoib+no
					  *proveedor+no profec2
					  if found() 
					     num=nrocer
					     thisform.numcer=num
					  else
					     set order to
					     set order to nrocer
					     go bott
					     num=ceros(str(val(nrocer)+1,6),6)
					     thisform.numcer=num
					  endif 
					endif 
					
					sele aux_perlote
					go top
					
					thisform.edit1.value=""
					thisform.totrete=0
					thisform.brutot=0
					
					do while not eof()
					   if  total>0 and neto>0
				           sele cerbru
					       set order to profec2
					       *seek thisform.codigo1.value+dtoc(thisform.text7.value)+aux_tipop.codigo+thisform.nroord1.value
					       seek thisform.codigo1.value+thisform.nroord1.value
					       if found() 
					           num=nrocer
					       else
					          appen blank
					       endif    
					       replace nrocer with num
					       replace fecha with thisform.text7.value
					       replace proveedor with thisform.codigo1.value
					       replace nompro with allt(verfield('proveedores',thisform.codigo1.value,'nombre','codigo')) 
					       thisform.nomcer=allt(verfield('proveedores',thisform.codigo1.value,'nombre','codigo')) 
					       replace dompro with allt(verfield('proveedores',thisform.codigo1.value,'domicilio','codigo')) 
					       thisform.domcer=allt(verfield('proveedores',thisform.codigo1.value,'domicilio','codigo')) 
					       replace cuit with verfield('proveedores',thisform.codigo1.value,'cuit','codigo') 
					       thisform.cuitcer=verfield('proveedores',thisform.codigo1.value,'cuit','codigo') 
					       replace brupro with ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),10)
					       thisform.brucer=ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),10)
					       replace bruto with aux_perlote.neto
					       replace neto with aux_perlote.neto
					       replace impbru with aux_perlote.percepcion
					       replace implot with aux_perlote.lotehogar
					       replace porbru with aux_perlote.alicuota
					       replace porlot with 20.0
					       
					       replace nrobruto with left(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12),3)+"-"+;
					       righ(left (ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12) ,10) ,6)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'brutos','codigo'),12), 1)
					       
					       replace nrocuit with left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),2)+"-"+;
					       righ(left(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),11),8)+"-"+;
					       right(ceros(verfield('proveedores',thisform.codigo1.value,'cuit','codigo'),13),1)
					       
					       replace tipoib with aux_perlote.codali
					       replace no with thisform.nroord1.value
					       
					       thisform.edit1.value=thisform.edit1.value+"Ingresos Brutos: "+str(verfield('tipo_retencio',aux_perlote.codali,'alicuota','codigo'),7,2)+"%"+"   "+str(aux_perlote.percepcion,10,2)+chr(13)
					       if aux_perlote.lotehogar>0
					         thisform.edit1.value=thisform.edit1.value+"Lote Hogar:      "+str(20.0,7,2)+"%"+"   "+str(aux_perlote.lotehogar,10,2)+chr(13)
					       endif 
					       thisform.totrete=thisform.totrete+(aux_perlote.lotehogar+aux_perlote.percepcion)
		       			   thisform.brutot=thisform.brutot+aux_perlote.neto
					   endif 
					sele aux_perlote
					skip
					enddo 
					
					sele aux_perlote
					go top
					if reccount()>0 and total>0
					   if Messagebox("Desea Imprimir Certificado De Retencion",36,"Imprimir")=6
					      thisform.edit1.value=thisform.edit1.value+"--------------------------------------------"
					      thisform.edit1.value=thisform.edit1.value+"Importe Retenido :          "+str(thisform.totrete,10,2)+chr(13) 
					      sele cerbru
					      set order to 
					      set order to profec2
		 			      seek thisform.codigo1.value+thisform.nroord1.value
		 			      thisform.feccer={//}
		 		          if found()
		 		             thisform.feccer=fecha
		 			         repo form cerbru prev nocon
					      endif 
					   endif 
					endif 
					*select Aux_tipop
					*=TableRevert(.t.)
					*select Aux_perlote
					*=TableRevert(.t.)
		
		
					****** Grabo Otros Descuentos ****************** marce(11-06-2012)
					SELECT aux_dctos
					SCAN
						SCATTER memvar	
						m.nroord=thisform.nroORD1.Value
						m.proveedor=thisform.codiGO1.Value
						m.op_crea=VAL(cod_op)
						m.fec_crea=DATETIME()
						m.fecha=thisform.text7.value
		*				m.nroasiento ???
						IF VAL(m.cod_dcto)<>0 
							SELECT descuentos_proveedores
							SET ORDER TO ORDPROV   && NROORD+PROVEEDOR+COD_DCTO
							SEEK m.nroord+m.proveedor+m.cod_dcto
							IF FOUND()
							
							ELSE
								APPEND BLANK
							endif
							GATHER memvar
						endif
					endscan
					
					
					***********************************************************
					*******	Grabo Asiento Contable *******
					If (thisform.asiento1.text5.value+thisform.asiento1.text6.value)#0
						thisform.asiento(thisform.NROORD1.value,'grabar')
					EndIf	
					thisform.xpbutton4.visible=.t.
					thisform.imprimir("I")
					thisform.limpiar()
					
				    thisform.ret1.visible=.f.
		    	    thisform.ret2.visible=.f.
		    	    thisform.efec_ret=.f. 
		
					select Aux_tipop
		        	=TableRevert(.t.)
					select Aux_perlote
					=TableRevert(.t.)
		
				endif	
		endcase
		
	ENDPROC

	PROCEDURE Xpbutton3.Click
		if messagebox('Confirma eliminar datos',36,'Eliminar')=6
		
			if thisform.reposicion.value=1
				thisform.conectar_sql()
				thisform.msde1.vervista("VerLibre","select * from ReposicionFondoFijo where anulado=0 and ordpago='"+thisform.nroord1.value+"' ")
				sele verlibre
				if recc()>0
					go top
					if val(idrendicion)<>0  && como es bigint en la consulta lo trae como string.
						messagebox("La Reposici�n de Fondo Fijo ya tiene realizada al Rendici�n, debe Anular primero la Rendici�n para Anular la Reposici�n ",48,"Control")
						return
					endif
				endif
			endif
			*--- verificar si la orden contiene un cheque que ya ingreso al banco, si es as� no se debe permitir eliminar la orden de pago.
			_ing_banco=0
			select movimientos_bancos
			set order to pagprov
			seek thisform.nroord1.value
			do while not eof() and pagprov=thisform.nroord1.value
				if Val(num_concilia)<>0
					MessageBox("No se puede Eliminar la Orden ya que contiene Cheque/s o Pagos por Transf. Elect que ya Ingresaron al Banco"+;
					Chr(13)+"Cheque/Nro Transf Nro: "+numero_comprobante+"   Conciliaci�n Nro: "+num_concilia,48,"Control")
					_ing_banco=_ing_banco + 1
				endif
				skip
			enddo
			If _ing_banco<>0
				return
			endif
			*----------------------------------------------------------------------------------------------------------------
			
			
			messagebox("Se Imprimir� un Comprobante de Anulaci�n",48,"Control")
			thisform.imprimir("E")
			if messagebox("El Comprobante de Anulaci�n se Imprimi� Correctamente?",36,"Control")=7
				messagebox("La Orden de Pago no fue Eliminada",48,"Control")
				return
			endif
			******* Elimino Anti a Prov *******
			
			if thisform.reposicion.value=1  && Orden de Reposici�n.
				_error=thisform.msde1.sql2("update ReposicionFondoFijo set anulado=1,opanula="+allt(cod_op)+",fecanula='"+ttoc(datetime())+"' where anulado=0 and ordpago='"+thisform.nroord1.value+"' ")
				if _error<>0
					messagebox("Error al intentar anular la Reposici�n en el Servidor, consulte al Programador",48,"Control")
					return
				endif
		*		_consulta="update movcon set estado='A',anulado='"+TTOC(DATETIME())+"',operanula="+ALLTRIM(STR(_operador))+",Maquina='"+Left(Alltrim(Sys(0)),At("#",Sys(0))-1)+"' where numero='"+ALLTRIM(ThisForm.TxtBono.Value)+"' "
			endif
			
			**--Si es un Pago de Reintegro, Quito la marca de pagado y los datos de la OPs en ExcedenteArchivos-----------------------------------------------------------------------------------
		
			If Val(thisform.txtreintegro.value)<>0
				
				If thisform.conectar_sql()=0
					_fec={}
					_orden=''
					_nrocheque=''
					
					_error=thisform.msde1.sql2("Update ExcedenteArchivos set Pagado=0,FechaPago=?_fec,OrdenPago=?_Orden,NroCheque=?_NroCheque where IdComprobante="+thisform.txtreintegro.Value)
					_error2=thisform.msde1.sql2("Update ComprobantesPagos set Pagado=0,FechaPago=?_fec,OrdenPago=?_Orden,NroCheque=?_NroCheque where IdComprobante="+thisform.txtreintegro.Value)
					if _error<>0
						messagebox("No se pudo Anular el Pago en Sistema de Ordenes, Error con la conexion al Servidor",48,"Aviso")
					endif
		
					Select orden
					Replace reintegro with 0
				Else
					messagebox("No se pudo Marcar el Pago en Sistema de Ordenes, Error con la conexion al Servidor",48,"Aviso")
				endif
			EndIf
			
		
			**-----------------------------------------------------------------------------------------------------------------------------
				
			sele faccom
			set order to NUM &&  numero
			*seek thisform.Codigo1.value+"AN-ORDEN"+thisform.nroord1.value
			seek "AN-ORDEN"+thisform.nroord1.value  && son 14 digitos
			if found()
				dele
			EndIf
			
			select orden
			set order to nroord
			seek thisform.nroord1.value
			if found()
				repl anulada with date(),opanula with Val(cod_op),fecanula with Datetime()
				dele
			EndIf
			
			select pagosprov
			set order to nroord
			seek thisform.nroord1.value
		
			do while not eof() and nroord=thisform.nroord1.value
				dele
				skip
			enddo 
			
				*-- ELimino Movimientos de cuentas de fondos.  (debo eliminar primero la orden antes que el egreso)
			select movimientos_bancos
			set order to pagprov
			seek thisform.nroord1.value
			do while not eof() and pagprov=thisform.nroord1.value
				if reg_orden=thisform.nroord1.value  
					repl pend_reg with 1  && Desmarco como registrado, vuelve a quedar como cheque pendiente marce 26-02-2013
					repl reg_orden with ''
					repl op_reg with 0
					repl fec_reg with {}
				else
					dele
				endif
				skip
			enddo
			
			*----------------------------------------
			select movimientos_bancos
			=tableupdate(.t.)	
			******* Desmarco Cheques de Terceros *******
			select chequeter
			set order to ord_pag
			seek thisform.NROORD1.value
			do while not eof() and ord_pag=thisform.NROORD1.value
				repl fechadep with {}
				repl ord_pag with ""
				skip
			enddo	
			******* Desmarco Retenciones en Cartera *******
			select retenciones
			set order to ord_pag
			seek thisform.NROORD1.value
			do while not eof() and ord_pag=thisform.NROORD1.value
				repl fec_egr with {}
				repl ord_pag  with space(6)
				repl proveedor_egreso with space(6)
				repl nompro_egreso with ""
				skip
			enddo		
			
			
			******* Elimino los Descuentos de proveedores
					
			SELECT descuentos_proveedores
			SET ORDER TO ORDPROV   && NROORD+PROVEEDOR+COD_DCTO
			SEEK thisform.nroORD1.value + thisform.codIGO1.Value	
			DO WHILE NOT EOF() AND nroord=thisform.nroORD1.value AND proveedor=thisform.codIGO1.Value
		
				SELECT descuentos_proveedores
				REPLACE op_modi WITH VAL(cod_op)
				REPLACE fec_modi WITH DATETIME()
				
				DELETE
			
				SKIP
			enddo
			
			**********************************************************
			
			
			******* Elimino Asiento *******
			thisform.asiento(thisform.NROORD1.value,'eliminar')
			******* Elimino percepciones *******
			sele tipo_reten
			set order to nroord
			seek thisform.nroord1.value
			do while not eof() and nroord=thisform.nroord1.value
			   dele
			   skip
			enddo 
		    sele cerbru
			set order to no
			seek thisform.nroord1.value
			do while not eof() and no=thisform.nroord1.value
			   dele
			   skip
			enddo 
		
			
			thisform.limpiar()
		endif
	ENDPROC

	PROCEDURE Xpbutton4.Click
		thisform.imprimir("I")
	ENDPROC

	PROCEDURE Xpbutton5.Click
		thisform.asi_automaticos()
		thisform.asiento1.grid1.column1.text1.setfocus
		
	ENDPROC

	PROCEDURE Xpbutton6.Click
		thisform.p=thisform.p+1
		if thisform.p=3
			thisform.p=1
		endif
		if thisform.p=1
			select deposito
			if recc()=0
				append blank
			endif
			thisform.cheque1.visible=.t.
			thisform.cheque1.grid1.visible=.t.	
			thisform.cheque1.grid1.column1.text1.setfocus
		else
			thisform.text10.value=0
			select deposito
			go top
			scan
				thisform.text10.value=thisform.text10.value+deposito.importe
			endscan
			thisform.total()
			thisform.cheque1.visible=.f.
			thisform.cheque1.grid1.visible=.t.	
			thisform.text11.setfocus
		endif	
		
	ENDPROC

	PROCEDURE Xpbutton7.Click
		select aux_terceros2
		if recc()=0
			messagebox("No Hay Cheques en Cartera",48,"Control")
		else
			go top
			thisform.cartera1.visible=.t.
			thisform.cartera1.grid1.visible=.t.	
			thisform.cartera1.grid1.refresh
			thisform.cartera1.text1.setfocus	
		endif
		
		
	ENDPROC

	PROCEDURE Xpbutton8.Click
		if verfield("Tipo_orden",thisform.text3.value,"Muestra_retencion","Codigo")="S"
			select aux_entrega_retenciones
			if recc()=0
				messagebox("No Hay Retenciones en Cartera",48,"Control")
			else
				go top
				thisform.Ret_EnCartera1.visible=.t.
				thisform.Ret_EnCartera1.grid1.visible=.t.
				thisform.Ret_EnCartera1.grid1.refresh
				thisform.Ret_EnCartera1.grid1.column1.text1.setfocus	
			endif
		else
			messagebox("Esta Opci�n No esta Habilitada para este Tipo de Orden de Pago",48,"Control")	
		Endif	
		
		
	ENDPROC

	PROCEDURE Xpbutton9.Click
		do form tipo_retenciones
	ENDPROC

ENDDEFINE
