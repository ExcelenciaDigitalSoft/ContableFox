*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.21" SourceFile="clases.vcx" CPID="1252" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS arbol AS form 		&& Formulario que muestra un treeview partiendo de una tabla
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="lisima" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="selcar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Ismouseout" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Xpbutton5" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: borranodo
		*m: carga
		*m: expande
		*m: nuevarama
		*m: nuevopadre
		*p: campocodigo
		*p: camponombre
		*p: campopadre
		*p: orden
	*</DefinedPropArrayMethod>

	*<PropValue>
		AutoCenter = .T.
		BorderStyle = 0
		Caption = "Plan de Cuentas "
		Closable = .F.
		DataSession = 2
		DoCreate = .T.
		Height = 480
		Icon = note12.ico
		MaxButton = .F.
		MinButton = .F.
		Name = "arbol"
		Picture = 1.gif
		ShowTips = .T.
		Width = 717
		WindowType = 1
	*</PropValue>

	ADD OBJECT 'Ismouseout' AS ismouseout WITH ;
		Left = 666, ;
		Name = "Ismouseout", ;
		Top = 443
		*< END OBJECT: ClassLib="xpform.vcx" BaseClass="timer" />

	ADD OBJECT 'lisima' AS olecontrol WITH ;
		Height = 38, ;
		Left = 24, ;
		Name = "lisima", ;
		Top = 437, ;
		Width = 37
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\system\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+////BQAAAAYAAAD+/////////wkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAABAAAAP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAR6JgidcQBAwAAAMAAAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAOxYAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAD0AAAAAAAAAAQAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAAAAAAjfyQskYXREbFqAMDwKDYoIUM0EggAAADtAwAA7QMAAIB+4eYAAAYAQP1oghAAEADAwMAA//8AAAHvzasAAAUA7PloggYANQD/////BQAAgOz5aIIDAAAAAAAAAAAAAAEAAABsdAAAwAgAAAAAAQABACAg/wAAAAAAqAgAABYAAAAoAAAAIAAAAEAAAAABAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJhkAABoNAAA0MxoAJiYMADI/8gAWFRYAKisqADg3OAAeHh4AP///wCIiIgAuLy4APDw8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAQACACAgEAAAAAAA6AIAACYAAAAQEBAAAAAAACgBAAAOAwAAKAAAACAAAABAAAAAAQAEAAAAAACAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAASEAAAAAAAAAAAAAAAAAAAEiEAAAAAAAAAAAAAAAAAABIiEAAAAAAAAAAAAAAAAAASIhEAAAAAAAAAAAAAAAAAEiISEAAAAAAAAAAAAAAAABIiE+EAAAAAARERERERERESIhI+EAAAAAERERERERERESIT4+EAAAABIRERERERERESEj4+EAAAASIRERERERERERPj4+EAAAEiIRERERERERESPj4+EAABIiEj4+Pj4+Pj4+Pj4+EAAyIhPj4+Pj4+Pj4+Pj4+EAAyISPj4+Pj4+Pj4+Pj4+EAAyE+Pj4+Pj4+Pj4+Pj4QAAAxI+Pj4+Pj4+Pj4+PhAAAAAxERERERERESPj4+EAAAAAAAAAAAABIiE+Pj4QAAAAAAAAAAAAASIhI+PhAAAAAAAAAAAAAAEiIT4+EAAAAAAAAAAAAAABIiEj4QAAAAAAAAAAAAAAASIhPhAAAAAAAAAAAAAAAAMSISEAAAAAAAAAAAAAAAAAMSEQAAAAAAAAAAAAAAAAAAMRAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////7////+f////j////4f///+D////gf///4D///+Af8AAAD/AAAAfwAAAD8AAAAfAAAADwAAAAcAAAADgAAAAcAAAAPgAAAH8AAAD//+AB///gA///4Af//+AP///gH///4D////B////4/////f////////////KAAAABAAAAAgAAAAAQAEAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAARAAAAAAAAABPQAAAAAAAAEhEAAAERERET0hAAARERERET4QABPRERERI+EAEhI+Pj4+PhAT0+Pj4+Pj4QESPj4+Pj4QABEREREj4QAAAAABIT4QAAAAAAE9IQAAAAAAASEQAAAAAAAAEQAAAAAAAAAAAAAAP//AAD+fwAA/j8AAP4fAAAADwAAAAcAAAADAAAAAQAAAAAAAIABAADAAwAA/gcAAP4PAAD+HwAA/z8AAP//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEEBAQEBAQBAgEFBAwKDQ0EBA0NDQ0NDQ0NDQ0NDAwLCwEBAQEEBAECAQMMCg0NDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDAwLCwEBAQIADAoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0NDQsLAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////wAAAA4AAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAHAAAAD/////////////////////////////////////wAAAgAAAGx0AADACAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGACMAAAAQABAAwMDAAP//AAAB782rAAAFAOz5aIIGADUA/////wUAAIDs+WiCAwAAAAAAAAMAAAABAAAAbHQAAMAIAAAAAAEAAQAgIP8AAAAAAKgIAAAWAAAAKAAAACAAAABAAAAAAQAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACYZAAAaDQAANDMaACYmDAAyP/IAFhUWACorKgA4NzgAHh4eAD///8AiIiIALi8uADw8PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQICAgICAgICAgICAgICAgICAgICAgICAgICAQAAAAEDAwQBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAgABAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAEBAQEFBAQEBAQEBAQEBAQEBAQEBAQEBAMGBgEEBAQEBAECAQMEBAQEBAQEBAQEBAQEBAQEBAQEAwYHBgEEBAQEAQIBAwQEBAQEBAQEBAQEBAQEBAQEBAQDBgcHBgEEBAQBAgEDBAQEBAQEBAQEBAQEBAMGBgYGBgYGBwgHBgEEBAECAQMEBAQEBAQEBAQEBAQDCQoHBwcHBwcHCAgHBgEEAQIBAwQEBAQEBAQEBAQEBAMJCggICAgICAgICAgHBgEBAgEDBAQEBAQEBAQEBAQEAwkKCAgICAgICAgICAoGAQECAQMEBAQEBAQEBAQEBAQDCQoKCgoKCgoICAgKBgEEAQIBAwQEBAQEBAQEBAQEBAQDCQkJCQkJCQcICgYBBAQBAgEDBAQEBAQEBAQEBAQEBAQDAwMDAwMJBwoGAQQEBAECAQMEBAQEBAQEBAQEBAQEBAQEBAQEAwkKBgEEBAQEAQIBAwQEBAQEBAQEBAQEBAQEBAQEBAQDCQYBBAQEBAQBAgEDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAECAQMEBAQEBAsBAQEEBAQEBAQEBAQEBAQEBAQEBAQEAQIBAwQEBAQMCwsLAQEBAQEEBAQEBAQEBAQEBAQEBAQBAgEDBAQEDAoNDQwMDAsLCwEBAQEBBAQEBAQEBAQEBAECAQMEBAwKDQQEDQ0NDQ0NDAwLCwsBAQEBBAQEBAQEAQIBBQQMCg0NBAQNDQ0NDQ0NDQ0NDQwMCwsBAQEBBAQBAgEDDAoNDQ0NDQ0NDQ0NDQ0NDQ0NDQ0NDQwMCwsBAQECAAwKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNDQ0LCwAAAAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////8AAAAOAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAABwAAAA/////////////////////////////////////8AAAIAAABsdAAAwAgAAAAAAQABACAg/wAAAAAAqAgAABYAAAAoAAAAIAAAAEAAAAABAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADA0MAAQEBAAWFRYANBoaACooKAA8Pz/AODc4ADQzNAAwMDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMABAABAQEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgMDAwAEAAEBAQEBAAAAAAAAAAAAAAAAAAAAAAAAAgMDBQUDAAQAAQEBAQEBAAAAAAAAAAAAAAAAAAAAAgMDBQUGBQMABAABAQEBAQEAAAAAAAAAAAAAAAAAAgMDBQUGBgYFAwAEAAEBAQEBAAAAAAAAAAAAAAAAAgMDBQUGBgYGBgUDAAQAAQEBAAAAAAAAAAAAAAAAAgMDBQUGBgYGBgYGBQMABAABAAAAAAAAAAAAAAAAAgMDBQUHBgYGBgYGBgYFAwAEAAAAAAAAAAAAAAAAAgMDBQUGBwYGBgYGBgYGBgUDAAQAAAAAAAAAAAAAAgMDBQUHBwcGBwYGBgYGBgYGBQMABAAAAAAAAAAAAAMDBQUIBwgHBwcGBwYGBgYGBgYFAwAEAAAAAAAAAAAABQUJCAgIBwgHBwcGBwYGBgYGBgUDAAQAAAAAAAAAAAAJCQgJCAgIBwgHBwcGBwYGBgYGBQMABAAAAAAAAAAAAAkJCQgJCAgIBwgHBwcGBwYGBgYFAwAEAAAAAAAAAAAABQkJCQgJCAgIBwgHBwcGBwYGBgUDAAQAAAAAAAAAAAAJBQkJCQgJCAgIBwgHBwcGBwYGBQMABAAAAAAAAAAAAAUJBQkJCQgJCAgIBwgHBwcGBwcFAwAEAAAAAAAAAAAABQUJBQkJCQgJCAgIBwgHBwcGCAUDAAQAAAAAAAAAAAAFBQUJBQkJCQgJCAgIBwgHBwcFAwIEBAAAAAAAAAAAAAUFBQUJBQkJCQgJCAgFAwICAwICBAQEAAAAAAAAAAAABQUFBQUJBQkJCQgFAwICBAICBAQEBAAAAAAAAAAAAAAFBQUFBQUJBQkJCAICBAQEBAQEBAQAAAAAAAAAAAAAAAUFBQUFBQUJBQUFAgQEBAQEBAQEBAIAAAAAAAAAAAAABQUFBQUFBQUFAwICBAQEBAQEBAQAAAAAAAAAAAAAAAAFBQUFBQUFAwICBAQEBAQEBAQEAgIAAAAAAAAAAAAAAAUFBQUFAwICBAQEBAIABAQEAgAAAAAAAAAAAAAAAAAABQUFAwICBAQEBAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAwICBAQEBAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACBAQEBAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///wf///wB///wAH//wAA//wAAP/wAAH/wAAH/wAAH/wAAD/wAAA/wAAAP4AAAD+AAAA/gAAAP4AAAD+AAAA/gAAAP4AAAD+AAAA/gAAAP4AAAD+AAAB/gAAA/4AAAP+AAAH/gAAB/4AAB/+AAx//gA///4A////g////4////x8PAwAAAGx0AAA4" />

	ADD OBJECT 'selcar' AS olecontrol WITH ;
		Height = 434, ;
		Left = 6, ;
		Name = "selcar", ;
		Top = 2, ;
		Width = 704
		*< END OBJECT: BaseClass="olecontrol" OLEObject="c:\windows\system\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGAR6JgidcQBAwAAAIACAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAABABAAAAAAAABAAAAAIAAAD+////BgAAAAUAAAD+////BwAAAAgAAAAJAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAADDSAAA2ywAALE8wWoBAAYAIgAAAJ0yZgDtAwAACDNmAL3bgQAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwBAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAAFAIzdgQAHgJkAAAAAAAUAAICc46MAAQAAAFwAH97svQEABQCl46MAA1LjC5GPzhGd4wCqAEu4UQEAAACQAURCAQAFQXJpYWwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAENACgAAAExpbmVTdHlsZQAJAAAASQoAAAABAAAADQAAAE1vdXNlUG9pbnRlcgAJAAAASQoAAAAAAAAADgAAAFBhdGhTZXBhcmF0b3IACgAAAEgAAAAAAQAAAFwMAAAAT0xFRHJhZ01vZGUACQAAAEkKAAAAAAAAAAwAAABPTEVEcm9wTW9kZQAJAAAASQoAAAAAAAAACwAAAEFwcGVhcmFuY2UACQAAAEkKAAAAAQAAAAwAAABCb3JkZXJTdHlsZQAJAAAASQoAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />

	ADD OBJECT 'Xpbutton1' AS xpbutton WITH ;
		Left = 99, ;
		Name = "Xpbutton1", ;
		TabIndex = 21, ;
		Top = 443, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-continue.gif, ;
		imgImage.Width = 14, ;
		lblText.Caption = "Salir", ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .T., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton2' AS xpbutton WITH ;
		Left = 203, ;
		Name = "Xpbutton2", ;
		TabIndex = 16, ;
		Top = 443, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 17, ;
		imgImage.Left = 1, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = addall.bmp, ;
		imgImage.Top = 7, ;
		imgImage.Width = 18, ;
		lblText.Caption = "Nuev.Cuen.Pri.", ;
		lblText.FontSize = 8, ;
		lblText.Left = 17, ;
		lblText.Name = "lblText", ;
		lblText.Top = 7, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton3' AS xpbutton WITH ;
		Left = 413, ;
		Name = "Xpbutton3", ;
		TabIndex = 28, ;
		Top = 443, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 16, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = xp-cancel.gif, ;
		imgImage.Width = 16, ;
		lblText.Caption = "Eliminar", ;
		lblText.Name = "lblText", ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton4' AS xpbutton WITH ;
		Left = 517, ;
		Name = "Xpbutton4", ;
		TabIndex = 23, ;
		Top = 443, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 22, ;
		imgImage.Left = 4, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = impresora2.ico, ;
		imgImage.Stretch = 2, ;
		imgImage.Top = 4, ;
		imgImage.Width = 28, ;
		lblText.Caption = "Imprimir", ;
		lblText.Left = 37, ;
		lblText.Name = "lblText", ;
		lblText.Top = 6, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />

	ADD OBJECT 'Xpbutton5' AS xpbutton WITH ;
		Left = 309, ;
		Name = "Xpbutton5", ;
		TabIndex = 16, ;
		Top = 443, ;
		imgMouseDown.Name = "imgMouseDown", ;
		imgMouseOn.Name = "imgMouseOn", ;
		imgBack.Name = "imgBack", ;
		imgImage.Height = 14, ;
		imgImage.Left = 3, ;
		imgImage.Name = "imgImage", ;
		imgImage.Picture = add.bmp, ;
		imgImage.Top = 8, ;
		imgImage.Width = 15, ;
		lblText.Caption = "Nuev.Cuen.Sec.", ;
		lblText.FontSize = 8, ;
		lblText.Left = 22, ;
		lblText.Name = "lblText", ;
		lblText.Top = 7, ;
		cmdHide.Cancel = .F., ;
		cmdHide.Name = "cmdHide", ;
		imgLeft.Name = "imgLeft", ;
		imgRight.Name = "imgRight"
		*< END OBJECT: ClassLib="xpwizard.vcx" BaseClass="container" />
	
	PROCEDURE borranodo
		*local m.nodo as MSComctlLib.node, m.orden
		local m.nodo , m.orden
		m.orden = thisform.campocodigo
		if occurs(".", m.orden) > 0
			m.orden = getwordnum(m.orden, 2, ".")
		endif
		if type("thisform.selcar.selecteditem.key") != "C"
			return
		endif
		m.nodo = thisform.selcar.selecteditem
		if messagebox("¿Eliminar " +alltr(m.nodo.Text)+ "?",36,"Eliminar") = 7
			return
		endif
		if seek(m.nodo.Key, "cuencont", m.orden)
			delete in cuencont
			thisform.selcar.Nodes.Remove(m.nodo.key)
			thisform.selcar.Refresh()
		endif
		
	ENDPROC

	PROCEDURE carga
		local m.registro, m.nombre, m.campopadre
		thisform.selcar.nodes.clear()
		select cuencont
		m.campopadre = "cuencont." + thisform.campopadre
		locate for &campopadre = ""
		do while found("cuencont")
			m.registro = recno("cuencont")
			thisform.selcar.nodes.add( , , evaluate("cuencont." + thisform.campocodigo), alltr(evaluate("cuencont." + thisform.camponombre))+;
			" Cod: "+right(evaluate("cuencont." + thisform.campocodigo),6), 1, 1)
			thisform.selcar.nodes(evaluate("cuencont." + thisform.campocodigo)).expanded = .t.
			thisform.selcar.nodes(evaluate("cuencont." + thisform.campocodigo)).tag = 1
			thisform.expande(evaluate("cuencont." + thisform.campocodigo))
			go m.registro in cuencont
			skip 1 in cuencont
			locate rest for &campopadre = ""
		enddo
		thisform.refresh()
		
	ENDPROC

	PROCEDURE expande
		lparameters m.padre
		local m.registro, m.nombre, m.campopadre, m.imagen
		m.campopadre = thisform.campopadre
		=seek(m.padre, "cuencont", thisform.orden)
		do while !eof("cuencont") and evaluate("cuencont." + thisform.campopadre) = m.padre
			m.registro = recno("cuencont")
			thisform.selcar.nodes.add(m.padre, 4, evaluate("cuencont." + thisform.campocodigo), alltr(evaluate("cuencont." + thisform.camponombre))+;
			" Cod: "+right(evaluate("cuencont." + thisform.campocodigo),6), 2, 3)
			thisform.selcar.nodes(evaluate("cuencont." + thisform.campocodigo)).expanded = .t.
			thisform.expande(evaluate("cuencont." + thisform.campocodigo))
			go m.registro in cuencont
			skip 1 in cuencont
		enddo
		
	ENDPROC

	PROCEDURE Init
		lparameters m.tabla, m.campocodigo, m.campopadre, m.camponombre
		local m.orden, m.ancerror
		m.ancerror = on("error")
		if !dodefault()
			return .f.
		endif
		***************************
		thisform.Visible = .t.
		thisform.selcar.borderStyle = 1
		thisform.selcar.checkboxes = .f.
		thisform.selcar.labelEdit = 1
		thisform.selcar.lineStyle = 0
		thisform.selcar.indentation = 15
		
		if vartype(m.tabla) != "C"
			=messagebox("Parámetro Tabla erróneo", 0 + 48)
			return .f.
		endif
		if !file(m.tabla)
			=messagebox("Tabla inexistente", 0 + 48)
			return .f.
		endif
		on error ? ""
		use (m.tabla) in 0 again shared alias cuencont
		on error &ancerror
		if !used("cuencont")
			=messagebox("No se pudo abrir '" + m.tabla + "'", 0 + 48)
			return .f.
		endif
		select cuencont
		thisform.orden = m.campopadre
		if occurs(".", thisform.orden) > 0
			thisform.orden = getwordnum(thisform.orden, 2, ".")
		endif
		on error ? ""
		set order to (thisform.orden) in cuencont
		on error &ancerror
		if empty(order("cuencont"))
			=messagebox("No se pudo ordenar '" + m.tabla + "'", 0 + 48)
			return .f.
		endif
		
		thisform.campocodigo = m.campocodigo
		thisform.camponombre = m.camponombre
		thisform.campopadre = m.campopadre
		thisform.carga()
		
	ENDPROC

	PROCEDURE Load
		dodefault()
		=sys(2333, 0)
		set deleted on
		set sysformats off
		set date to french
		set century on
		set century to 19 rollover 60
		set confirm off
		set currency to "€"
		set currency right
		set hours to 24
		set point to ","
		set separator to "."
		set seconds on
		set exclusive off
		set unique off
		set carry off
		*set tablevalidate to 1
		set autosave on
		set near on
		set talk off
		set talk window
		set exact on
		set ansi on
		set escape off
		set odometer to 1000
		set compatible off
		set decimals to 6
		set fdow to 2
		set fullpath on
		set fweek to 1
		set keycomp to windows
		set nulldisplay to ""
		set safety on
		set collate to "general"
		set lock off
		set multilocks on
		set status bar off
		set reprocess to 5 seconds
		set reprocess to 5 seconds system
		
	ENDPROC

	PROCEDURE nuevarama
		local m.padre , m.codigo, m.campopadre, m.campocodigo, m.camponombre
		*local m.padre as MSComctlLib.node, m.codigo, m.campopadre, m.campocodigo, m.camponombre
		*private m.nombre, m.ok
		public m.nombre, m.ok
		if type("thisform.selcar.selecteditem.key") != "C"
			return
		endif
		m.codigo = sys(2015)
		m.nombre = ""
		m.padre = thisform.selcar.selecteditem
		messagebox(m.padre)
		do form nuevarama
		if m.ok != 1
			return
		endif
		thisform.selcar.nodes.add(m.padre, 4, m.codigo, alltrim(m.nombre), 2, 3)
		thisform.selcar.nodes(m.codigo).expanded = .t.
		
		m.campopadre = thisform.campopadre
		m.campocodigo = thisform.campocodigo
		m.camponombre = thisform.camponombre
		select cuencont
		append blank
		replace ;
			&campopadre with m.padre.Key, ;
			&campocodigo with m.codigo, ;
			&camponombre with m.nombre ;
			in cuencont
		thisform.selcar.Refresh()
		
	ENDPROC

	PROCEDURE nuevopadre
		local m.codigo, m.campopadre, m.campocodigo, m.camponombre
		private m.nombre, m.ok
		m.codigo = sys(2015)
		m.nombre = ""
		do form nuevarama
		if m.ok != 1
			return
		endif
		thisform.selcar.nodes.add( , , m.codigo, alltrim(m.nombre), 1, 1)
		thisform.selcar.nodes(m.codigo).expanded = .t.
		
		m.campocodigo = thisform.campocodigo
		m.camponombre = thisform.camponombre
		select cuencont
		append blank
		replace ;
			&campocodigo with m.codigo, ;
			&camponombre with m.nombre ;
			in cuencont
		thisform.selcar.Refresh()
		
	ENDPROC

	PROCEDURE selcar.AfterLabelEdit
		*** ActiveX Control Event ***
		LPARAMETERS cancel, newstring
		
	ENDPROC

	PROCEDURE selcar.Click
		*** ActiveX Control Event ***
		
	ENDPROC

	PROCEDURE selcar.DblClick
		*** ActiveX Control Event ***
		
	ENDPROC

	PROCEDURE selcar.Init
		this.ImageList = thisform.lisima.oBJECT
		=sys(2333, 0)
		
	ENDPROC

	PROCEDURE selcar.KeyPress
		*** Evento de control OLE ***
		LPARAMETERS keyascii
		if keyascii = 27
			keyboard "{Esc}" && solución para que no se cuelgue
		endif
		
	ENDPROC

	PROCEDURE selcar.NodeClick
		*** ActiveX Control Event ***
		LPARAMETERS node
		*m.nodo = node&&thisform.selcar.selecteditem
		*messagebox(m.nodo.Root.text)
		*m.nodo.text=alltr(m.nodo.text)
		
	ENDPROC

	PROCEDURE Xpbutton1.Click
		thisform.Release()
	ENDPROC

	PROCEDURE Xpbutton2.Click
		a=""
		do form nueva_cuenta with "" to a
		thisform.selcar.Refresh()
		
	ENDPROC

	PROCEDURE Xpbutton3.Click
		thisform.borranodo()
	ENDPROC

	PROCEDURE Xpbutton4.Click
		report form plandecuentas nocon prev
	ENDPROC

	PROCEDURE Xpbutton5.Click
		local m.nodo , m.orden
		m.orden = thisform.campocodigo
		if occurs(".", m.orden) > 0
			m.orden = getwordnum(m.orden, 2, ".")
		endif
		if type("thisform.selcar.selecteditem.key") != "C"
			return
		endif
		m.nodo = thisform.selcar.selecteditem
		a=""
		do form nueva_cuenta with right(alltr(m.nodo.Text),6) to a
		thisform.selcar.Refresh()
		
	ENDPROC

ENDDEFINE
